/*==========================================================================
  * Copyright (c)      Realtek Semiconductor Corporation, 2014
  * All rights reserved.
  * ========================================================================*/
  /*================= File Description =======================================*/
  /**
   * @file
   *  This file is for HDR 10+ related functions.
   *
   * @author  $Author$
   * @date	  $Date$
   * @version	  $Revision$
   */


  /*============================ Module dependency	===========================*/
#ifndef BUILD_QUICK_SHOW
#include <linux/string.h>
#include <linux/kernel.h>
#include <linux/math64.h>
#else
#include <no_os/printk.h>
#include <no_os/semaphore.h>
#include <no_os/spinlock.h>
#include <no_os/spinlock_types.h>
#include <malloc.h>
#include <div64.h>
#include <rtd_log/rtd_module_log.h>
#include <sysdefs.h>
#endif

#include <tvscalercontrol/io/ioregdrv.h>

//#include <tvscalercontrol/vip/tc_hdr.h>
//#include <tvscalercontrol/vip/tc_math.h>//juwen, merlin3, tc//juwen, 170216, TCv1.3.0_computeMetaData
//#include <tvscalercontrol/scaler/vipinclude.h> // for typedef that used in VIP_reg_def.h
//#include <tvscalercontrol/vip/vip_reg_def.h>
//#include <rbus/rbusTCReg.h>
//#include <rbus/tc_reg.h>
#include <tvscalercontrol/vip/scalerColor.h>
//#include <rbus/dmato3dtable_reg.h>
//#include <rbus/dmato3dlut_reg.h>
#include <mach/rtk_log.h>
#include "rtk_vip_logger.h"
//#include <tvscalercontrol/vip/ST2094.h>
//#include <rbus/efuse_reg.h>
//#include <tvscalercontrol/hdmirx/hdmifun.h>
//#include <tvscalercontrol/vip/HDR10_vivid.h>
#include "tvscalercontrol/vip/HDR10_vivid.h"
#include "scaler/scalerCommon.h"

#include "rbus/dm_reg.h"



#define CLIP_hdr_vivid(min, max, val) ((val < min) ? min : (val > max ? max : val))
extern dm_dm_submodule_enable_RBUS dm_submodule_temp; 

#define CUVA_FW_TEST_ON_FPGA 0
#define CUVA_NEED_ELI_MODIFY 0

static HDR_VIVID_Metadata hdr10_vivid_metadata_buff;
HDR_VIVID_Metadata* drvif_fwif_color_Get_HDR10_vivid_METADATA_Buff(void)
{
	return &hdr10_vivid_metadata_buff;
}

static VIP_HDR10_vivid_CTRL HDR10_vivid_CTRL = {0};
VIP_HDR10_vivid_CTRL* drvif_fwif_color_Get_HDR10_vivid_Ctrl(void)
{
	return &HDR10_vivid_CTRL;
}

//#ifdef HDR10_vivid_compile_fail
/* CUVA process functions */
long long abs_cuva(long long x)
{
	return x>=0 ? x : (-x);
}
long long max_cuva(long long x, long long y)
{
	long long out;
	out=x;
	if(y>out)
		out=y;
	return out;
}

long long min_cuva(long long x, long long y)
{
	long long out;
	out=x;
	if(y<out)
		out=y;
	return out;
}

long long maxRGBPQ(long long r, long long g, long long b)
{
	long long out=0;
	out=r;
	if(g>out)
		out=g;
	if(b>out)
		out=b;
	return out;
}
/* OETF interpolation table */
static const unsigned int l2pqLutX[128] = {
		0x00000000, 0x0000000d, 0x0000004e, 0x000000f2, 0x00000214, 0x000003ed, 0x000006a2, 0x00000a6f, 
		0x00000f8b, 0x00001639, 0x00001ebf, 0x00002972, 0x0000369a, 0x000046ab, 0x00005a06, 0x00007125, 
		0x00008c8a, 0x0000acbc, 0x0000d268, 0x0000fe3b, 0x000130d4, 0x00016b1d, 0x0001adff, 0x0001fa53, 
		0x00025135, 0x0002b3b4, 0x0003230f, 0x0003a09a, 0x00042de4, 0x0004cc72, 0x00057e45, 0x0006453f, 
		0x00072328, 0x00081a99, 0x00092dc6, 0x000a5f96, 0x000bb28c, 0x000d2a54, 0x000ec9f4, 0x00109521, 
		0x00128fe8, 0x0014bee4, 0x0017270d, 0x0019cd3f, 0x001cb709, 0x001fea27, 0x00236d03, 0x00274696, 
		0x002b7ed7, 0x00301de6, 0x00352d89, 0x003ab771, 0x0040c5c7, 0x00476365, 0x004e9c3a, 0x00567e18, 
		0x005f1810, 0x0068796b, 0x0072b10d, 0x007dd465, 0x0089f513, 0x009727cb, 0x00a587cb, 0x00b526fe, 
		0x00c628cd, 0x00d8a1b6, 0x00ecba12, 0x01028ad3, 0x011a43d7, 0x0134020e, 0x014ffb77, 0x016e591e, 
		0x018f4dc5, 0x01b31818, 0x01d9e7dd, 0x020407dd, 0x0231bf12, 0x02635154, 0x029916e2, 0x02d36f11, 
		0x0312b208, 0x03574bba, 0x03a1aef0, 0x03f26478, 0x0449e29f, 0x04a8c0e6, 0x050f9c17, 0x057f2b45, 
		0x05f83742, 0x067b715a, 0x0709c26f, 0x07a41207, 0x084b747f, 0x090116dc, 0x09c63ccf, 0x0a9c44e9, 
		0x0b848165, 0x0c8098b0, 0x0d92316e, 0x0ebb37be, 0x0ffdc6c7, 0x115c3297, 0x12d90935, 0x1477179b, 
		0x16396e13, 0x1823653c, 0x1a38a764, 0x1c7d3101, 0x1ef55ccd, 0x21a5e67e, 0x2493f699, 0x27c52ce7, 
		0x2b3fb584, 0x2f0a7cd3, 0x332d32d3, 0x37b067f0, 0x3c9d7506, 0x41fe3834, 0x47dd49c0, 0x4e4624e5, 
		0x5545b31a, 0x5cea41fc, 0x6543e276, 0x6e6428cd, 0x785c36ab, 0x83434491, 0x8f1f6c3f, 0x9c400000
	};
static const unsigned int l2pqLutA[128] = {
		0x0c032082, 0x043c81ab, 0x024272f8, 0x018110d4, 0x010b262b, 0x00c8102b, 0x0099818a, 0x0078df8d, 
		0x00614c32, 0x004f9831, 0x0041c6f1, 0x003729bd, 0x002e80eb, 0x0027a8b4, 0x0021f8ee, 0x001d4609, 
		0x00196914, 0x00161f31, 0x00135308, 0x0010fef4, 0x000ef57a, 0x000d377d, 0x000bba73, 0x000a6ac8, 
		0x00094876, 0x00084a4b, 0x00076bbe, 0x0006a6ed, 0x0005fb69, 0x000561d4, 0x0004d943, 0x00046114, 
		0x0003f511, 0x000394fe, 0x00033ed9, 0x0002f20f, 0x0002ac6a, 0x00026e9a, 0x00023677, 0x000203ed, 
		0x0001d654, 0x0001ad0f, 0x000187d5, 0x000165f4, 0x00014745, 0x00012b6a, 0x0001121f, 0x0000fb10, 
		0x0000e62f, 0x0000d311, 0x0000c1a3, 0x0000b1b8, 0x0000a32d, 0x000095e8, 0x000089d0, 0x00007eaf, 
		0x00007478, 0x00006b3c, 0x000062a6, 0x00005ad0, 0x000053ac, 0x00004d01, 0x00004707, 0x00004165, 
		0x00003c54, 0x00003795, 0x0000334c, 0x00002f45, 0x00002ba6, 0x0000283e, 0x00002526, 0x00002248, 
		0x00001fa0, 0x00001d37, 0x00001af5, 0x000018e3, 0x000016fc, 0x00001538, 0x00001396, 0x00001218, 
		0x000010b4, 0x00000f6d, 0x00000e3e, 0x00000d28, 0x00000c25, 0x00000b37, 0x00000a5a, 0x0000098f, 
		0x000008d4, 0x00000825, 0x00000785, 0x000006f0, 0x00000667, 0x000005e9, 0x00000573, 0x00000508, 
		0x000004a3, 0x00000447, 0x000003f1, 0x000003a3, 0x0000035a, 0x00000316, 0x000002d8, 0x0000029e, 
		0x00000269, 0x00000238, 0x0000020b, 0x000001e1, 0x000001ba, 0x00000196, 0x00000175, 0x00000157, 
		0x0000013b, 0x00000121, 0x00000109, 0x000000f3, 0x000000df, 0x000000cd, 0x000000bb, 0x000000ac, 
		0x0000009d, 0x00000090, 0x00000084, 0x00000078, 0x0000006e, 0x00000065, 0x0000005a, 0x00000000
	};
static const unsigned int l2pqLutB[128] = {
		0x0000, 0x004c, 0x00d7, 0x0190, 0x026a, 0x0361, 0x0470, 0x0594, 
		0x06c8, 0x080d, 0x0961, 0x0ac0, 0x0c2b, 0x0da1, 0x0f21, 0x10a9, 
		0x123a, 0x13d3, 0x1574, 0x171c, 0x18ca, 0x1a7d, 0x1c37, 0x1df7, 
		0x1fbc, 0x2185, 0x2352, 0x2524, 0x26fa, 0x28d4, 0x2ab3, 0x2c95, 
		0x2e7b, 0x3065, 0x3252, 0x3442, 0x3635, 0x382b, 0x3a25, 0x3c21, 
		0x3e1f, 0x4021, 0x4225, 0x442c, 0x4636, 0x4841, 0x4a4f, 0x4c5f, 
		0x4e70, 0x5084, 0x529a, 0x54b3, 0x56cd, 0x58e8, 0x5b06, 0x5d25, 
		0x5f46, 0x6168, 0x638c, 0x65b1, 0x67d8, 0x6a00, 0x6c2a, 0x6e54, 
		0x7080, 0x72ae, 0x74dc, 0x770c, 0x793c, 0x7b6e, 0x7da1, 0x7fd5, 
		0x820a, 0x8440, 0x8677, 0x88ae, 0x8ae7, 0x8d21, 0x8f5b, 0x9197, 
		0x93d3, 0x9610, 0x984e, 0x9a8d, 0x9ccc, 0x9f0c, 0xa14d, 0xa38e, 
		0xa5d1, 0xa814, 0xaa57, 0xac9c, 0xaee0, 0xb126, 0xb36c, 0xb5b4, 
		0xb7fc, 0xba44, 0xbc8d, 0xbed7, 0xc121, 0xc36c, 0xc5b8, 0xc805, 
		0xca53, 0xcca1, 0xcef1, 0xd142, 0xd393, 0xd5e6, 0xd839, 0xda8d, 
		0xdce2, 0xdf37, 0xe18d, 0xe3e4, 0xe63b, 0xe893, 0xeaeb, 0xed44, 
		0xef9c, 0xf1f5, 0xf44d, 0xf6a6, 0xf8fe, 0xfb55, 0xfdab, 0xffff 
	};
/* OETF interpolation table */
long long FindNodeIdxFixPnt_cuva(long long l)
{
    long long il = 0, ir = 128, num = 128;// num = 2^n
    long long ic;
    // do a binary search
    while (num > 1) {
        num >>= 1;
        ic = il + num;
        if (l < l2pqLutX[ic]) ir = ic;
        else if (l > l2pqLutX[ic]) il = ic;
        else return ic;
    }

    return il;
}
long long inv_EO_lut( long long in_buffer32)
{	
	long long index;
	long long y1;
	long long y2;

	index = FindNodeIdxFixPnt_cuva( (long long)in_buffer32 );
	y1 = (in_buffer32 - l2pqLutX[index]) * l2pqLutA[index];
	y2 = (long long)( y1 >> (18 + 23 - 16) ) + l2pqLutB[index];
	return y2;
}
// EOTF table
		unsigned int EOTF_tbl[4097]={
		0x0,0x1,0x5,0xa,0x11,0x19,0x22,0x2c,0x38,0x44,0x52,0x60,0x70,0x81,0x92,0xa5,
		0xb9,0xcd,0xe3,0xf9,0x111,0x129,0x143,0x15d,0x179,0x195,0x1b3,0x1d1,0x1f0,0x211,0x232,0x254,
		0x277,0x29c,0x2c1,0x2e7,0x30e,0x337,0x360,0x38a,0x3b5,0x3e1,0x40f,0x43d,0x46c,0x49d,0x4ce,0x500,
		0x534,0x568,0x59e,0x5d4,0x60c,0x645,0x67f,0x6b9,0x6f5,0x732,0x770,0x7af,0x7f0,0x831,0x874,0x8b7,
		0x8fc,0x941,0x988,0x9d0,0xa1a,0xa64,0xaaf,0xafc,0xb4a,0xb98,0xbe8,0xc3a,0xc8c,0xce0,0xd34,0xd8a,
		0xde1,0xe3a,0xe93,0xeee,0xf4a,0xfa7,0x1005,0x1065,0x10c6,0x1128,0x118b,0x11f0,0x1256,0x12bd,0x1325,0x138f,
		0x13fa,0x1466,0x14d3,0x1542,0x15b2,0x1624,0x1696,0x170a,0x1780,0x17f7,0x186f,0x18e8,0x1963,0x19df,0x1a5c,0x1adb,
		0x1b5b,0x1bdd,0x1c60,0x1ce4,0x1d6a,0x1df1,0x1e7a,0x1f04,0x1f8f,0x201c,0x20aa,0x213a,0x21cb,0x225e,0x22f2,0x2388,
		0x241f,0x24b7,0x2551,0x25ed,0x268a,0x2728,0x27c8,0x286a,0x290d,0x29b1,0x2a57,0x2aff,0x2ba8,0x2c53,0x2cff,0x2dad,
		0x2e5d,0x2f0e,0x2fc0,0x3074,0x312a,0x31e2,0x329b,0x3355,0x3412,0x34d0,0x358f,0x3651,0x3714,0x37d8,0x389e,0x3966,
		0x3a30,0x3afb,0x3bc8,0x3c97,0x3d67,0x3e39,0x3f0d,0x3fe3,0x40ba,0x4193,0x426e,0x434b,0x4429,0x4509,0x45eb,0x46cf,
		0x47b4,0x489c,0x4985,0x4a70,0x4b5c,0x4c4b,0x4d3c,0x4e2e,0x4f22,0x5018,0x5110,0x520a,0x5305,0x5403,0x5502,0x5604,
		0x5707,0x580c,0x5913,0x5a1c,0x5b27,0x5c34,0x5d43,0x5e54,0x5f67,0x607c,0x6193,0x62ab,0x63c6,0x64e3,0x6602,0x6723,
		0x6846,0x696b,0x6a92,0x6bbb,0x6ce6,0x6e14,0x6f43,0x7074,0x71a8,0x72de,0x7415,0x754f,0x768b,0x77c9,0x790a,0x7a4c,
		0x7b91,0x7cd8,0x7e21,0x7f6c,0x80b9,0x8209,0x835b,0x84af,0x8605,0x875e,0x88b8,0x8a15,0x8b75,0x8cd6,0x8e3a,0x8fa0,
		0x9109,0x9273,0x93e1,0x9550,0x96c2,0x9836,0x99ac,0x9b25,0x9ca0,0x9e1e,0x9f9e,0xa120,0xa2a5,0xa42c,0xa5b5,0xa741,
		0xa8d0,0xaa61,0xabf4,0xad8a,0xaf22,0xb0bd,0xb25a,0xb3fa,0xb59c,0xb741,0xb8e8,0xba92,0xbc3e,0xbded,0xbf9f,0xc153,
		0xc309,0xc4c3,0xc67f,0xc83d,0xc9fe,0xcbc2,0xcd88,0xcf51,0xd11d,0xd2eb,0xd4bc,0xd690,0xd866,0xda3f,0xdc1b,0xddfa,
		0xdfdb,0xe1bf,0xe3a6,0xe58f,0xe77c,0xe96b,0xeb5d,0xed51,0xef49,0xf143,0xf340,0xf540,0xf743,0xf949,0xfb52,0xfd5d,
		0xff6b,0x1017d,0x10391,0x105a8,0x107c2,0x109df,0x10bff,0x10e22,0x11047,0x11270,0x1149c,0x116cb,0x118fd,0x11b32,0x11d6a,0x11fa4,
		0x121e2,0x12424,0x12668,0x128af,0x12af9,0x12d47,0x12f97,0x131eb,0x13442,0x1369c,0x138f9,0x13b59,0x13dbc,0x14023,0x1428d,0x144fa,
		0x1476a,0x149de,0x14c54,0x14ecf,0x1514c,0x153cc,0x15650,0x158d7,0x15b62,0x15df0,0x16081,0x16315,0x165ad,0x16848,0x16ae7,0x16d89,
		0x1702e,0x172d7,0x17583,0x17833,0x17ae6,0x17d9c,0x18056,0x18314,0x185d5,0x18899,0x18b61,0x18e2d,0x190fc,0x193ce,0x196a5,0x1997e,
		0x19c5c,0x19f3d,0x1a221,0x1a509,0x1a7f5,0x1aae4,0x1add7,0x1b0ce,0x1b3c9,0x1b6c7,0x1b9c8,0x1bcce,0x1bfd7,0x1c2e4,0x1c5f5,0x1c909,
		0x1cc22,0x1cf3e,0x1d25e,0x1d581,0x1d8a9,0x1dbd4,0x1df03,0x1e236,0x1e56d,0x1e8a8,0x1ebe7,0x1ef29,0x1f270,0x1f5ba,0x1f908,0x1fc5b,
		0x1ffb1,0x2030b,0x2066a,0x209cc,0x20d32,0x2109d,0x2140b,0x2177e,0x21af4,0x21e6f,0x221ee,0x22571,0x228f8,0x22c83,0x23012,0x233a6,
		0x2373d,0x23ad9,0x23e79,0x2421d,0x245c6,0x24972,0x24d23,0x250d9,0x25492,0x25850,0x25c12,0x25fd9,0x263a3,0x26773,0x26b46,0x26f1e,
		0x272fa,0x276db,0x27ac0,0x27eaa,0x28298,0x2868a,0x28a81,0x28e7d,0x2927d,0x29681,0x29a8a,0x29e98,0x2a2aa,0x2a6c0,0x2aadc,0x2aefb,
		0x2b320,0x2b749,0x2bb77,0x2bfa9,0x2c3e0,0x2c81c,0x2cc5d,0x2d0a2,0x2d4ec,0x2d93a,0x2dd8e,0x2e1e6,0x2e643,0x2eaa5,0x2ef0b,0x2f377,
		0x2f7e7,0x2fc5c,0x300d6,0x30555,0x309d9,0x30e62,0x312ef,0x31782,0x31c19,0x320b6,0x32558,0x329fe,0x32eaa,0x3335a,0x33810,0x33ccb,
		0x3418b,0x34650,0x34b1a,0x34fe9,0x354bd,0x35997,0x35e75,0x36359,0x36842,0x36d31,0x37224,0x3771d,0x37c1b,0x3811f,0x38627,0x38b35,
		0x39049,0x39561,0x39a80,0x39fa3,0x3a4cc,0x3a9fa,0x3af2e,0x3b467,0x3b9a6,0x3beea,0x3c433,0x3c982,0x3ced7,0x3d431,0x3d991,0x3def6,
		0x3e461,0x3e9d2,0x3ef48,0x3f4c4,0x3fa45,0x3ffcc,0x40559,0x40aec,0x41084,0x41622,0x41bc6,0x42170,0x4271f,0x42cd4,0x4328f,0x43850,
		0x43e17,0x443e3,0x449b6,0x44f8e,0x4556d,0x45b51,0x4613b,0x4672c,0x46d22,0x4731e,0x47921,0x47f29,0x48537,0x48b4c,0x49167,0x49787,
		0x49dae,0x4a3db,0x4aa0f,0x4b048,0x4b688,0x4bcce,0x4c31a,0x4c96c,0x4cfc5,0x4d624,0x4dc8a,0x4e2f5,0x4e967,0x4efe0,0x4f65f,0x4fce4,
		0x50370,0x50a02,0x5109a,0x51739,0x51ddf,0x5248b,0x52b3e,0x531f7,0x538b7,0x53f7d,0x5464a,0x54d1e,0x553f9,0x55ada,0x561c1,0x568b0,
		0x56fa5,0x576a1,0x57da4,0x584ad,0x58bbd,0x592d5,0x599f3,0x5a117,0x5a843,0x5af76,0x5b6af,0x5bdf0,0x5c538,0x5cc86,0x5d3dc,0x5db38,
		0x5e29c,0x5ea06,0x5f178,0x5f8f1,0x60071,0x607f8,0x60f86,0x6171c,0x61eb9,0x6265d,0x62e08,0x635ba,0x63d74,0x64535,0x64cfd,0x654cd,
		0x65ca4,0x66483,0x66c69,0x67456,0x67c4b,0x68447,0x68c4b,0x69456,0x69c69,0x6a483,0x6aca5,0x6b4cf,0x6bd00,0x6c539,0x6cd79,0x6d5c2,
		0x6de12,0x6e669,0x6eec9,0x6f730,0x6ff9f,0x70815,0x71094,0x7191b,0x721a9,0x72a3f,0x732dd,0x73b83,0x74432,0x74ce8,0x755a6,0x75e6c,
		0x7673a,0x77010,0x778ef,0x781d5,0x78ac4,0x793bb,0x79cba,0x7a5c1,0x7aed1,0x7b7e8,0x7c108,0x7ca31,0x7d361,0x7dc9a,0x7e5dc,0x7ef25,
		0x7f878,0x801d2,0x80b35,0x814a1,0x81e15,0x82792,0x83117,0x83aa5,0x8443b,0x84dda,0x85782,0x86132,0x86aeb,0x874ad,0x87e78,0x8884b,
		0x89227,0x89c0c,0x8a5fa,0x8aff0,0x8b9f0,0x8c3f8,0x8ce0a,0x8d824,0x8e248,0x8ec74,0x8f6a9,0x900e8,0x90b2f,0x91580,0x91fda,0x92a3d,
		0x934a9,0x93f1e,0x9499d,0x95425,0x95eb6,0x96950,0x973f4,0x97ea1,0x98958,0x99418,0x99ee1,0x9a9b4,0x9b490,0x9bf76,0x9ca66,0x9d55f,
		0x9e061,0x9eb6d,0x9f683,0xa01a3,0xa0ccc,0xa17ff,0xa233b,0xa2e82,0xa39d2,0xa452c,0xa5090,0xa5bfe,0xa6776,0xa72f7,0xa7e83,0xa8a18,
		0xa95b8,0xaa161,0xaad15,0xab8d3,0xac49b,0xad06d,0xadc49,0xae82f,0xaf420,0xb001b,0xb0c20,0xb182f,0xb2449,0xb306d,0xb3c9c,0xb48d5,
		0xb5518,0xb6166,0xb6dbf,0xb7a22,0xb868f,0xb9307,0xb9f8a,0xbac17,0xbb8af,0xbc552,0xbd1ff,0xbdeb7,0xbeb7a,0xbf848,0xc0521,0xc1204,
		0xc1ef3,0xc2bec,0xc38f0,0xc45ff,0xc531a,0xc603f,0xc6d6f,0xc7aab,0xc87f1,0xc9543,0xca2a0,0xcb008,0xcbd7b,0xccafa,0xcd884,0xce619,
		0xcf3ba,0xd0166,0xd0f1e,0xd1ce1,0xd2aaf,0xd3889,0xd466e,0xd545f,0xd625c,0xd7064,0xd7e78,0xd8c98,0xd9ac4,0xda8fb,0xdb73e,0xdc58c,
		0xdd3e7,0xde24d,0xdf0c0,0xdff3e,0xe0dc9,0xe1c5f,0xe2b01,0xe39b0,0xe486a,0xe5731,0xe6604,0xe74e3,0xe83ce,0xe92c5,0xea1c9,0xeb0d9,
		0xebff6,0xecf1f,0xede54,0xeed96,0xefce4,0xf0c3f,0xf1ba6,0xf2b1a,0xf3a9a,0xf4a27,0xf59c1,0xf6967,0xf791b,0xf88db,0xf98a7,0xfa881,
		0xfb868,0xfc85b,0xfd85b,0xfe869,0xff883,0x1008aa,0x1018df,0x102920,0x10396f,0x1049cb,0x105a34,0x106aab,0x107b2e,0x108bbf,0x109c5d,0x10ad09,
		0x10bdc2,0x10ce89,0x10df5d,0x10f03e,0x11012d,0x11122a,0x112334,0x11344c,0x114572,0x1156a5,0x1167e6,0x117935,0x118a92,0x119bfc,0x11ad75,0x11befb,
		0x11d090,0x11e232,0x11f3e3,0x1205a1,0x12176e,0x122949,0x123b32,0x124d29,0x125f2f,0x127143,0x128365,0x129595,0x12a7d4,0x12ba22,0x12cc7d,0x12dee8,
		0x12f161,0x1303e8,0x13167e,0x132923,0x133bd7,0x134e99,0x13616a,0x13744a,0x138739,0x139a36,0x13ad43,0x13c05e,0x13d389,0x13e6c2,0x13fa0b,0x140d63,
		0x1420ca,0x143440,0x1447c5,0x145b5a,0x146efe,0x1482b1,0x149673,0x14aa46,0x14be27,0x14d218,0x14e619,0x14fa29,0x150e49,0x152278,0x1536b7,0x154b06,
		0x155f65,0x1573d3,0x158852,0x159ce0,0x15b17e,0x15c62c,0x15daeb,0x15efb9,0x160497,0x161986,0x162e84,0x164393,0x1658b2,0x166de2,0x168322,0x169872,
		0x16add3,0x16c344,0x16d8c5,0x16ee57,0x1703fa,0x1719ad,0x172f71,0x174546,0x175b2c,0x177122,0x178729,0x179d41,0x17b36a,0x17c9a4,0x17dfef,0x17f64b,
		0x180cb8,0x182336,0x1839c6,0x185067,0x186718,0x187ddc,0x1894b0,0x18ab96,0x18c28e,0x18d996,0x18f0b1,0x1907dd,0x191f1a,0x19366a,0x194dcb,0x19653d,
		0x197cc2,0x199458,0x19ac00,0x19c3ba,0x19db87,0x19f365,0x1a0b55,0x1a2357,0x1a3b6b,0x1a5392,0x1a6bcb,0x1a8416,0x1a9c73,0x1ab4e3,0x1acd65,0x1ae5fa,
		0x1afea1,0x1b175b,0x1b3027,0x1b4906,0x1b61f8,0x1b7afc,0x1b9414,0x1bad3e,0x1bc67a,0x1bdfca,0x1bf92d,0x1c12a3,0x1c2c2c,0x1c45c8,0x1c5f77,0x1c7939,
		0x1c930f,0x1cacf8,0x1cc6f4,0x1ce104,0x1cfb27,0x1d155d,0x1d2fa7,0x1d4a05,0x1d6476,0x1d7efb,0x1d9994,0x1db441,0x1dcf01,0x1de9d5,0x1e04bd,0x1e1fb9,
		0x1e3aca,0x1e55ee,0x1e7126,0x1e8c73,0x1ea7d3,0x1ec348,0x1eded2,0x1efa6f,0x1f1621,0x1f31e8,0x1f4dc3,0x1f69b3,0x1f85b7,0x1fa1d0,0x1fbdfe,0x1fda40,
		0x1ff697,0x201304,0x202f85,0x204c1b,0x2068c6,0x208586,0x20a25b,0x20bf46,0x20dc45,0x20f95a,0x211684,0x2133c4,0x215119,0x216e84,0x218c04,0x21a99a,
		0x21c745,0x21e506,0x2202dd,0x2220ca,0x223ecc,0x225ce5,0x227b13,0x229958,0x22b7b2,0x22d623,0x22f4aa,0x231347,0x2331fa,0x2350c4,0x236fa4,0x238e9a,
		0x23ada7,0x23cccb,0x23ec05,0x240b56,0x242abe,0x244a3c,0x2469d1,0x24897e,0x24a941,0x24c91b,0x24e90c,0x250914,0x252933,0x25496a,0x2569b8,0x258a1d,
		0x25aa9a,0x25cb2e,0x25ebda,0x260c9d,0x262d78,0x264e6a,0x266f74,0x269096,0x26b1d0,0x26d322,0x26f48c,0x27160d,0x2737a7,0x275959,0x277b23,0x279d06,
		0x27bf00,0x27e113,0x28033f,0x282583,0x2847e0,0x286a55,0x288ce3,0x28af89,0x28d248,0x28f521,0x291812,0x293b1c,0x295e3f,0x29817b,0x29a4d0,0x29c83f,
		0x29ebc7,0x2a0f68,0x2a3322,0x2a56f6,0x2a7ae4,0x2a9eeb,0x2ac30b,0x2ae746,0x2b0b9a,0x2b3008,0x2b5490,0x2b7931,0x2b9ded,0x2bc2c3,0x2be7b3,0x2c0cbd,
		0x2c31e1,0x2c5720,0x2c7c79,0x2ca1ec,0x2cc77a,0x2ced23,0x2d12e6,0x2d38c4,0x2d5ebd,0x2d84d0,0x2daaff,0x2dd148,0x2df7ac,0x2e1e2c,0x2e44c6,0x2e6b7c,
		0x2e924d,0x2eb939,0x2ee041,0x2f0764,0x2f2ea3,0x2f55fd,0x2f7d73,0x2fa505,0x2fccb3,0x2ff47c,0x301c62,0x304463,0x306c80,0x3094ba,0x30bd10,0x30e582,
		0x310e10,0x3136bb,0x315f82,0x318866,0x31b166,0x31da83,0x3203bd,0x322d13,0x325686,0x328017,0x32a9c4,0x32d38f,0x32fd76,0x33277b,0x33519d,0x337bdc,
		0x33a639,0x33d0b4,0x33fb4c,0x342601,0x3450d4,0x347bc5,0x34a6d4,0x34d201,0x34fd4c,0x3528b5,0x35543c,0x357fe1,0x35aba4,0x35d786,0x360386,0x362fa5,
		0x365be2,0x36883e,0x36b4b9,0x36e152,0x370e0a,0x373ae1,0x3767d7,0x3794ed,0x37c221,0x37ef74,0x381ce7,0x384a79,0x38782b,0x38a5fc,0x38d3ed,0x3901fd,
		0x39302d,0x395e7d,0x398ced,0x39bb7d,0x39ea2d,0x3a18fc,0x3a47ed,0x3a76fd,0x3aa62e,0x3ad57f,0x3b04f0,0x3b3482,0x3b6435,0x3b9409,0x3bc3fd,0x3bf412,
		0x3c2448,0x3c549f,0x3c8517,0x3cb5b1,0x3ce66b,0x3d1747,0x3d4845,0x3d7964,0x3daaa4,0x3ddc06,0x3e0d8a,0x3e3f30,0x3e70f7,0x3ea2e1,0x3ed4ec,0x3f071a,
		0x3f396a,0x3f6bdc,0x3f9e71,0x3fd128,0x400401,0x4036fd,0x406a1c,0x409d5e,0x40d0c2,0x41044a,0x4137f4,0x416bc1,0x419fb2,0x41d3c6,0x4207fd,0x423c58,
		0x4270d6,0x42a578,0x42da3e,0x430f27,0x434434,0x437965,0x43aeba,0x43e433,0x4419d0,0x444f92,0x448578,0x44bb82,0x44f1b1,0x452804,0x455e7c,0x459519,
		0x45cbdb,0x4602c2,0x4639cd,0x4670fe,0x46a854,0x46dfd0,0x471770,0x474f36,0x478722,0x47bf33,0x47f76a,0x482fc7,0x48684a,0x48a0f3,0x48d9c2,0x4912b7,
		0x494bd2,0x498514,0x49be7c,0x49f80a,0x4a31bf,0x4a6b9b,0x4aa59e,0x4adfc8,0x4b1a18,0x4b5490,0x4b8f2e,0x4bc9f4,0x4c04e2,0x4c3ff6,0x4c7b33,0x4cb696,
		0x4cf222,0x4d2dd5,0x4d69b1,0x4da5b4,0x4de1df,0x4e1e33,0x4e5aae,0x4e9752,0x4ed41f,0x4f1114,0x4f4e31,0x4f8b78,0x4fc8e7,0x50067f,0x504440,0x50822a,
		0x50c03e,0x50fe7a,0x513ce0,0x517b70,0x51ba29,0x51f90c,0x523818,0x52774f,0x52b6af,0x52f63a,0x5335ee,0x5375cd,0x53b5d7,0x53f60a,0x543668,0x5476f1,
		0x54b7a5,0x54f883,0x55398d,0x557ac1,0x55bc21,0x55fdac,0x563f62,0x568143,0x56c351,0x570589,0x5747ee,0x578a7e,0x57cd3b,0x581023,0x585337,0x589678,
		0x58d9e5,0x591d7f,0x596145,0x59a538,0x59e957,0x5a2da3,0x5a721d,0x5ab6c3,0x5afb97,0x5b4098,0x5b85c6,0x5bcb22,0x5c10ab,0x5c5662,0x5c9c47,0x5ce259,
		0x5d289a,0x5d6f09,0x5db5a6,0x5dfc71,0x5e436b,0x5e8a93,0x5ed1ea,0x5f1970,0x5f6125,0x5fa908,0x5ff11b,0x60395d,0x6081ce,0x60ca6e,0x61133e,0x615c3e,
		0x61a56d,0x61eecc,0x62385b,0x62821b,0x62cc0a,0x63162a,0x63607a,0x63aafa,0x63f5ab,0x64408d,0x648ba0,0x64d6e3,0x652258,0x656dfe,0x65b9d5,0x6605dd,
		0x665217,0x669e83,0x66eb20,0x6737f0,0x6784f1,0x67d224,0x681f89,0x686d21,0x68baeb,0x6908e8,0x695717,0x69a579,0x69f40e,0x6a42d6,0x6a91d1,0x6ae100,
		0x6b3061,0x6b7ff6,0x6bcfbf,0x6c1fbb,0x6c6fec,0x6cc050,0x6d10e8,0x6d61b4,0x6db2b5,0x6e03ea,0x6e5554,0x6ea6f2,0x6ef8c5,0x6f4acd,0x6f9d0a,0x6fef7c,
		0x704223,0x709500,0x70e812,0x713b59,0x718ed7,0x71e28a,0x723674,0x728a93,0x72dee9,0x733375,0x738837,0x73dd30,0x743260,0x7487c7,0x74dd65,0x753339,
		0x758945,0x75df89,0x763603,0x768cb6,0x76e3a0,0x773ac2,0x77921c,0x77e9ae,0x784178,0x78997b,0x78f1b6,0x794a2a,0x79a2d6,0x79fbbc,0x7a54da,0x7aae32,
		0x7b07c2,0x7b618d,0x7bbb90,0x7c15ce,0x7c7045,0x7ccaf6,0x7d25e1,0x7d8106,0x7ddc66,0x7e3800,0x7e93d5,0x7eefe4,0x7f4c2e,0x7fa8b3,0x800574,0x80626f,
		0x80bfa6,0x811d18,0x817ac6,0x81d8b0,0x8236d6,0x829538,0x82f3d6,0x8352b0,0x83b1c7,0x84111a,0x8470aa,0x84d077,0x853081,0x8590c8,0x85f14d,0x86520f,
		0x86b30e,0x87144b,0x8775c6,0x87d77f,0x883976,0x889bab,0x88fe1f,0x8960d1,0x89c3c2,0x8a26f2,0x8a8a61,0x8aee0f,0x8b51fc,0x8bb628,0x8c1a95,0x8c7f40,
		0x8ce42c,0x8d4957,0x8daec3,0x8e146f,0x8e7a5b,0x8ee088,0x8f46f6,0x8fada4,0x901493,0x907bc4,0x90e336,0x914ae9,0x91b2de,0x921b14,0x92838d,0x92ec47,
		0x935544,0x93be83,0x942804,0x9491c8,0x94fbcf,0x956619,0x95d0a5,0x963b75,0x96a689,0x9711e0,0x977d7a,0x97e959,0x98557b,0x98c1e1,0x992e8c,0x999b7b,
		0x9a08af,0x9a7628,0x9ae3e5,0x9b51e8,0x9bc030,0x9c2ebd,0x9c9d8f,0x9d0ca8,0x9d7c06,0x9debaa,0x9e5b94,0x9ecbc5,0x9f3c3c,0x9facfa,0xa01dfe,0xa08f4a,
		0xa100dc,0xa172b6,0xa1e4d7,0xa25740,0xa2c9f0,0xa33ce9,0xa3b029,0xa423b2,0xa49783,0xa50b9d,0xa57fff,0xa5f4ab,0xa6699f,0xa6dedd,0xa75464,0xa7ca34,
		0xa8404e,0xa8b6b2,0xa92d60,0xa9a458,0xaa1b9b,0xaa9328,0xab0b00,0xab8323,0xabfb90,0xac7449,0xaced4e,0xad669d,0xade039,0xae5a20,0xaed454,0xaf4ed4,
		0xafc9a0,0xb044b8,0xb0c01e,0xb13bd0,0xb1b7cf,0xb2341c,0xb2b0b6,0xb32d9d,0xb3aad3,0xb42856,0xb4a627,0xb52447,0xb5a2b5,0xb62172,0xb6a07e,0xb71fd8,
		0xb79f82,0xb81f7b,0xb89fc4,0xb9205c,0xb9a145,0xba227d,0xbaa406,0xbb25de,0xbba808,0xbc2a82,0xbcad4e,0xbd306a,0xbdb3d8,0xbe3797,0xbebba8,0xbf400b,
		0xbfc4c0,0xc049c7,0xc0cf20,0xc154cc,0xc1dacb,0xc2611d,0xc2e7c2,0xc36eba,0xc3f606,0xc47da6,0xc50599,0xc58de1,0xc6167d,0xc69f6d,0xc728b2,0xc7b24c,
		0xc83c3b,0xc8c67f,0xc95118,0xc9dc07,0xca674c,0xcaf2e7,0xcb7ed8,0xcc0b1f,0xcc97bd,0xcd24b2,0xcdb1fd,0xce3fa0,0xcecd9a,0xcf5bec,0xcfea95,0xd07996,
		0xd108f0,0xd198a1,0xd228ab,0xd2b90e,0xd349ca,0xd3dadf,0xd46c4d,0xd4fe15,0xd59036,0xd622b1,0xd6b587,0xd748b6,0xd7dc40,0xd87025,0xd90465,0xd99900,
		0xda2df6,0xdac347,0xdb58f5,0xdbeefe,0xdc8563,0xdd1c25,0xddb343,0xde4abe,0xdee296,0xdf7acb,0xe0135d,0xe0ac4d,0xe1459b,0xe1df47,0xe27951,0xe313b9,
		0xe3ae80,0xe449a5,0xe4e52a,0xe5810e,0xe61d52,0xe6b9f5,0xe756f8,0xe7f45b,0xe8921e,0xe93042,0xe9cec6,0xea6dac,0xeb0cf3,0xebac9b,0xec4ca4,0xeced10,
		0xed8ddd,0xee2f0d,0xeed09f,0xef7294,0xf014ec,0xf0b7a7,0xf15ac5,0xf1fe47,0xf2a22c,0xf34676,0xf3eb24,0xf49036,0xf535ad,0xf5db89,0xf681c9,0xf72870,
		0xf7cf7b,0xf876ed,0xf91ec5,0xf9c702,0xfa6fa7,0xfb18b2,0xfbc224,0xfc6bfd,0xfd163d,0xfdc0e5,0xfe6bf5,0xff176d,0xffc34d,0x1006f96,0x1011c48,0x101c962,
		0x10276e6,0x10324d3,0x103d32a,0x10481eb,0x1053116,0x105e0ab,0x10690ab,0x1074116,0x107f1ec,0x108a32d,0x10954da,0x10a06f3,0x10ab978,0x10b6c69,0x10c1fc6,0x10cd391,
		0x10d87c8,0x10e3c6d,0x10ef17f,0x10fa6ff,0x1105cec,0x1111348,0x111ca13,0x112814c,0x11338f4,0x113f10c,0x114a993,0x1156289,0x1161bf0,0x116d5c6,0x117900e,0x1184ac5,
		0x11905ee,0x119c188,0x11a7d93,0x11b3a10,0x11bf6ff,0x11cb461,0x11d7234,0x11e307b,0x11eef34,0x11fae60,0x1206e00,0x1212e14,0x121ee9b,0x122af97,0x1237107,0x12432ed,
		0x124f547,0x125b816,0x1267b5b,0x1273f15,0x1280346,0x128c7ed,0x1298d0a,0x12a529e,0x12b18aa,0x12bdf2c,0x12ca627,0x12d6d99,0x12e3583,0x12efde6,0x12fc6c1,0x1309015,
		0x13159e3,0x132242a,0x132eeea,0x133ba25,0x13485da,0x135520a,0x1361eb4,0x136ebd9,0x137b97a,0x1388796,0x139562e,0x13a2543,0x13af4d4,0x13bc4e1,0x13c956c,0x13d6674,
		0x13e37f9,0x13f09fc,0x13fdc7d,0x140af7d,0x14182fb,0x14256f9,0x1432b75,0x1440071,0x144d5ed,0x145abe9,0x1468265,0x1475961,0x14830df,0x14908de,0x149e15e,0x14aba60,
		0x14b93e4,0x14c6deb,0x14d4874,0x14e2380,0x14eff0f,0x14fdb22,0x150b7b8,0x15194d2,0x1527271,0x1535095,0x1542f3d,0x1550e6b,0x155ee1e,0x156ce57,0x157af16,0x158905c,
		0x1597228,0x15a547b,0x15b3755,0x15c1ab8,0x15cfea1,0x15de314,0x15ec80e,0x15fad92,0x160939e,0x1617a34,0x1626154,0x16348fd,0x1643131,0x16519f0,0x1660339,0x166ed0e,
		0x167d76e,0x168c25a,0x169add2,0x16a99d7,0x16b8668,0x16c7387,0x16d6133,0x16e4f6c,0x16f3e34,0x1702d89,0x1711d6e,0x1720de1,0x172fee4,0x173f076,0x174e298,0x175d54a,
		0x176c88d,0x177bc60,0x178b0c5,0x179a5bb,0x17a9b43,0x17b915d,0x17c880a,0x17d7f49,0x17e771b,0x17f6f81,0x180687a,0x1816208,0x1825c2a,0x18356e0,0x184522c,0x1854e0d,
		0x1864a83,0x1874790,0x1884533,0x189436d,0x18a423d,0x18b41a5,0x18c41a5,0x18d423c,0x18e436c,0x18f4535,0x1904796,0x1914a91,0x1924e26,0x1935254,0x194571d,0x1955c81,
		0x196627f,0x1976919,0x198704f,0x1997821,0x19a808f,0x19b899a,0x19c9342,0x19d9d87,0x19ea86a,0x19fb3eb,0x1a0c00b,0x1a1ccca,0x1a2da27,0x1a3e824,0x1a4f6c1,0x1a605ff,
		0x1a715dc,0x1a8265b,0x1a9377b,0x1aa493c,0x1ab5ba0,0x1ac6ea6,0x1ad824e,0x1ae969a,0x1afab89,0x1b0c11b,0x1b1d752,0x1b2ee2d,0x1b405ae,0x1b51dd3,0x1b6369e,0x1b7500f,
		0x1b86a26,0x1b984e3,0x1baa048,0x1bbbc54,0x1bcd908,0x1bdf664,0x1bf1468,0x1c03316,0x1c1526c,0x1c2726c,0x1c39316,0x1c4b46b,0x1c5d66a,0x1c6f914,0x1c81c69,0x1c9406b,
		0x1ca6519,0x1cb8a73,0x1ccb07a,0x1cdd72f,0x1cefe91,0x1d026a1,0x1d14f60,0x1d278ce,0x1d3a2eb,0x1d4cdb8,0x1d5f934,0x1d72561,0x1d8523f,0x1d97fce,0x1daae0f,0x1dbdd02,
		0x1dd0ca6,0x1de3cfe,0x1df6e09,0x1e09fc7,0x1e1d239,0x1e30560,0x1e4393b,0x1e56dcb,0x1e6a311,0x1e7d90d,0x1e90fbf,0x1ea4728,0x1eb7f47,0x1ecb81f,0x1edf1ae,0x1ef2bf5,
		0x1f066f5,0x1f1a2af,0x1f2df21,0x1f41c4e,0x1f55a35,0x1f698d7,0x1f7d834,0x1f9184c,0x1fa5920,0x1fb9ab1,0x1fcdcff,0x1fe2009,0x1ff63d2,0x200a858,0x201ed9d,0x20333a0,
		0x2047a63,0x205c1e6,0x2070a28,0x208532c,0x2099cf0,0x20ae775,0x20c32bd,0x20d7ec6,0x20ecb92,0x2101922,0x2116774,0x212b68b,0x2140666,0x2155706,0x216a86b,0x217fa96,
		0x2194d86,0x21aa13e,0x21bf5bc,0x21d4b02,0x21ea10f,0x21ff7e5,0x2214f83,0x222a7ea,0x224011c,0x2255b17,0x226b5dc,0x228116d,0x2296dc8,0x22acaf0,0x22c28e4,0x22d87a4,
		0x22ee732,0x230478d,0x231a8b6,0x2330aae,0x2346d74,0x235d10a,0x2373570,0x2389aa6,0x23a00ad,0x23b6785,0x23ccf2e,0x23e37aa,0x23fa0f8,0x2410b1a,0x242760e,0x243e1d7,
		0x2454e74,0x246bbe6,0x2482a2e,0x249994b,0x24b093f,0x24c7a09,0x24debaa,0x24f5e23,0x250d175,0x252459f,0x253baa2,0x255307e,0x256a735,0x2581ec6,0x2599732,0x25b107a,
		0x25c8a9e,0x25e059e,0x25f817b,0x260fe35,0x2627bce,0x263fa45,0x265799a,0x266f9cf,0x2687ae4,0x269fcd9,0x26b7faf,0x26d0366,0x26e87ff,0x2700d7a,0x27193d9,0x2731b1a,
		0x274a33f,0x2762c49,0x277b637,0x279410a,0x27accc4,0x27c5963,0x27de6ea,0x27f7557,0x28104ad,0x28294eb,0x2842611,0x285b821,0x2874b1b,0x288deff,0x28a73ce,0x28c0988,
		0x28da02e,0x28f37c0,0x290d040,0x29269ad,0x2940407,0x2959f51,0x2973b89,0x298d8b1,0x29a76c8,0x29c15d1,0x29db5ca,0x29f56b5,0x2a0f892,0x2a29b62,0x2a43f25,0x2a5e3db,
		0x2a78986,0x2a93026,0x2aad7bb,0x2ac8046,0x2ae29c7,0x2afd43f,0x2b17faf,0x2b32c16,0x2b4d977,0x2b687d0,0x2b83723,0x2b9e770,0x2bb98b8,0x2bd4afb,0x2befe3a,0x2c0b275,
		0x2c267ad,0x2c41de3,0x2c5d517,0x2c78d49,0x2c9467a,0x2cb00ac,0x2ccbbdd,0x2ce780f,0x2d03543,0x2d1f378,0x2d3b2b0,0x2d572eb,0x2d7342a,0x2d8f66d,0x2dab9b5,0x2dc7e02,
		0x2de4355,0x2e009ae,0x2e1d10e,0x2e39976,0x2e562e7,0x2e72d60,0x2e8f8e2,0x2eac56e,0x2ec9305,0x2ee61a7,0x2f03154,0x2f2020e,0x2f3d3d5,0x2f5a6a9,0x2f77a8b,0x2f94f7c,
		0x2fb257c,0x2fcfc8c,0x2fed4ac,0x300addd,0x302881f,0x3046374,0x3063fdc,0x3081d57,0x309fbe6,0x30bdb89,0x30dbc42,0x30f9e10,0x31180f5,0x31364f1,0x3154a04,0x3173030,
		0x3191775,0x31affd3,0x31ce94a,0x31ed3dd,0x320bf8b,0x322ac55,0x3249a3b,0x326893f,0x3287960,0x32a6aa0,0x32c5cfe,0x32e507d,0x330451b,0x3323adb,0x33431bc,0x33629bf,
		0x33822e5,0x33a1d2e,0x33c189b,0x33e152d,0x34012e5,0x34211c2,0x34411c6,0x34612f2,0x3481545,0x34a18c1,0x34c1d66,0x34e2334,0x3502a2e,0x3523252,0x3543ba2,0x356461f,
		0x35851c9,0x35a5ea1,0x35c6ca7,0x35e7bdc,0x3608c41,0x3629dd6,0x364b09c,0x366c494,0x368d9bf,0x36af01c,0x36d07ae,0x36f2073,0x3713a6e,0x373559f,0x3757206,0x3778fa4,
		0x379ae7a,0x37bce88,0x37defd0,0x3801251,0x382360d,0x3845b04,0x3868137,0x388a8a7,0x38ad154,0x38cfb3f,0x38f2668,0x39152d1,0x393807a,0x395af64,0x397df8f,0x39a10fc,
		0x39c43ad,0x39e77a0,0x3a0acd8,0x3a2e355,0x3a51b18,0x3a75421,0x3a98e72,0x3abca0a,0x3ae06ea,0x3b04514,0x3b28488,0x3b4c546,0x3b70750,0x3b94aa6,0x3bb8f49,0x3bdd53a,
		0x3c01c79,0x3c26507,0x3c4aee4,0x3c6fa12,0x3c94692,0x3cb9463,0x3cde387,0x3d033ff,0x3d285cb,0x3d4d8ec,0x3d72d62,0x3d9832f,0x3dbda53,0x3de32cf,0x3e08ca4,0x3e2e7d2,
		0x3e5445a,0x3e7a23d,0x3ea017c,0x3ec6217,0x3eec410,0x3f12766,0x3f38c1c,0x3f5f231,0x3f859a6,0x3fac27c,0x3fd2cb4,0x3ff984e,0x402054c,0x40473ae,0x406e375,0x40954a2,
		0x40bc735,0x40e3b2f,0x410b091,0x413275d,0x4159f91,0x4181931,0x41a943b,0x41d10b1,0x41f8e95,0x4220de5,0x4248ea5,0x42710d3,0x4299471,0x42c1980,0x42ea001,0x43127f4,
		0x433b15a,0x4363c34,0x438c883,0x43b5648,0x43de583,0x4407636,0x4430860,0x4459c03,0x4483121,0x44ac7b8,0x44d5fcb,0x44ff95a,0x4529467,0x45530f1,0x457cefa,0x45a6e82,
		0x45d0f8b,0x45fb215,0x4625621,0x464fbb0,0x467a2c3,0x46a4b5a,0x46cf577,0x46fa11a,0x4724e44,0x474fcf6,0x477ad31,0x47a5ef6,0x47d1245,0x47fc720,0x4827d87,0x485357b,
		0x487eefd,0x48aaa0e,0x48d66af,0x49024e1,0x492e4a4,0x495a5f9,0x49868e2,0x49b2d5f,0x49df370,0x4a0bb18,0x4a38457,0x4a64f2d,0x4a91b9c,0x4abe9a4,0x4aeb947,0x4b18a85,
		0x4b45d5f,0x4b731d6,0x4ba07eb,0x4bcdf9f,0x4bfb8f3,0x4c293e7,0x4c5707d,0x4c84eb6,0x4cb2e92,0x4ce1012,0x4d0f338,0x4d3d804,0x4d6be76,0x4d9a691,0x4dc9055,0x4df7bc3,
		0x4e268db,0x4e557a0,0x4e84810,0x4eb3a2f,0x4ee2dfc,0x4f12378,0x4f41aa5,0x4f71384,0x4fa0e14,0x4fd0a58,0x5000851,0x50307fe,0x5060961,0x5090c7c,0x50c114e,0x50f17da,
		0x5122020,0x5152a20,0x51835dc,0x51b4356,0x51e528d,0x5216383,0x5247639,0x5278aaf,0x52aa0e7,0x52db8e2,0x530d2a1,0x533ee25,0x5370b6e,0x53a2a7e,0x53d4b55,0x5406df5,
		0x543925f,0x546b894,0x549e094,0x54d0a61,0x55035fc,0x5536365,0x556929e,0x559c3a8,0x55cf683,0x5602b32,0x56361b4,0x5669a0b,0x569d437,0x56d103b,0x5704e16,0x5738dcb,
		0x576cf59,0x57a12c3,0x57d5808,0x5809f2a,0x583e82b,0x587330b,0x58a7fca,0x58dce6c,0x5911eef,0x5947156,0x597c5a1,0x59b1bd2,0x59e73e9,0x5a1cde8,0x5a529d0,0x5a887a1,
		0x5abe75d,0x5af4905,0x5b2ac9a,0x5b6121d,0x5b9798f,0x5bce2f1,0x5c04e45,0x5c3bb8b,0x5c72ac4,0x5ca9bf2,0x5ce0f16,0x5d18430,0x5d4fb43,0x5d8744e,0x5dbef53,0x5df6c53,
		0x5e2eb50,0x5e66c4a,0x5e9ef43,0x5ed743b,0x5f0fb34,0x5f4842f,0x5f80f2c,0x5fb9c2e,0x5ff2b35,0x602bc43,0x6064f58,0x609e475,0x60d7b9d,0x61114cf,0x614b00e,0x6184d59,
		0x61becb3,0x61f8e1d,0x6233197,0x626d723,0x62a7ec2,0x62e2875,0x631d43e,0x635821d,0x6393213,0x63ce423,0x640984c,0x6444e91,0x64806f2,0x64bc170,0x64f7e0d,0x6533ccb,
		0x656fda9,0x65ac0a9,0x65e85cd,0x6624d16,0x6661685,0x669e21b,0x66dafd9,0x6717fc0,0x67551d3,0x6792611,0x67cfc7c,0x680d516,0x684afe0,0x6888cda,0x68c6c06,0x6904d66,
		0x69430fa,0x69816c4,0x69bfec5,0x69fe8fe,0x6a3d571,0x6a7c41e,0x6abb507,0x6afa82e,0x6b39d93,0x6b79538,0x6bb8f1e,0x6bf8b46,0x6c389b2,0x6c78a62,0x6cb8d59,0x6cf9297,
		0x6d39a1e,0x6d7a3ee,0x6dbb00a,0x6dfbe72,0x6e3cf28,0x6e7e22e,0x6ebf783,0x6f00f2a,0x6f42925,0x6f84573,0x6fc6417,0x7008512,0x704a865,0x708ce12,0x70cf619,0x711207d,
		0x7154d3e,0x7197c5e,0x71daddf,0x721e1c0,0x7261805,0x72a50ae,0x72e8bbc,0x732c931,0x737090e,0x73b4b55,0x73f9006,0x743d724,0x74820b0,0x74c6caa,0x750bb15,0x7550bf2,
		0x7595f42,0x75db506,0x7620d40,0x76667f1,0x76ac51b,0x76f24bf,0x77386de,0x777eb7a,0x77c5295,0x780bc2e,0x7852849,0x78996e7,0x78e0808,0x7927bae,0x796f1db,0x79b6a90,
		0x79fe5ce,0x7a46398,0x7a8e3ed,0x7ad66d1,0x7b1ec43,0x7b67447,0x7bafedc,0x7bf8c05,0x7c41bc3,0x7c8ae17,0x7cd4303,0x7d1da89,0x7d674a9,0x7db1166,0x7dfb0c0,0x7e452ba,
		0x7e8f754,0x7ed9e90,0x7f24870,0x7f6f4f5,0x7fba421,0x80055f5,0x8050a72,0x809c19b,0x80e7b70,0x81337f3,0x817f726,0x81cb90a,0x8217da0,0x82644eb,0x82b0eeb,0x82fdba3,
		0x834ab13,0x8397d3d,0x83e5223,0x84329c7,0x8480429,0x84ce14c,0x851c131,0x856a3d9,0x85b8947,0x860717a,0x8655c77,0x86a4a3c,0x86f3ace,0x8742e2c,0x8792458,0x87e1d55,
		0x8831923,0x88817c4,0x88d193b,0x8921d87,0x89724ac,0x89c2eaa,0x8a13b84,0x8a64b3a,0x8ab5dce,0x8b07343,0x8b58b9a,0x8baa6d3,0x8bfc4f2,0x8c4e5f7,0x8ca09e4,0x8cf30bb,
		0x8d45a7d,0x8d9872d,0x8deb6cb,0x8e3e95a,0x8e91edb,0x8ee574f,0x8f392b9,0x8f8d11a,0x8fe1274,0x90356c8,0x9089e18,0x90de865,0x91335b3,0x9188601,0x91dd952,0x9232fa8,
		0x9288903,0x92de567,0x93344d5,0x938a74d,0x93e0cd3,0x9437568,0x948e10d,0x94e4fc4,0x953c18f,0x9593670,0x95eae68,0x964297a,0x969a7a6,0x96f28ef,0x974ad57,0x97a34de,
		0x97fbf88,0x9854d55,0x98ade48,0x9907262,0x99609a5,0x99ba413,0x9a141ae,0x9a6e277,0x9ac8670,0x9b22d9b,0x9b7d7fa,0x9bd858f,0x9c3365b,0x9c8ea60,0x9cea1a0,0x9d45c1d,
		0x9da19d9,0x9dfdad5,0x9e59f14,0x9eb6697,0x9f13160,0x9f6ff71,0x9fcd0cb,0xa02a571,0xa087d65,0xa0e58a8,0xa14373c,0xa1a1924,0xa1ffe60,0xa25e6f3,0xa2bd2df,0xa31c225,
		0xa37b4c8,0xa3daac9,0xa43a42b,0xa49a0ef,0xa4fa117,0xa55a4a5,0xa5bab9b,0xa61b5fa,0xa67c3c6,0xa6dd4ff,0xa73e9a9,0xa7a01c3,0xa801d51,0xa863c55,0xa8c5ed1,0xa9284c5,
		0xa98ae35,0xa9edb23,0xaa50b90,0xaab3f7e,0xab176ef,0xab7b1e6,0xabdf064,0xac4326b,0xaca77fe,0xad0c11e,0xad70dcd,0xadd5e0d,0xae3b1e1,0xaea094a,0xaf0644a,0xaf6c2e4,
		0xafd251a,0xb038aec,0xb09f45f,0xb106172,0xb16d22a,0xb1d4687,0xb23be8c,0xb2a3a3a,0xb30b995,0xb373c9e,0xb3dc356,0xb444dc1,0xb4adbe0,0xb516db5,0xb580343,0xb5e9c8b,
		0xb653990,0xb6bda54,0xb727ed8,0xb792720,0xb7fd32c,0xb868300,0xb8d369d,0xb93ee06,0xb9aa93d,0xba16843,0xba82b1c,0xbaef1c8,0xbb5bc4b,0xbbc8aa7,0xbc35cdd,0xbca32f0,
		0xbd10ce2,0xbd7eab6,0xbdecc6d,0xbe5b209,0xbec9b8d,0xbf388fc,0xbfa7a57,0xc016fa0,0xc0868da,0xc0f6607,0xc16672a,0xc1d6c44,0xc247557,0xc2b8267,0xc329374,0xc39a883,
		0xc40c194,0xc47deaa,0xc4effc7,0xc5624ee,0xc5d4e21,0xc647b62,0xc6bacb4,0xc72e219,0xc7a1b92,0xc815923,0xc889ace,0xc8fe095,0xc972a7a,0xc9e7880,0xca5caa9,0xcad20f7,
		0xcb47b6e,0xcbbda0e,0xcc33cdb,0xccaa3d7,0xcd20f04,0xcd97e65,0xce0f1fc,0xce869cb,0xcefe5d5,0xcf7661c,0xcfeeaa3,0xd06736c,0xd0e0079,0xd1591cd,0xd1d276b,0xd24c154,
		0xd2c5f8b,0xd340214,0xd3ba8ef,0xd43541f,0xd4b03a8,0xd52b78b,0xd5a6fcb,0xd622c6b,0xd69ed6c,0xd71b2d2,0xd797c9e,0xd814ad4,0xd891d76,0xd90f487,0xd98d008,0xda0affd,
		0xda89468,0xdb07d4b,0xdb86aa9,0xdc05c85,0xdc852e1,0xdd04dc0,0xdd84d24,0xde05110,0xde85987,0xdf0668a,0xdf8781d,0xe008e43,0xe08a8fd,0xe10c84e,0xe18ec3a,0xe2114c2,
		0xe2941e9,0xe3173b3,0xe39aa21,0xe41e536,0xe4a24f5,0xe526960,0xe5ab27b,0xe630047,0xe6b52c8,0xe73aa00,0xe7c05f2,0xe8466a1,0xe8ccc0e,0xe95363e,0xe9da532,0xea618ee,
		0xeae9173,0xeb70ec6,0xebf90e8,0xec817dd,0xed0a3a6,0xed93447,0xee1c9c3,0xeea641c,0xef30355,0xefba772,0xf045073,0xf0cfe5d,0xf15b133,0xf1e68f6,0xf2725ab,0xf2fe753,
		0xf38adf1,0xf417989,0xf4a4a1d,0xf531fb0,0xf5bfa45,0xf64d9df,0xf6dbe80,0xf76a82c,0xf7f96e5,0xf888aae,0xf91838a,0xf9a817d,0xfa38488,0xfac8caf,0xfb599f4,0xfbeac5c,
		0xfc7c3e8,0xfd0e09b,0xfda0279,0xfe32984,0xfec55c0,0xff5872f,0xffebdd4,0x1007f9b2,0x10113acd,0x101a8127,0x1023ccc3,0x102d1da5,0x103673ce,0x103fcf43,0x10493006,0x1052961b,
		0x105c0184,0x10657244,0x106ee85f,0x107863d7,0x1081e4b0,0x108b6aec,0x1094f68f,0x109e879c,0x10a81e16,0x10b1ba00,0x10bb5b5d,0x10c50230,0x10ceae7d,0x10d86046,0x10e2178f,0x10ebd45a,
		0x10f596ac,0x10ff5e86,0x11092bed,0x1112fee3,0x111cd76c,0x1126b58b,0x11309942,0x113a8296,0x11447189,0x114e661f,0x1158605b,0x1162603f,0x116c65d0,0x11767111,0x11808204,0x118a98ae,
		0x1194b511,0x119ed730,0x11a8ff0f,0x11b32cb2,0x11bd601b,0x11c7994e,0x11d1d84e,0x11dc1d1f,0x11e667c3,0x11f0b83e,0x11fb0e94,0x12056ac8,0x120fccdd,0x121a34d6,0x1224a2b7,0x122f1684,
		0x1239903f,0x12440fed,0x124e9590,0x1259212c,0x1263b2c4,0x126e4a5c,0x1278e7f7,0x12838b99,0x128e3545,0x1298e4ff,0x12a39aca,0x12ae56a9,0x12b918a0,0x12c3e0b3,0x12ceaee5,0x12d98339,
		0x12e45db4,0x12ef3e58,0x12fa2529,0x1305122b,0x13100561,0x131afecf,0x1325fe78,0x13310460,0x133c108b,0x134722fc,0x13523bb6,0x135d5abe,0x13688017,0x1373abc4,0x137eddca,0x138a162b,
		0x139554ec,0x13a09a10,0x13abe59b,0x13b73791,0x13c28ff4,0x13cdeeca,0x13d95415,0x13e4bfd9,0x13f0321b,0x13fbaadd,0x14072a24,0x1412aff3,0x141e3c4e,0x1429cf39,0x143568b7,0x144108cd,
		0x144caf7d,0x14585ccd,0x146410bf,0x146fcb58,0x147b8c9c,0x1487548d,0x14932331,0x149ef88a,0x14aad49d,0x14b6b76e,0x14c2a100,0x14ce9158,0x14da8879,0x14e68667,0x14f28b26,0x14fe96ba,
		0x150aa928,0x1516c272,0x1522e29d,0x152f09ad,0x153b37a5,0x15476c8b,0x1553a861,0x155feb2c,0x156c34f0,0x157885b0,0x1584dd72,0x15913c38,0x159da207,0x15aa0ee3,0x15b682d0,0x15c2fdd2,
		0x15cf7fed,0x15dc0926,0x15e8997f,0x15f530ff,0x1601cfa8,0x160e757e,0x161b2287,0x1627d6c5,0x1634923e,0x164154f5,0x164e1eee,0x165af02f,0x1667c8ba,0x1674a894,0x16818fc2,0x168e7e47,
		0x169b7428,0x16a87169,0x16b5760e,0x16c2821c,0x16cf9596,0x16dcb082,0x16e9d2e3,0x16f6fcbe,0x17042e17,0x171166f2,0x171ea754,0x172bef41,0x17393ebe,0x174695ce,0x1753f477,0x17615abc,
		0x176ec8a2,0x177c3e2d,0x1789bb62,0x17974045,0x17a4ccdb,0x17b26128,0x17bffd31,0x17cda0f9,0x17db4c87,0x17e8ffdd,0x17f6bb00,0x18047df6,0x181248c2,0x18201b69,0x182df5f0,0x183bd85b,
		0x1849c2af,0x1857b4f0,0x1865af23,0x1873b14c,0x1881bb70,0x188fcd95,0x189de7bd,0x18ac09ef,0x18ba342e,0x18c8667f,0x18d6a0e8,0x18e4e36c,0x18f32e11,0x190180da,0x190fdbcd,0x191e3eef,
		0x192caa44,0x193b1dd2,0x1949999b,0x19581da7,0x1966a9f9,0x19753e95,0x1983db82,0x199280c4,0x19a12e5f,0x19afe458,0x19bea2b5,0x19cd697a,0x19dc38ac,0x19eb104f,0x19f9f06a,0x1a08d900,
		0x1a17ca17,0x1a26c3b3,0x1a35c5da,0x1a44d090,0x1a53e3db,0x1a62ffbf,0x1a722441,0x1a815167,0x1a908735,0x1a9fc5b1,0x1aaf0cdf,0x1abe5cc5,0x1acdb567,0x1add16cb,0x1aec80f5,0x1afbf3ec,
		0x1b0b6fb3,0x1b1af450,0x1b2a81c9,0x1b3a1822,0x1b49b760,0x1b595f89,0x1b6910a2,0x1b78cab0,0x1b888db8,0x1b9859bf,0x1ba82ecb,0x1bb80ce2,0x1bc7f407,0x1bd7e441,0x1be7dd94,0x1bf7e007,
		0x1c07eb9d,0x1c18005e,0x1c281e4d,0x1c384571,0x1c4875ce,0x1c58af6b,0x1c68f24c,0x1c793e76,0x1c8993f0,0x1c99f2bf,0x1caa5ae7,0x1cbacc6f,0x1ccb475c,0x1cdbcbb4,0x1cec597b,0x1cfcf0b8,
		0x1d0d9170,0x1d1e3ba8,0x1d2eef66,0x1d3facb0,0x1d50738a,0x1d6143fc,0x1d721e09,0x1d8301b9,0x1d93ef10,0x1da4e614,0x1db5e6ca,0x1dc6f139,0x1dd80566,0x1de92357,0x1dfa4b11,0x1e0b7c9b,
		0x1e1cb7f9,0x1e2dfd32,0x1e3f4c4b,0x1e50a54a,0x1e620835,0x1e737512,0x1e84ebe6,0x1e966cb7,0x1ea7f78b,0x1eb98c69,0x1ecb2b55,0x1edcd456,0x1eee8771,0x1f0044ad,0x1f120c0f,0x1f23dd9d,
		0x1f35b95e,0x1f479f57,0x1f598f8e,0x1f6b8a09,0x1f7d8ece,0x1f8f9de4,0x1fa1b74f,0x1fb3db17,0x1fc60941,0x1fd841d3,0x1fea84d4,0x1ffcd249,0x200f2a39,0x20218ca9,0x2033f9a1,0x20467125,
		0x2058f33d,0x206b7fee,0x207e173f,0x2090b935,0x20a365d8,0x20b61d2d,0x20c8df3a,0x20dbac06,0x20ee8397,0x210165f4,0x21145323,0x21274b29,0x213a4e0e,0x214d5bd7,0x2160748c,0x21739832,
		0x2186c6d1,0x219a006d,0x21ad450f,0x21c094bb,0x21d3ef7a,0x21e75550,0x21fac646,0x220e4260,0x2221c9a7,0x22355c1f,0x2248f9d1,0x225ca2c2,0x227056f9,0x2284167d,0x2297e154,0x22abb785,
		0x22bf9916,0x22d3860f,0x22e77e75,0x22fb8251,0x230f91a8,0x2323ac80,0x2337d2e2,0x234c04d3,0x2360425b,0x23748b80,0x2388e049,0x239d40bd,0x23b1ace3,0x23c624c1,0x23daa85e,0x23ef37c2,
		0x2403d2f4,0x241879f9,0x242d2cda,0x2441eb9d,0x2456b648,0x246b8ce4,0x24806f78,0x24955e09,0x24aa589f,0x24bf5f42,0x24d471f8,0x24e990c9,0x24febbbb,0x2513f2d6,0x25293621,0x253e85a2,
		0x2553e162,0x25694968,0x257ebdba,0x25943e60,0x25a9cb61,0x25bf64c4,0x25d50a91,0x25eabccf,0x26007b85,0x261646bb,0x262c1e78,0x264202c4,0x2657f3a5,0x266df123,0x2683fb46,0x269a1216,
		0x26b03598,0x26c665d6,0x26dca2d6,0x26f2eca0,0x2709433c,0x271fa6b1,0x27361706,0x274c9444,0x27631e72,0x2779b597,0x279059bc,0x27a70ae7,0x27bdc921,0x27d49471,0x27eb6cdf,0x28025273,
		0x28194534,0x2830452b,0x2847525e,0x285e6cd6,0x2875949b,0x288cc9b5,0x28a40c2a,0x28bb5c04,0x28d2b94b,0x28ea2405,0x29019c3b,0x291921f6,0x2930b53c,0x29485616,0x2960048d,0x2977c0a7,
		0x298f8a6e,0x29a761e9,0x29bf4720,0x29d73a1b,0x29ef3ae3,0x2a074980,0x2a1f65f9,0x2a379058,0x2a4fc8a4,0x2a680ee6,0x2a806325,0x2a98c56a,0x2ab135be,0x2ac9b429,0x2ae240b2,0x2afadb63,
		0x2b138444,0x2b2c3b5d,0x2b4500b6,0x2b5dd458,0x2b76b64c,0x2b8fa69a,0x2ba8a54a,0x2bc1b266,0x2bdacdf4,0x2bf3f7ff,0x2c0d308f,0x2c2677ac,0x2c3fcd5e,0x2c5931af,0x2c72a4a8,0x2c8c2650,
		0x2ca5b6b0,0x2cbf55d3,0x2cd903bf,0x2cf2c07e,0x2d0c8c18,0x2d266697,0x2d405003,0x2d5a4866,0x2d744fc7,0x2d8e6630,0x2da88baa,0x2dc2c03e,0x2ddd03f4,0x2df756d6,0x2e11b8ed,0x2e2c2a42,
		0x2e46aadd,0x2e613ac8,0x2e7bda0c,0x2e9688b2,0x2eb146c4,0x2ecc1449,0x2ee6f14d,0x2f01ddd7,0x2f1cd9f1,0x2f37e5a4,0x2f5300f9,0x2f6e2bfb,0x2f8966b1,0x2fa4b126,0x2fc00b63,0x2fdb7571,
		0x2ff6ef59,0x30127926,0x302e12e0,0x3049bc91,0x30657642,0x30813ffd,0x309d19cc,0x30b903b8,0x30d4fdca,0x30f1080d,0x310d228a,0x31294d4a,0x31458858,0x3161d3bc,0x317e2f81,0x319a9bb1,
		0x31b71855,0x31d3a577,0x31f04321,0x320cf15c,0x3229b033,0x32467fb0,0x32635fdc,0x328050c1,0x329d526a,0x32ba64e0,0x32d7882e,0x32f4bc5c,0x33120176,0x332f5786,0x334cbe96,0x336a36af,
		0x3387bfdc,0x33a55a27,0x33c3059b,0x33e0c242,0x33fe9025,0x341c6f4f,0x343a5fcb,0x345861a3,0x347674e1,0x3494998f,0x34b2cfb9,0x34d11768,0x34ef70a7,0x350ddb80,0x352c57ff,0x354ae62d,
		0x35698615,0x358837c1,0x35a6fb3d,0x35c5d093,0x35e4b7cd,0x3603b0f7,0x3622bc1a,0x3641d943,0x3661087b,0x368049cd,0x369f9d44,0x36bf02ec,0x36de7acf,0x36fe04f7,0x371da170,0x373d5045,
		0x375d1181,0x377ce52e,0x379ccb58,0x37bcc40a,0x37dccf50,0x37fced33,0x381d1dbf,0x383d6100,0x385db701,0x387e1fcc,0x389e9b6e,0x38bf29f1,0x38dfcb61,0x39007fc9,0x39214734,0x394221ae,
		0x39630f43,0x39840ffe,0x39a523e9,0x39c64b12,0x39e78582,0x3a08d347,0x3a2a346b,0x3a4ba8fb,0x3a6d3101,0x3a8ecc89,0x3ab07ba0,0x3ad23e51,0x3af414a7,0x3b15feaf,0x3b37fc74,0x3b5a0e03,
		0x3b7c3366,0x3b9e6cab,0x3bc0b9dc,0x3be31b06,0x3c059035,0x3c281976,0x3c4ab6d3,0x3c6d6859,0x3c902e15,0x3cb30812,0x3cd5f65c,0x3cf8f900,0x3d1c100b,0x3d3f3b87,0x3d627b82,0x3d85d009,
		0x3da93926,0x3dccb6e7,0x3df04959,0x3e13f087,0x3e37ac7d,0x3e5b7d4a,0x3e7f62f9,0x3ea35d96,0x3ec76d2f,0x3eeb91d0,0x3f0fcb85,0x3f341a5c,0x3f587e60,0x3f7cf7a0,0x3fa18627,0x3fc62a03,
		0x3feae340,0x400fb1eb,0x40349612,0x40598fc0,0x407e9f04,0x40a3c3ea,0x40c8fe7f,0x40ee4ed0,0x4113b4eb,0x413930dc,0x415ec2b1,0x41846a76,0x41aa283a,0x41cffc0a,0x41f5e5f2,0x421be600,
		0x4241fc42,0x426828c5,0x428e6b96,0x42b4c4c3,0x42db3459,0x4301ba66,0x432856f8,0x434f0a1b,0x4375d3df,0x439cb450,0x43c3ab7c,0x43eab970,0x4411de3c,0x443919ec,0x44606c8e,0x4487d631,
		0x44af56e1,0x44d6eeae,0x44fe9da5,0x452663d4,0x454e4149,0x45763612,0x459e423e,0x45c665da,0x45eea0f5,0x4616f39d,0x463f5de0,0x4667dfcd,0x46907971,0x46b92adc,0x46e1f41c,0x470ad53e,
		0x4733ce52,0x475cdf67,0x4786088a,0x47af49ca,0x47d8a336,0x480214dd,0x482b9ecd,0x48554115,0x487efbc4,0x48a8cee8,0x48d2ba91,0x48fcbecd,0x4926dbab,0x4951113b,0x497b5f8b,0x49a5c6a9,
		0x49d046a7,0x49fadf91,0x4a259178,0x4a505c6b,0x4a7b4079,0x4aa63db1,0x4ad15422,0x4afc83dd,0x4b27ccef,0x4b532f6a,0x4b7eab5b,0x4baa40d3,0x4bd5efe0,0x4c01b894,0x4c2d9afd,0x4c59972b,
		0x4c85ad2d,0x4cb1dd13,0x4cde26ee,0x4d0a8acd,0x4d3708bf,0x4d63a0d5,0x4d90531e,0x4dbd1fab,0x4dea068b,0x4e1707cf,0x4e442386,0x4e7159c2,0x4e9eaa90,0x4ecc1604,0x4ef99c2b,0x4f273d17,
		0x4f54f8d8,0x4f82cf7e,0x4fb0c119,0x4fdecdbb,0x500cf574,0x503b3853,0x5069966b,0x50980fca,0x50c6a483,0x50f554a5,0x51242042,0x5153076a,0x51820a2e,0x51b1289e,0x51e062cd,0x520fb8ca,
		0x523f2aa7,0x526eb874,0x529e6244,0x52ce2826,0x52fe0a2c,0x532e0868,0x535e22ea,0x538e59c4,0x53bead07,0x53ef1cc5,0x541fa90e,0x545051f5,0x5481178b,0x54b1f9e1,0x54e2f90a,0x55141516,
		0x55454e17,0x5576a420,0x55a81741,0x55d9a78e,0x560b5516,0x563d1fee,0x566f0825,0x56a10dcf,0x56d330fe,0x570571c3,0x5737d031,0x576a4c59,0x579ce64f,0x57cf9e24,0x580273eb,0x583567b6,
		0x58687997,0x589ba9a1,0x58cef7e7,0x5902647b,0x5935ef6f,0x596998d6,0x599d60c3,0x59d14749,0x5a054c7b,0x5a39706a,0x5a6db32b,0x5aa214d0,0x5ad6956c,0x5b0b3512,0x5b3ff3d5,0x5b74d1c8,
		0x5ba9cefe,0x5bdeeb8c,0x5c142783,0x5c4982f7,0x5c7efdfc,0x5cb498a5,0x5cea5306,0x5d202d31,0x5d56273b,0x5d8c4137,0x5dc27b39,0x5df8d554,0x5e2f4f9d,0x5e65ea26,0x5e9ca505,0x5ed3804c,
		0x5f0a7c10,0x5f419865,0x5f78d55e,0x5fb03311,0x5fe7b191,0x601f50f2,0x60571148,0x608ef2a9,0x60c6f528,0x60ff18d9,0x61375dd2,0x616fc426,0x61a84beb,0x61e0f534,0x6219c017,0x6252aca8,
		0x628bbafd,0x62c4eb29,0x62fe3d42,0x6337b15d,0x6371478e,0x63aaffeb,0x63e4da8a,0x641ed77e,0x6458f6dd,0x649338bd,0x64cd9d33,0x65082454,0x6542ce35,0x657d9aed,0x65b88a90,0x65f39d35,
		0x662ed2f0,0x666a2bd8,0x66a5a803,0x66e14785,0x671d0a76,0x6758f0ea,0x6794faf8,0x67d128b6,0x680d7a3b,0x6849ef9b,0x688688ee,0x68c34649,0x690027c4,0x693d2d73,0x697a576f,0x69b7a5cc,
		0x69f518a3,0x6a32b009,0x6a706c15,0x6aae4cdd,0x6aec5279,0x6b2a7d00,0x6b68cc88,0x6ba74128,0x6be5daf7,0x6c249a0c,0x6c637e7f,0x6ca28867,0x6ce1b7da,0x6d210cf1,0x6d6087c2,0x6da02864,
		0x6ddfeef1,0x6e1fdb7e,0x6e5fee24,0x6ea026fa,0x6ee08618,0x6f210b96,0x6f61b78b,0x6fa28a10,0x6fe3833c,0x7024a328,0x7065e9eb,0x70a7579e,0x70e8ec59,0x712aa834,0x716c8b48,0x71ae95ad,
		0x71f0c77b,0x723320cb,0x7275a1b6,0x72b84a54,0x72fb1abd,0x733e130c,0x73813358,0x73c47bba,0x7407ec4c,0x744b8526,0x748f4662,0x74d33018,0x75174263,0x755b7d5b,0x759fe119,0x75e46db7,
		0x7629234f,0x766e01fa,0x76b309d1,0x76f83aef,0x773d956d,0x77831965,0x77c8c6f0,0x780e9e2a,0x78549f2b,0x789aca0e,0x78e11eed,0x79279de2,0x796e4708,0x79b51a78,0x79fc184e,0x7a4340a4,
		0x7a8a9394,0x7ad21139,0x7b19b9ae,0x7b618d0d,0x7ba98b71,0x7bf1b4f6,0x7c3a09b6,0x7c8289cb,0x7ccb3552,0x7d140c66,0x7d5d0f21,0x7da63da0,0x7def97fc,0x7e391e53,0x7e82d0bf,0x7eccaf5c,
		0x7f16ba46,0x7f60f198,0x7fab556f,0x7ff5e5e6,0x8040a318,0x808b8d23,0x80d6a423,0x8121e832,0x816d596f,0x81b8f7f4,0x8204c3df,0x8250bd4c,0x829ce457,0x82e9391e,0x8335bbbc,0x83826c4e,
		0x83cf4af2,0x841c57c5,0x846992e2,0x84b6fc68,0x85049474,0x85525b22,0x85a05090,0x85ee74dc,0x863cc822,0x868b4a81,0x86d9fc16,0x8728dcfe,0x8777ed58,0x87c72d41,0x88169cd7,0x88663c38,
		0x88b60b83,0x89060ad5,0x89563a4c,0x89a69a07,0x89f72a25,0x8a47eac3,0x8a98dc00,0x8ae9fdfb,0x8b3b50d3,0x8b8cd4a6,0x8bde8993,0x8c306fb9,0x8c828738,0x8cd4d02d,0x8d274ab9,0x8d79f6fb,
		0x8dccd511,0x8e1fe51c,0x8e73273b,0x8ec69b8d,0x8f1a4233,0x8f6e1b4b,0x8fc226f6,0x90166554,0x906ad685,0x90bf7aa8,0x911451de,0x91695c47,0x91be9a04,0x92140b34,0x9269aff9,0x92bf8873,
		0x931594c3,0x936bd509,0x93c24967,0x9418f1fc,0x946fceeb,0x94c6e054,0x951e2659,0x9575a11a,0x95cd50ba,0x96253559,0x967d4f19,0x96d59e1c,0x972e2283,0x9786dc71,0x97dfcc07,0x9838f167,
		0x98924cb3,0x98ebde0e,0x9945a599,0x999fa377,0x99f9d7ca,0x9a5442b5,0x9aaee45b,0x9b09bcde,0x9b64cc61,0x9bc01307,0x9c1b90f2,0x9c774646,0x9cd33327,0x9d2f57b6,0x9d8bb419,0x9de84871,
		0x9e4514e3,0x9ea21992,0x9eff56a1,0x9f5ccc36,0x9fba7a73,0xa018617d,0xa0768177,0xa0d4da86,0xa1336cce,0xa1923874,0xa1f13d9c,0xa2507c6a,0xa2aff503,0xa30fa78c,0xa36f942b,0xa3cfbb02,
		0xa4301c39,0xa490b7f3,0xa4f18e57,0xa5529f89,0xa5b3ebaf,0xa61572ef,0xa677356e,0xa6d93351,0xa73b6cbf,0xa79de1de,0xa80092d4,0xa8637fc6,0xa8c6a8db,0xa92a0e3a,0xa98db008,0xa9f18e6d,
		0xaa55a98f,0xaaba0194,0xab1e96a4,0xab8368e6,0xabe87880,0xac4dc599,0xacb3505a,0xad1918e9,0xad7f1f6e,0xade56410,0xae4be6f7,0xaeb2a84b,0xaf19a833,0xaf80e6d9,0xafe86463,0xb05020fa,
		0xb0b81cc6,0xb12057f0,0xb188d2a0,0xb1f18cff,0xb25a8735,0xb2c3c16c,0xb32d3bcc,0xb396f67f,0xb400f1ad,0xb46b2d80,0xb4d5aa21,0xb54067ba,0xb5ab6674,0xb616a67a,0xb68227f4,0xb6edeb0d,
		0xb759efef,0xb7c636c4,0xb832bfb6,0xb89f8af0,0xb90c989c,0xb979e8e5,0xb9e77bf5,0xba5551f8,0xbac36b18,0xbb31c780,0xbba0675c,0xbc0f4ad6,0xbc7e721b,0xbceddd56,0xbd5d8cb2,0xbdcd805b,
		0xbe3db87d,0xbeae3545,0xbf1ef6dd,0xbf8ffd73,0xc0014932,0xc072da48,0xc0e4b0e0,0xc156cd28,0xc1c92f4c,0xc23bd779,0xc2aec5dc,0xc321faa3,0xc39575fa,0xc409380f,0xc47d4110,0xc4f1912b,
		0xc566288c,0xc5db0763,0xc6502ddc,0xc6c59c27,0xc73b5271,0xc7b150e9,0xc82797bd,0xc89e271c,0xc914ff35,0xc98c2036,0xca038a4f,0xca7b3daf,0xcaf33a85,0xcb6b8101,0xcbe41151,0xcc5ceba6,
		0xccd6102f,0xcd4f7f1d,0xcdc9389f,0xce433ce6,0xcebd8c21,0xcf382681,0xcfb30c38,0xd02e3d74,0xd0a9ba68,0xd1258344,0xd1a1983a,0xd21df97a,0xd29aa735,0xd317a19e,0xd394e8e6,0xd4127d3e,
		0xd4905ed9,0xd50e8de8,0xd58d0a9e,0xd60bd52c,0xd68aedc6,0xd70a549e,0xd78a09e6,0xd80a0dd1,0xd88a6093,0xd90b025e,0xd98bf365,0xda0d33dc,0xda8ec3f7,0xdb10a3e8,0xdb92d3e5,0xdc155420,
		0xdc9824ce,0xdd1b4623,0xdd9eb853,0xde227b93,0xdea69017,0xdf2af614,0xdfafadc0,0xe034b74e,0xe0ba12f5,0xe13fc0e9,0xe1c5c161,0xe24c1490,0xe2d2baaf,0xe359b3f2,0xe3e1008f,0xe468a0bc,
		0xe4f094b1,0xe578dca3,0xe60178c9,0xe68a695a,0xe713ae8c,0xe79d4898,0xe82737b3,0xe8b17c16,0xe93c15f8,0xe9c70591,0xea524b18,0xeadde6c5,0xeb69d8d1,0xebf62174,0xec82c0e7,0xed0fb761,
		0xed9d051b,0xee2aaa50,0xeeb8a736,0xef46fc09,0xefd5a901,0xf064ae57,0xf0f40c46,0xf183c306,0xf213d2d3,0xf2a43be6,0xf334fe7a,0xf3c61ac9,0xf457910d,0xf4e96181,0xf57b8c61,0xf60e11e8,
		0xf6a0f250,0xf7342dd5,0xf7c7c4b2,0xf85bb724,0xf8f00567,0xf984afb5,0xfa19b64c,0xfaaf1968,0xfb44d946,0xfbdaf621,0xfc717038,0xfd0847c7,0xfd9f7d0b,0xfe371042,0xfecf01a9,0xff67517f,
		0xfff67250
	};


long long EOTF_2084(long long L)
{		
	long long idx=0,lsb=0;
	long long out=0;
	//long long i;
	
	if(L==4294967295)
		out=EOTF_tbl[4096];
	else
	{	
		idx=L>>20;
		lsb=L&0xfffff;
		out=(lsb*(long long)(EOTF_tbl[idx+1])+ (1048576-lsb)*(long long)(EOTF_tbl[idx]))>>20;// >>20 or /1048575
	}
	/*else
	{
		for(i=0;i<4096;i++)
		{
			idx=i*1048576;
			idx_next=CLIP_hdr_vivid(0,4294967295,idx+1048576);
			if(L>=idx&&L<idx_next)
			{
				out=((L-idx)*(long long)(EOTF_tbl[i+1])+(idx_next-L)*(long long)(EOTF_tbl[i]))>>20;
				break;
			}
		}
	}*/
	return out;
}

	unsigned int log_tbl[4097]={0x0,0x2688,0x302a,0x35cc,0x39cc,0x3ce6,0x3f6e,0x4193,0x436e,0x4511,0x4688,0x47db,0x4910,0x4a2d,0x4b35,
	0x4c2a,0x4d10,0x4de7,0x4eb3,0x4f73,0x502a,0x50d7,0x517d,0x521b,0x52b2,0x5344,0x53cf,0x5455,0x54d7,0x5554,0x55cc,
	0x5641,0x56b2,0x571f,0x578a,0x57f1,0x5855,0x58b6,0x5915,0x5972,0x59cc,0x5a24,0x5a79,0x5acd,0x5b1f,0x5b6f,0x5bbd,
	0x5c09,0x5c54,0x5c9e,0x5ce6,0x5d2c,0x5d71,0x5db5,0x5df7,0x5e39,0x5e79,0x5eb8,0x5ef6,0x5f32,0x5f6e,0x5fa9,0x5fe3,
	0x601c,0x6054,0x608b,0x60c1,0x60f7,0x612c,0x6160,0x6193,0x61c5,0x61f7,0x6228,0x6258,0x6288,0x62b7,0x62e6,0x6314,
	0x6341,0x636e,0x639a,0x63c6,0x63f1,0x641b,0x6445,0x646f,0x6498,0x64c1,0x64e9,0x6511,0x6538,0x655f,0x6585,0x65ac,
	0x65d1,0x65f6,0x661b,0x6640,0x6664,0x6688,0x66ab,0x66ce,0x66f1,0x6713,0x6735,0x6757,0x6778,0x6799,0x67ba,0x67db,
	0x67fb,0x681b,0x683a,0x685a,0x6879,0x6898,0x68b6,0x68d5,0x68f3,0x6910,0x692e,0x694b,0x6968,0x6985,0x69a2,0x69be,
	0x69da,0x69f6,0x6a12,0x6a2d,0x6a48,0x6a63,0x6a7e,0x6a99,0x6ab3,0x6ace,0x6ae8,0x6b02,0x6b1b,0x6b35,0x6b4e,0x6b67,
	0x6b80,0x6b99,0x6bb2,0x6bca,0x6be2,0x6bfa,0x6c12,0x6c2a,0x6c42,0x6c59,0x6c71,0x6c88,0x6c9f,0x6cb6,0x6ccc,0x6ce3,
	0x6cf9,0x6d10,0x6d26,0x6d3c,0x6d52,0x6d68,0x6d7d,0x6d93,0x6da8,0x6dbd,0x6dd2,0x6de7,0x6dfc,0x6e11,0x6e26,0x6e3a,
	0x6e4f,0x6e63,0x6e77,0x6e8b,0x6e9f,0x6eb3,0x6ec7,0x6eda,0x6eee,0x6f01,0x6f14,0x6f28,0x6f3b,0x6f4e,0x6f60,0x6f73,
	0x6f86,0x6f98,0x6fab,0x6fbd,0x6fd0,0x6fe2,0x6ff4,0x7006,0x7018,0x702a,0x703b,0x704d,0x705f,0x7070,0x7082,0x7093,
	0x70a4,0x70b5,0x70c6,0x70d7,0x70e8,0x70f9,0x710a,0x711a,0x712b,0x713b,0x714c,0x715c,0x716d,0x717d,0x718d,0x719d,
	0x71ad,0x71bd,0x71cd,0x71dd,0x71ec,0x71fc,0x720b,0x721b,0x722a,0x723a,0x7249,0x7258,0x7267,0x7277,0x7286,0x7295,
	0x72a3,0x72b2,0x72c1,0x72d0,0x72df,0x72ed,0x72fc,0x730a,0x7319,0x7327,0x7335,0x7344,0x7352,0x7360,0x736e,0x737c,
	0x738a,0x7398,0x73a6,0x73b4,0x73c1,0x73cf,0x73dd,0x73ea,0x73f8,0x7405,0x7413,0x7420,0x742e,0x743b,0x7448,0x7455,
	0x7463,0x7470,0x747d,0x748a,0x7497,0x74a4,0x74b0,0x74bd,0x74ca,0x74d7,0x74e3,0x74f0,0x74fd,0x7509,0x7516,0x7522,
	0x752f,0x753b,0x7547,0x7554,0x7560,0x756c,0x7578,0x7584,0x7590,0x759c,0x75a8,0x75b4,0x75c0,0x75cc,0x75d8,0x75e4,
	0x75f0,0x75fb,0x7607,0x7613,0x761e,0x762a,0x7635,0x7641,0x764c,0x7658,0x7663,0x766e,0x767a,0x7685,0x7690,0x769c,
	0x76a7,0x76b2,0x76bd,0x76c8,0x76d3,0x76de,0x76e9,0x76f4,0x76ff,0x770a,0x7715,0x771f,0x772a,0x7735,0x7740,0x774a,
	0x7755,0x775f,0x776a,0x7775,0x777f,0x778a,0x7794,0x779e,0x77a9,0x77b3,0x77bd,0x77c8,0x77d2,0x77dc,0x77e6,0x77f1,
	0x77fb,0x7805,0x780f,0x7819,0x7823,0x782d,0x7837,0x7841,0x784b,0x7855,0x785f,0x7869,0x7872,0x787c,0x7886,0x7890,
	0x7899,0x78a3,0x78ad,0x78b6,0x78c0,0x78ca,0x78d3,0x78dd,0x78e6,0x78f0,0x78f9,0x7902,0x790c,0x7915,0x791f,0x7928,
	0x7931,0x793a,0x7944,0x794d,0x7956,0x795f,0x7969,0x7972,0x797b,0x7984,0x798d,0x7996,0x799f,0x79a8,0x79b1,0x79ba,
	0x79c3,0x79cc,0x79d5,0x79dd,0x79e6,0x79ef,0x79f8,0x7a01,0x7a09,0x7a12,0x7a1b,0x7a24,0x7a2c,0x7a35,0x7a3e,0x7a46,
	0x7a4f,0x7a57,0x7a60,0x7a68,0x7a71,0x7a79,0x7a82,0x7a8a,0x7a93,0x7a9b,0x7aa3,0x7aac,0x7ab4,0x7abc,0x7ac5,0x7acd,
	0x7ad5,0x7ade,0x7ae6,0x7aee,0x7af6,0x7afe,0x7b06,0x7b0f,0x7b17,0x7b1f,0x7b27,0x7b2f,0x7b37,0x7b3f,0x7b47,0x7b4f,
	0x7b57,0x7b5f,0x7b67,0x7b6f,0x7b77,0x7b7f,0x7b86,0x7b8e,0x7b96,0x7b9e,0x7ba6,0x7bad,0x7bb5,0x7bbd,0x7bc5,0x7bcc,
	0x7bd4,0x7bdc,0x7be3,0x7beb,0x7bf3,0x7bfa,0x7c02,0x7c09,0x7c11,0x7c19,0x7c20,0x7c28,0x7c2f,0x7c37,0x7c3e,0x7c46,
	0x7c4d,0x7c54,0x7c5c,0x7c63,0x7c6b,0x7c72,0x7c79,0x7c81,0x7c88,0x7c8f,0x7c96,0x7c9e,0x7ca5,0x7cac,0x7cb3,0x7cbb,
	0x7cc2,0x7cc9,0x7cd0,0x7cd7,0x7cde,0x7ce6,0x7ced,0x7cf4,0x7cfb,0x7d02,0x7d09,0x7d10,0x7d17,0x7d1e,0x7d25,0x7d2c,
	0x7d33,0x7d3a,0x7d41,0x7d48,0x7d4f,0x7d56,0x7d5d,0x7d63,0x7d6a,0x7d71,0x7d78,0x7d7f,0x7d86,0x7d8c,0x7d93,0x7d9a,
	0x7da1,0x7da7,0x7dae,0x7db5,0x7dbc,0x7dc2,0x7dc9,0x7dd0,0x7dd6,0x7ddd,0x7de4,0x7dea,0x7df1,0x7df7,0x7dfe,0x7e05,
	0x7e0b,0x7e12,0x7e18,0x7e1f,0x7e25,0x7e2c,0x7e32,0x7e39,0x7e3f,0x7e46,0x7e4c,0x7e52,0x7e59,0x7e5f,0x7e66,0x7e6c,
	0x7e72,0x7e79,0x7e7f,0x7e85,0x7e8c,0x7e92,0x7e98,0x7e9f,0x7ea5,0x7eab,0x7eb2,0x7eb8,0x7ebe,0x7ec4,0x7eca,0x7ed1,
	0x7ed7,0x7edd,0x7ee3,0x7ee9,0x7ef0,0x7ef6,0x7efc,0x7f02,0x7f08,0x7f0e,0x7f14,0x7f1a,0x7f20,0x7f26,0x7f2c,0x7f32,
	0x7f38,0x7f3f,0x7f45,0x7f4b,0x7f50,0x7f56,0x7f5c,0x7f62,0x7f68,0x7f6e,0x7f74,0x7f7a,0x7f80,0x7f86,0x7f8c,0x7f92,
	0x7f98,0x7f9d,0x7fa3,0x7fa9,0x7faf,0x7fb5,0x7fbb,0x7fc0,0x7fc6,0x7fcc,0x7fd2,0x7fd7,0x7fdd,0x7fe3,0x7fe9,0x7fee,
	0x7ff4,0x7ffa,0x8000,0x8005,0x800b,0x8011,0x8016,0x801c,0x8021,0x8027,0x802d,0x8032,0x8038,0x803e,0x8043,0x8049,
	0x804e,0x8054,0x8059,0x805f,0x8065,0x806a,0x8070,0x8075,0x807b,0x8080,0x8086,0x808b,0x8091,0x8096,0x809b,0x80a1,
	0x80a6,0x80ac,0x80b1,0x80b7,0x80bc,0x80c1,0x80c7,0x80cc,0x80d1,0x80d7,0x80dc,0x80e2,0x80e7,0x80ec,0x80f2,0x80f7,
	0x80fc,0x8101,0x8107,0x810c,0x8111,0x8117,0x811c,0x8121,0x8126,0x812c,0x8131,0x8136,0x813b,0x8140,0x8146,0x814b,
	0x8150,0x8155,0x815a,0x8160,0x8165,0x816a,0x816f,0x8174,0x8179,0x817e,0x8183,0x8189,0x818e,0x8193,0x8198,0x819d,
	0x81a2,0x81a7,0x81ac,0x81b1,0x81b6,0x81bb,0x81c0,0x81c5,0x81ca,0x81cf,0x81d4,0x81d9,0x81de,0x81e3,0x81e8,0x81ed,
	0x81f2,0x81f7,0x81fc,0x8201,0x8206,0x820b,0x8210,0x8214,0x8219,0x821e,0x8223,0x8228,0x822d,0x8232,0x8237,0x823b,
	0x8240,0x8245,0x824a,0x824f,0x8254,0x8258,0x825d,0x8262,0x8267,0x826c,0x8270,0x8275,0x827a,0x827f,0x8283,0x8288,
	0x828d,0x8292,0x8296,0x829b,0x82a0,0x82a5,0x82a9,0x82ae,0x82b3,0x82b7,0x82bc,0x82c1,0x82c5,0x82ca,0x82cf,0x82d3,
	0x82d8,0x82dd,0x82e1,0x82e6,0x82ea,0x82ef,0x82f4,0x82f8,0x82fd,0x8301,0x8306,0x830b,0x830f,0x8314,0x8318,0x831d,
	0x8321,0x8326,0x832a,0x832f,0x8333,0x8338,0x833d,0x8341,0x8346,0x834a,0x834e,0x8353,0x8357,0x835c,0x8360,0x8365,
	0x8369,0x836e,0x8372,0x8377,0x837b,0x8380,0x8384,0x8388,0x838d,0x8391,0x8396,0x839a,0x839e,0x83a3,0x83a7,0x83ab,
	0x83b0,0x83b4,0x83b9,0x83bd,0x83c1,0x83c6,0x83ca,0x83ce,0x83d3,0x83d7,0x83db,0x83e0,0x83e4,0x83e8,0x83ec,0x83f1,
	0x83f5,0x83f9,0x83fe,0x8402,0x8406,0x840a,0x840f,0x8413,0x8417,0x841b,0x8420,0x8424,0x8428,0x842c,0x8430,0x8435,
	0x8439,0x843d,0x8441,0x8445,0x844a,0x844e,0x8452,0x8456,0x845a,0x845e,0x8463,0x8467,0x846b,0x846f,0x8473,0x8477,
	0x847b,0x8480,0x8484,0x8488,0x848c,0x8490,0x8494,0x8498,0x849c,0x84a0,0x84a4,0x84a9,0x84ad,0x84b1,0x84b5,0x84b9,
	0x84bd,0x84c1,0x84c5,0x84c9,0x84cd,0x84d1,0x84d5,0x84d9,0x84dd,0x84e1,0x84e5,0x84e9,0x84ed,0x84f1,0x84f5,0x84f9,
	0x84fd,0x8501,0x8505,0x8509,0x850d,0x8511,0x8515,0x8519,0x851d,0x8521,0x8525,0x8528,0x852c,0x8530,0x8534,0x8538,
	0x853c,0x8540,0x8544,0x8548,0x854c,0x854f,0x8553,0x8557,0x855b,0x855f,0x8563,0x8567,0x856b,0x856e,0x8572,0x8576,
	0x857a,0x857e,0x8582,0x8585,0x8589,0x858d,0x8591,0x8595,0x8599,0x859c,0x85a0,0x85a4,0x85a8,0x85ac,0x85af,0x85b3,
	0x85b7,0x85bb,0x85be,0x85c2,0x85c6,0x85ca,0x85cd,0x85d1,0x85d5,0x85d9,0x85dc,0x85e0,0x85e4,0x85e8,0x85eb,0x85ef,
	0x85f3,0x85f6,0x85fa,0x85fe,0x8602,0x8605,0x8609,0x860d,0x8610,0x8614,0x8618,0x861b,0x861f,0x8623,0x8626,0x862a,
	0x862e,0x8631,0x8635,0x8639,0x863c,0x8640,0x8643,0x8647,0x864b,0x864e,0x8652,0x8655,0x8659,0x865d,0x8660,0x8664,
	0x8667,0x866b,0x866f,0x8672,0x8676,0x8679,0x867d,0x8681,0x8684,0x8688,0x868b,0x868f,0x8692,0x8696,0x8699,0x869d,
	0x86a0,0x86a4,0x86a8,0x86ab,0x86af,0x86b2,0x86b6,0x86b9,0x86bd,0x86c0,0x86c4,0x86c7,0x86cb,0x86ce,0x86d2,0x86d5,
	0x86d9,0x86dc,0x86e0,0x86e3,0x86e6,0x86ea,0x86ed,0x86f1,0x86f4,0x86f8,0x86fb,0x86ff,0x8702,0x8705,0x8709,0x870c,
	0x8710,0x8713,0x8717,0x871a,0x871d,0x8721,0x8724,0x8728,0x872b,0x872e,0x8732,0x8735,0x8739,0x873c,0x873f,0x8743,
	0x8746,0x874a,0x874d,0x8750,0x8754,0x8757,0x875a,0x875e,0x8761,0x8764,0x8768,0x876b,0x876e,0x8772,0x8775,0x8778,
	0x877c,0x877f,0x8782,0x8786,0x8789,0x878c,0x8790,0x8793,0x8796,0x8799,0x879d,0x87a0,0x87a3,0x87a7,0x87aa,0x87ad,
	0x87b0,0x87b4,0x87b7,0x87ba,0x87be,0x87c1,0x87c4,0x87c7,0x87cb,0x87ce,0x87d1,0x87d4,0x87d8,0x87db,0x87de,0x87e1,
	0x87e4,0x87e8,0x87eb,0x87ee,0x87f1,0x87f5,0x87f8,0x87fb,0x87fe,0x8801,0x8805,0x8808,0x880b,0x880e,0x8811,0x8814,
	0x8818,0x881b,0x881e,0x8821,0x8824,0x8828,0x882b,0x882e,0x8831,0x8834,0x8837,0x883a,0x883e,0x8841,0x8844,0x8847,
	0x884a,0x884d,0x8850,0x8854,0x8857,0x885a,0x885d,0x8860,0x8863,0x8866,0x8869,0x886c,0x8870,0x8873,0x8876,0x8879,
	0x887c,0x887f,0x8882,0x8885,0x8888,0x888b,0x888e,0x8892,0x8895,0x8898,0x889b,0x889e,0x88a1,0x88a4,0x88a7,0x88aa,
	0x88ad,0x88b0,0x88b3,0x88b6,0x88b9,0x88bc,0x88bf,0x88c2,0x88c5,0x88c8,0x88cb,0x88ce,0x88d1,0x88d5,0x88d8,0x88db,
	0x88de,0x88e1,0x88e4,0x88e7,0x88ea,0x88ed,0x88f0,0x88f3,0x88f6,0x88f9,0x88fb,0x88fe,0x8901,0x8904,0x8907,0x890a,
	0x890d,0x8910,0x8913,0x8916,0x8919,0x891c,0x891f,0x8922,0x8925,0x8928,0x892b,0x892e,0x8931,0x8934,0x8937,0x893a,
	0x893c,0x893f,0x8942,0x8945,0x8948,0x894b,0x894e,0x8951,0x8954,0x8957,0x895a,0x895d,0x895f,0x8962,0x8965,0x8968,
	0x896b,0x896e,0x8971,0x8974,0x8977,0x8979,0x897c,0x897f,0x8982,0x8985,0x8988,0x898b,0x898e,0x8990,0x8993,0x8996,
	0x8999,0x899c,0x899f,0x89a2,0x89a4,0x89a7,0x89aa,0x89ad,0x89b0,0x89b3,0x89b5,0x89b8,0x89bb,0x89be,0x89c1,0x89c4,
	0x89c6,0x89c9,0x89cc,0x89cf,0x89d2,0x89d4,0x89d7,0x89da,0x89dd,0x89e0,0x89e2,0x89e5,0x89e8,0x89eb,0x89ee,0x89f0,
	0x89f3,0x89f6,0x89f9,0x89fb,0x89fe,0x8a01,0x8a04,0x8a07,0x8a09,0x8a0c,0x8a0f,0x8a12,0x8a14,0x8a17,0x8a1a,0x8a1d,
	0x8a1f,0x8a22,0x8a25,0x8a28,0x8a2a,0x8a2d,0x8a30,0x8a33,0x8a35,0x8a38,0x8a3b,0x8a3d,0x8a40,0x8a43,0x8a46,0x8a48,
	0x8a4b,0x8a4e,0x8a50,0x8a53,0x8a56,0x8a59,0x8a5b,0x8a5e,0x8a61,0x8a63,0x8a66,0x8a69,0x8a6b,0x8a6e,0x8a71,0x8a74,
	0x8a76,0x8a79,0x8a7c,0x8a7e,0x8a81,0x8a84,0x8a86,0x8a89,0x8a8c,0x8a8e,0x8a91,0x8a94,0x8a96,0x8a99,0x8a9c,0x8a9e,
	0x8aa1,0x8aa3,0x8aa6,0x8aa9,0x8aab,0x8aae,0x8ab1,0x8ab3,0x8ab6,0x8ab9,0x8abb,0x8abe,0x8ac0,0x8ac3,0x8ac6,0x8ac8,
	0x8acb,0x8ace,0x8ad0,0x8ad3,0x8ad5,0x8ad8,0x8adb,0x8add,0x8ae0,0x8ae2,0x8ae5,0x8ae8,0x8aea,0x8aed,0x8aef,0x8af2,
	0x8af5,0x8af7,0x8afa,0x8afc,0x8aff,0x8b02,0x8b04,0x8b07,0x8b09,0x8b0c,0x8b0e,0x8b11,0x8b14,0x8b16,0x8b19,0x8b1b,
	0x8b1e,0x8b20,0x8b23,0x8b25,0x8b28,0x8b2b,0x8b2d,0x8b30,0x8b32,0x8b35,0x8b37,0x8b3a,0x8b3c,0x8b3f,0x8b41,0x8b44,
	0x8b46,0x8b49,0x8b4c,0x8b4e,0x8b51,0x8b53,0x8b56,0x8b58,0x8b5b,0x8b5d,0x8b60,0x8b62,0x8b65,0x8b67,0x8b6a,0x8b6c,
	0x8b6f,0x8b71,0x8b74,0x8b76,0x8b79,0x8b7b,0x8b7e,0x8b80,0x8b83,0x8b85,0x8b88,0x8b8a,0x8b8d,0x8b8f,0x8b92,0x8b94,
	0x8b96,0x8b99,0x8b9b,0x8b9e,0x8ba0,0x8ba3,0x8ba5,0x8ba8,0x8baa,0x8bad,0x8baf,0x8bb2,0x8bb4,0x8bb6,0x8bb9,0x8bbb,
	0x8bbe,0x8bc0,0x8bc3,0x8bc5,0x8bc8,0x8bca,0x8bcc,0x8bcf,0x8bd1,0x8bd4,0x8bd6,0x8bd9,0x8bdb,0x8bdd,0x8be0,0x8be2,
	0x8be5,0x8be7,0x8bea,0x8bec,0x8bee,0x8bf1,0x8bf3,0x8bf6,0x8bf8,0x8bfa,0x8bfd,0x8bff,0x8c02,0x8c04,0x8c06,0x8c09,
	0x8c0b,0x8c0e,0x8c10,0x8c12,0x8c15,0x8c17,0x8c1a,0x8c1c,0x8c1e,0x8c21,0x8c23,0x8c25,0x8c28,0x8c2a,0x8c2d,0x8c2f,
	0x8c31,0x8c34,0x8c36,0x8c38,0x8c3b,0x8c3d,0x8c3f,0x8c42,0x8c44,0x8c47,0x8c49,0x8c4b,0x8c4e,0x8c50,0x8c52,0x8c55,
	0x8c57,0x8c59,0x8c5c,0x8c5e,0x8c60,0x8c63,0x8c65,0x8c67,0x8c6a,0x8c6c,0x8c6e,0x8c71,0x8c73,0x8c75,0x8c78,0x8c7a,
	0x8c7c,0x8c7f,0x8c81,0x8c83,0x8c86,0x8c88,0x8c8a,0x8c8c,0x8c8f,0x8c91,0x8c93,0x8c96,0x8c98,0x8c9a,0x8c9d,0x8c9f,
	0x8ca1,0x8ca3,0x8ca6,0x8ca8,0x8caa,0x8cad,0x8caf,0x8cb1,0x8cb3,0x8cb6,0x8cb8,0x8cba,0x8cbd,0x8cbf,0x8cc1,0x8cc3,
	0x8cc6,0x8cc8,0x8cca,0x8ccc,0x8ccf,0x8cd1,0x8cd3,0x8cd6,0x8cd8,0x8cda,0x8cdc,0x8cdf,0x8ce1,0x8ce3,0x8ce5,0x8ce8,
	0x8cea,0x8cec,0x8cee,0x8cf1,0x8cf3,0x8cf5,0x8cf7,0x8cf9,0x8cfc,0x8cfe,0x8d00,0x8d02,0x8d05,0x8d07,0x8d09,0x8d0b,
	0x8d0e,0x8d10,0x8d12,0x8d14,0x8d16,0x8d19,0x8d1b,0x8d1d,0x8d1f,0x8d22,0x8d24,0x8d26,0x8d28,0x8d2a,0x8d2d,0x8d2f,
	0x8d31,0x8d33,0x8d35,0x8d38,0x8d3a,0x8d3c,0x8d3e,0x8d40,0x8d43,0x8d45,0x8d47,0x8d49,0x8d4b,0x8d4e,0x8d50,0x8d52,
	0x8d54,0x8d56,0x8d58,0x8d5b,0x8d5d,0x8d5f,0x8d61,0x8d63,0x8d65,0x8d68,0x8d6a,0x8d6c,0x8d6e,0x8d70,0x8d72,0x8d75,
	0x8d77,0x8d79,0x8d7b,0x8d7d,0x8d7f,0x8d82,0x8d84,0x8d86,0x8d88,0x8d8a,0x8d8c,0x8d8e,0x8d91,0x8d93,0x8d95,0x8d97,
	0x8d99,0x8d9b,0x8d9d,0x8da0,0x8da2,0x8da4,0x8da6,0x8da8,0x8daa,0x8dac,0x8daf,0x8db1,0x8db3,0x8db5,0x8db7,0x8db9,
	0x8dbb,0x8dbd,0x8dc0,0x8dc2,0x8dc4,0x8dc6,0x8dc8,0x8dca,0x8dcc,0x8dce,0x8dd0,0x8dd2,0x8dd5,0x8dd7,0x8dd9,0x8ddb,
	0x8ddd,0x8ddf,0x8de1,0x8de3,0x8de5,0x8de7,0x8dea,0x8dec,0x8dee,0x8df0,0x8df2,0x8df4,0x8df6,0x8df8,0x8dfa,0x8dfc,
	0x8dfe,0x8e01,0x8e03,0x8e05,0x8e07,0x8e09,0x8e0b,0x8e0d,0x8e0f,0x8e11,0x8e13,0x8e15,0x8e17,0x8e19,0x8e1b,0x8e1d,
	0x8e20,0x8e22,0x8e24,0x8e26,0x8e28,0x8e2a,0x8e2c,0x8e2e,0x8e30,0x8e32,0x8e34,0x8e36,0x8e38,0x8e3a,0x8e3c,0x8e3e,
	0x8e40,0x8e42,0x8e44,0x8e46,0x8e49,0x8e4b,0x8e4d,0x8e4f,0x8e51,0x8e53,0x8e55,0x8e57,0x8e59,0x8e5b,0x8e5d,0x8e5f,
	0x8e61,0x8e63,0x8e65,0x8e67,0x8e69,0x8e6b,0x8e6d,0x8e6f,0x8e71,0x8e73,0x8e75,0x8e77,0x8e79,0x8e7b,0x8e7d,0x8e7f,
	0x8e81,0x8e83,0x8e85,0x8e87,0x8e89,0x8e8b,0x8e8d,0x8e8f,0x8e91,0x8e93,0x8e95,0x8e97,0x8e99,0x8e9b,0x8e9d,0x8e9f,
	0x8ea1,0x8ea3,0x8ea5,0x8ea7,0x8ea9,0x8eab,0x8ead,0x8eaf,0x8eb1,0x8eb3,0x8eb5,0x8eb7,0x8eb9,0x8ebb,0x8ebd,0x8ebf,
	0x8ec1,0x8ec3,0x8ec5,0x8ec7,0x8ec9,0x8eca,0x8ecc,0x8ece,0x8ed0,0x8ed2,0x8ed4,0x8ed6,0x8ed8,0x8eda,0x8edc,0x8ede,
	0x8ee0,0x8ee2,0x8ee4,0x8ee6,0x8ee8,0x8eea,0x8eec,0x8eee,0x8ef0,0x8ef2,0x8ef3,0x8ef5,0x8ef7,0x8ef9,0x8efb,0x8efd,
	0x8eff,0x8f01,0x8f03,0x8f05,0x8f07,0x8f09,0x8f0b,0x8f0d,0x8f0f,0x8f10,0x8f12,0x8f14,0x8f16,0x8f18,0x8f1a,0x8f1c,
	0x8f1e,0x8f20,0x8f22,0x8f24,0x8f26,0x8f28,0x8f29,0x8f2b,0x8f2d,0x8f2f,0x8f31,0x8f33,0x8f35,0x8f37,0x8f39,0x8f3b,
	0x8f3c,0x8f3e,0x8f40,0x8f42,0x8f44,0x8f46,0x8f48,0x8f4a,0x8f4c,0x8f4e,0x8f4f,0x8f51,0x8f53,0x8f55,0x8f57,0x8f59,
	0x8f5b,0x8f5d,0x8f5f,0x8f60,0x8f62,0x8f64,0x8f66,0x8f68,0x8f6a,0x8f6c,0x8f6e,0x8f6f,0x8f71,0x8f73,0x8f75,0x8f77,
	0x8f79,0x8f7b,0x8f7d,0x8f7e,0x8f80,0x8f82,0x8f84,0x8f86,0x8f88,0x8f8a,0x8f8b,0x8f8d,0x8f8f,0x8f91,0x8f93,0x8f95,
	0x8f97,0x8f98,0x8f9a,0x8f9c,0x8f9e,0x8fa0,0x8fa2,0x8fa4,0x8fa5,0x8fa7,0x8fa9,0x8fab,0x8fad,0x8faf,0x8fb0,0x8fb2,
	0x8fb4,0x8fb6,0x8fb8,0x8fba,0x8fbb,0x8fbd,0x8fbf,0x8fc1,0x8fc3,0x8fc5,0x8fc6,0x8fc8,0x8fca,0x8fcc,0x8fce,0x8fd0,
	0x8fd1,0x8fd3,0x8fd5,0x8fd7,0x8fd9,0x8fdb,0x8fdc,0x8fde,0x8fe0,0x8fe2,0x8fe4,0x8fe5,0x8fe7,0x8fe9,0x8feb,0x8fed,
	0x8fee,0x8ff0,0x8ff2,0x8ff4,0x8ff6,0x8ff8,0x8ff9,0x8ffb,0x8ffd,0x8fff,0x9001,0x9002,0x9004,0x9006,0x9008,0x900a,
	0x900b,0x900d,0x900f,0x9011,0x9012,0x9014,0x9016,0x9018,0x901a,0x901b,0x901d,0x901f,0x9021,0x9023,0x9024,0x9026,
	0x9028,0x902a,0x902b,0x902d,0x902f,0x9031,0x9033,0x9034,0x9036,0x9038,0x903a,0x903b,0x903d,0x903f,0x9041,0x9043,
	0x9044,0x9046,0x9048,0x904a,0x904b,0x904d,0x904f,0x9051,0x9052,0x9054,0x9056,0x9058,0x9059,0x905b,0x905d,0x905f,
	0x9060,0x9062,0x9064,0x9066,0x9067,0x9069,0x906b,0x906d,0x906e,0x9070,0x9072,0x9074,0x9075,0x9077,0x9079,0x907b,
	0x907c,0x907e,0x9080,0x9082,0x9083,0x9085,0x9087,0x9088,0x908a,0x908c,0x908e,0x908f,0x9091,0x9093,0x9095,0x9096,
	0x9098,0x909a,0x909b,0x909d,0x909f,0x90a1,0x90a2,0x90a4,0x90a6,0x90a8,0x90a9,0x90ab,0x90ad,0x90ae,0x90b0,0x90b2,
	0x90b4,0x90b5,0x90b7,0x90b9,0x90ba,0x90bc,0x90be,0x90bf,0x90c1,0x90c3,0x90c5,0x90c6,0x90c8,0x90ca,0x90cb,0x90cd,
	0x90cf,0x90d0,0x90d2,0x90d4,0x90d6,0x90d7,0x90d9,0x90db,0x90dc,0x90de,0x90e0,0x90e1,0x90e3,0x90e5,0x90e6,0x90e8,
	0x90ea,0x90ec,0x90ed,0x90ef,0x90f1,0x90f2,0x90f4,0x90f6,0x90f7,0x90f9,0x90fb,0x90fc,0x90fe,0x9100,0x9101,0x9103,
	0x9105,0x9106,0x9108,0x910a,0x910b,0x910d,0x910f,0x9110,0x9112,0x9114,0x9115,0x9117,0x9119,0x911a,0x911c,0x911e,
	0x911f,0x9121,0x9123,0x9124,0x9126,0x9128,0x9129,0x912b,0x912d,0x912e,0x9130,0x9132,0x9133,0x9135,0x9137,0x9138,
	0x913a,0x913b,0x913d,0x913f,0x9140,0x9142,0x9144,0x9145,0x9147,0x9149,0x914a,0x914c,0x914e,0x914f,0x9151,0x9152,
	0x9154,0x9156,0x9157,0x9159,0x915b,0x915c,0x915e,0x9160,0x9161,0x9163,0x9164,0x9166,0x9168,0x9169,0x916b,0x916d,
	0x916e,0x9170,0x9171,0x9173,0x9175,0x9176,0x9178,0x917a,0x917b,0x917d,0x917e,0x9180,0x9182,0x9183,0x9185,0x9186,
	0x9188,0x918a,0x918b,0x918d,0x918f,0x9190,0x9192,0x9193,0x9195,0x9197,0x9198,0x919a,0x919b,0x919d,0x919f,0x91a0,
	0x91a2,0x91a3,0x91a5,0x91a7,0x91a8,0x91aa,0x91ab,0x91ad,0x91af,0x91b0,0x91b2,0x91b3,0x91b5,0x91b7,0x91b8,0x91ba,
	0x91bb,0x91bd,0x91be,0x91c0,0x91c2,0x91c3,0x91c5,0x91c6,0x91c8,0x91ca,0x91cb,0x91cd,0x91ce,0x91d0,0x91d1,0x91d3,
	0x91d5,0x91d6,0x91d8,0x91d9,0x91db,0x91dd,0x91de,0x91e0,0x91e1,0x91e3,0x91e4,0x91e6,0x91e8,0x91e9,0x91eb,0x91ec,
	0x91ee,0x91ef,0x91f1,0x91f2,0x91f4,0x91f6,0x91f7,0x91f9,0x91fa,0x91fc,0x91fd,0x91ff,0x9201,0x9202,0x9204,0x9205,
	0x9207,0x9208,0x920a,0x920b,0x920d,0x920f,0x9210,0x9212,0x9213,0x9215,0x9216,0x9218,0x9219,0x921b,0x921c,0x921e,
	0x9220,0x9221,0x9223,0x9224,0x9226,0x9227,0x9229,0x922a,0x922c,0x922d,0x922f,0x9231,0x9232,0x9234,0x9235,0x9237,
	0x9238,0x923a,0x923b,0x923d,0x923e,0x9240,0x9241,0x9243,0x9244,0x9246,0x9248,0x9249,0x924b,0x924c,0x924e,0x924f,
	0x9251,0x9252,0x9254,0x9255,0x9257,0x9258,0x925a,0x925b,0x925d,0x925e,0x9260,0x9261,0x9263,0x9264,0x9266,0x9267,
	0x9269,0x926a,0x926c,0x926d,0x926f,0x9271,0x9272,0x9274,0x9275,0x9277,0x9278,0x927a,0x927b,0x927d,0x927e,0x9280,
	0x9281,0x9283,0x9284,0x9286,0x9287,0x9289,0x928a,0x928c,0x928d,0x928f,0x9290,0x9292,0x9293,0x9295,0x9296,0x9298,
	0x9299,0x929b,0x929c,0x929e,0x929f,0x92a1,0x92a2,0x92a3,0x92a5,0x92a6,0x92a8,0x92a9,0x92ab,0x92ac,0x92ae,0x92af,
	0x92b1,0x92b2,0x92b4,0x92b5,0x92b7,0x92b8,0x92ba,0x92bb,0x92bd,0x92be,0x92c0,0x92c1,0x92c3,0x92c4,0x92c6,0x92c7,
	0x92c9,0x92ca,0x92cb,0x92cd,0x92ce,0x92d0,0x92d1,0x92d3,0x92d4,0x92d6,0x92d7,0x92d9,0x92da,0x92dc,0x92dd,0x92df,
	0x92e0,0x92e1,0x92e3,0x92e4,0x92e6,0x92e7,0x92e9,0x92ea,0x92ec,0x92ed,0x92ef,0x92f0,0x92f2,0x92f3,0x92f4,0x92f6,
	0x92f7,0x92f9,0x92fa,0x92fc,0x92fd,0x92ff,0x9300,0x9302,0x9303,0x9304,0x9306,0x9307,0x9309,0x930a,0x930c,0x930d,
	0x930f,0x9310,0x9311,0x9313,0x9314,0x9316,0x9317,0x9319,0x931a,0x931c,0x931d,0x931e,0x9320,0x9321,0x9323,0x9324,
	0x9326,0x9327,0x9328,0x932a,0x932b,0x932d,0x932e,0x9330,0x9331,0x9332,0x9334,0x9335,0x9337,0x9338,0x933a,0x933b,
	0x933c,0x933e,0x933f,0x9341,0x9342,0x9344,0x9345,0x9346,0x9348,0x9349,0x934b,0x934c,0x934e,0x934f,0x9350,0x9352,
	0x9353,0x9355,0x9356,0x9357,0x9359,0x935a,0x935c,0x935d,0x935f,0x9360,0x9361,0x9363,0x9364,0x9366,0x9367,0x9368,
	0x936a,0x936b,0x936d,0x936e,0x936f,0x9371,0x9372,0x9374,0x9375,0x9376,0x9378,0x9379,0x937b,0x937c,0x937d,0x937f,
	0x9380,0x9382,0x9383,0x9384,0x9386,0x9387,0x9389,0x938a,0x938b,0x938d,0x938e,0x9390,0x9391,0x9392,0x9394,0x9395,
	0x9397,0x9398,0x9399,0x939b,0x939c,0x939e,0x939f,0x93a0,0x93a2,0x93a3,0x93a4,0x93a6,0x93a7,0x93a9,0x93aa,0x93ab,
	0x93ad,0x93ae,0x93b0,0x93b1,0x93b2,0x93b4,0x93b5,0x93b6,0x93b8,0x93b9,0x93bb,0x93bc,0x93bd,0x93bf,0x93c0,0x93c1,
	0x93c3,0x93c4,0x93c6,0x93c7,0x93c8,0x93ca,0x93cb,0x93cc,0x93ce,0x93cf,0x93d0,0x93d2,0x93d3,0x93d5,0x93d6,0x93d7,
	0x93d9,0x93da,0x93db,0x93dd,0x93de,0x93df,0x93e1,0x93e2,0x93e4,0x93e5,0x93e6,0x93e8,0x93e9,0x93ea,0x93ec,0x93ed,
	0x93ee,0x93f0,0x93f1,0x93f3,0x93f4,0x93f5,0x93f7,0x93f8,0x93f9,0x93fb,0x93fc,0x93fd,0x93ff,0x9400,0x9401,0x9403,
	0x9404,0x9405,0x9407,0x9408,0x9409,0x940b,0x940c,0x940e,0x940f,0x9410,0x9412,0x9413,0x9414,0x9416,0x9417,0x9418,
	0x941a,0x941b,0x941c,0x941e,0x941f,0x9420,0x9422,0x9423,0x9424,0x9426,0x9427,0x9428,0x942a,0x942b,0x942c,0x942e,
	0x942f,0x9430,0x9432,0x9433,0x9434,0x9436,0x9437,0x9438,0x943a,0x943b,0x943c,0x943e,0x943f,0x9440,0x9442,0x9443,
	0x9444,0x9446,0x9447,0x9448,0x944a,0x944b,0x944c,0x944d,0x944f,0x9450,0x9451,0x9453,0x9454,0x9455,0x9457,0x9458,
	0x9459,0x945b,0x945c,0x945d,0x945f,0x9460,0x9461,0x9463,0x9464,0x9465,0x9466,0x9468,0x9469,0x946a,0x946c,0x946d,
	0x946e,0x9470,0x9471,0x9472,0x9474,0x9475,0x9476,0x9477,0x9479,0x947a,0x947b,0x947d,0x947e,0x947f,0x9481,0x9482,
	0x9483,0x9485,0x9486,0x9487,0x9488,0x948a,0x948b,0x948c,0x948e,0x948f,0x9490,0x9491,0x9493,0x9494,0x9495,0x9497,
	0x9498,0x9499,0x949b,0x949c,0x949d,0x949e,0x94a0,0x94a1,0x94a2,0x94a4,0x94a5,0x94a6,0x94a7,0x94a9,0x94aa,0x94ab,
	0x94ad,0x94ae,0x94af,0x94b0,0x94b2,0x94b3,0x94b4,0x94b6,0x94b7,0x94b8,0x94b9,0x94bb,0x94bc,0x94bd,0x94bf,0x94c0,
	0x94c1,0x94c2,0x94c4,0x94c5,0x94c6,0x94c7,0x94c9,0x94ca,0x94cb,0x94cd,0x94ce,0x94cf,0x94d0,0x94d2,0x94d3,0x94d4,
	0x94d5,0x94d7,0x94d8,0x94d9,0x94db,0x94dc,0x94dd,0x94de,0x94e0,0x94e1,0x94e2,0x94e3,0x94e5,0x94e6,0x94e7,0x94e9,
	0x94ea,0x94eb,0x94ec,0x94ee,0x94ef,0x94f0,0x94f1,0x94f3,0x94f4,0x94f5,0x94f6,0x94f8,0x94f9,0x94fa,0x94fb,0x94fd,
	0x94fe,0x94ff,0x9500,0x9502,0x9503,0x9504,0x9505,0x9507,0x9508,0x9509,0x950a,0x950c,0x950d,0x950e,0x950f,0x9511,
	0x9512,0x9513,0x9514,0x9516,0x9517,0x9518,0x9519,0x951b,0x951c,0x951d,0x951e,0x9520,0x9521,0x9522,0x9523,0x9525,
	0x9526,0x9527,0x9528,0x952a,0x952b,0x952c,0x952d,0x952f,0x9530,0x9531,0x9532,0x9534,0x9535,0x9536,0x9537,0x9539,
	0x953a,0x953b,0x953c,0x953d,0x953f,0x9540,0x9541,0x9542,0x9544,0x9545,0x9546,0x9547,0x9549,0x954a,0x954b,0x954c,
	0x954d,0x954f,0x9550,0x9551,0x9552,0x9554,0x9555,0x9556,0x9557,0x9559,0x955a,0x955b,0x955c,0x955d,0x955f,0x9560,
	0x9561,0x9562,0x9564,0x9565,0x9566,0x9567,0x9568,0x956a,0x956b,0x956c,0x956d,0x956f,0x9570,0x9571,0x9572,0x9573,
	0x9575,0x9576,0x9577,0x9578,0x9579,0x957b,0x957c,0x957d,0x957e,0x9580,0x9581,0x9582,0x9583,0x9584,0x9586,0x9587,
	0x9588,0x9589,0x958a,0x958c,0x958d,0x958e,0x958f,0x9590,0x9592,0x9593,0x9594,0x9595,0x9596,0x9598,0x9599,0x959a,
	0x959b,0x959c,0x959e,0x959f,0x95a0,0x95a1,0x95a2,0x95a4,0x95a5,0x95a6,0x95a7,0x95a8,0x95aa,0x95ab,0x95ac,0x95ad,
	0x95ae,0x95b0,0x95b1,0x95b2,0x95b3,0x95b4,0x95b6,0x95b7,0x95b8,0x95b9,0x95ba,0x95bc,0x95bd,0x95be,0x95bf,0x95c0,
	0x95c2,0x95c3,0x95c4,0x95c5,0x95c6,0x95c7,0x95c9,0x95ca,0x95cb,0x95cc,0x95cd,0x95cf,0x95d0,0x95d1,0x95d2,0x95d3,
	0x95d5,0x95d6,0x95d7,0x95d8,0x95d9,0x95da,0x95dc,0x95dd,0x95de,0x95df,0x95e0,0x95e2,0x95e3,0x95e4,0x95e5,0x95e6,
	0x95e7,0x95e9,0x95ea,0x95eb,0x95ec,0x95ed,0x95ee,0x95f0,0x95f1,0x95f2,0x95f3,0x95f4,0x95f5,0x95f7,0x95f8,0x95f9,
	0x95fa,0x95fb,0x95fd,0x95fe,0x95ff,0x9600,0x9601,0x9602,0x9604,0x9605,0x9606,0x9607,0x9608,0x9609,0x960b,0x960c,
	0x960d,0x960e,0x960f,0x9610,0x9612,0x9613,0x9614,0x9615,0x9616,0x9617,0x9618,0x961a,0x961b,0x961c,0x961d,0x961e,
	0x961f,0x9621,0x9622,0x9623,0x9624,0x9625,0x9626,0x9628,0x9629,0x962a,0x962b,0x962c,0x962d,0x962e,0x9630,0x9631,
	0x9632,0x9633,0x9634,0x9635,0x9637,0x9638,0x9639,0x963a,0x963b,0x963c,0x963d,0x963f,0x9640,0x9641,0x9642,0x9643,
	0x9644,0x9645,0x9647,0x9648,0x9649,0x964a,0x964b,0x964c,0x964d,0x964f,0x9650,0x9651,0x9652,0x9653,0x9654,0x9655,
	0x9657,0x9658,0x9659,0x965a,0x965b,0x965c,0x965d,0x965f,0x9660,0x9661,0x9662,0x9663,0x9664,0x9665,0x9667,0x9668,
	0x9669,0x966a,0x966b,0x966c,0x966d,0x966e,0x9670,0x9671,0x9672,0x9673,0x9674,0x9675,0x9676,0x9678,0x9679,0x967a,
	0x967b,0x967c,0x967d,0x967e,0x967f,0x9681,0x9682,0x9683,0x9684,0x9685,0x9686,0x9687,0x9688,0x968a,0x968b,0x968c,
	0x968d,0x968e,0x968f,0x9690,0x9691,0x9693,0x9694,0x9695,0x9696,0x9697,0x9698,0x9699,0x969a,0x969c,0x969d,0x969e,
	0x969f,0x96a0,0x96a1,0x96a2,0x96a3,0x96a4,0x96a6,0x96a7,0x96a8,0x96a9,0x96aa,0x96ab,0x96ac,0x96ad,0x96af,0x96b0,
	0x96b1,0x96b2,0x96b3,0x96b4,0x96b5,0x96b6,0x96b7,0x96b9,0x96ba,0x96bb,0x96bc,0x96bd,0x96be,0x96bf,0x96c0,0x96c1,
	0x96c2,0x96c4,0x96c5,0x96c6,0x96c7,0x96c8,0x96c9,0x96ca,0x96cb,0x96cc,0x96ce,0x96cf,0x96d0,0x96d1,0x96d2,0x96d3,
	0x96d4,0x96d5,0x96d6,0x96d7,0x96d9,0x96da,0x96db,0x96dc,0x96dd,0x96de,0x96df,0x96e0,0x96e1,0x96e2,0x96e4,0x96e5,
	0x96e6,0x96e7,0x96e8,0x96e9,0x96ea,0x96eb,0x96ec,0x96ed,0x96ee,0x96f0,0x96f1,0x96f2,0x96f3,0x96f4,0x96f5,0x96f6,
	0x96f7,0x96f8,0x96f9,0x96fa,0x96fc,0x96fd,0x96fe,0x96ff,0x9700,0x9701,0x9702,0x9703,0x9704,0x9705,0x9706,0x9708,
	0x9709,0x970a,0x970b,0x970c,0x970d,0x970e,0x970f,0x9710,0x9711,0x9712,0x9713,0x9715,0x9716,0x9717,0x9718,0x9719,
	0x971a,0x971b,0x971c,0x971d,0x971e,0x971f,0x9720,0x9721,0x9723,0x9724,0x9725,0x9726,0x9727,0x9728,0x9729,0x972a,
	0x972b,0x972c,0x972d,0x972e,0x972f,0x9731,0x9732,0x9733,0x9734,0x9735,0x9736,0x9737,0x9738,0x9739,0x973a,0x973b,
	0x973c,0x973d,0x973e,0x9740,0x9741,0x9742,0x9743,0x9744,0x9745,0x9746,0x9747,0x9748,0x9749,0x974a,0x974b,0x974c,
	0x974d,0x974e,0x9750,0x9751,0x9752,0x9753,0x9754,0x9755,0x9756,0x9757,0x9758,0x9759,0x975a,0x975b,0x975c,0x975d,
	0x975e,0x975f,0x9760,0x9762,0x9763,0x9764,0x9765,0x9766,0x9767,0x9768,0x9769,0x976a,0x976b,0x976c,0x976d,0x976e,
	0x976f,0x9770,0x9771,0x9772,0x9773,0x9775,0x9776,0x9777,0x9778,0x9779,0x977a,0x977b,0x977c,0x977d,0x977e,0x977f,
	0x9780,0x9781,0x9782,0x9783,0x9784,0x9785,0x9786,0x9787,0x9788,0x978a,0x978b,0x978c,0x978d,0x978e,0x978f,0x9790,
	0x9791,0x9792,0x9793,0x9794,0x9795,0x9796,0x9797,0x9798,0x9799,0x979a,0x979b,0x979c,0x979d,0x979e,0x979f,0x97a0,
	0x97a2,0x97a3,0x97a4,0x97a5,0x97a6,0x97a7,0x97a8,0x97a9,0x97aa,0x97ab,0x97ac,0x97ad,0x97ae,0x97af,0x97b0,0x97b1,
	0x97b2,0x97b3,0x97b4,0x97b5,0x97b6,0x97b7,0x97b8,0x97b9,0x97ba,0x97bb,0x97bc,0x97bd,0x97be,0x97c0,0x97c1,0x97c2,
	0x97c3,0x97c4,0x97c5,0x97c6,0x97c7,0x97c8,0x97c9,0x97ca,0x97cb,0x97cc,0x97cd,0x97ce,0x97cf,0x97d0,0x97d1,0x97d2,
	0x97d3,0x97d4,0x97d5,0x97d6,0x97d7,0x97d8,0x97d9,0x97da,0x97db,0x97dc,0x97dd,0x97de,0x97df,0x97e0,0x97e1,0x97e2,
	0x97e3,0x97e4,0x97e5,0x97e6,0x97e7,0x97e9,0x97ea,0x97eb,0x97ec,0x97ed,0x97ee,0x97ef,0x97f0,0x97f1,0x97f2,0x97f3,
	0x97f4,0x97f5,0x97f6,0x97f7,0x97f8,0x97f9,0x97fa,0x97fb,0x97fc,0x97fd,0x97fe,0x97ff,0x9800,0x9801,0x9802,0x9803,
	0x9804,0x9805,0x9806,0x9807,0x9808,0x9809,0x980a,0x980b,0x980c,0x980d,0x980e,0x980f,0x9810,0x9811,0x9812,0x9813,
	0x9814,0x9815,0x9816,0x9817,0x9818,0x9819,0x981a,0x981b,0x981c,0x981d,0x981e,0x981f,0x9820,0x9821,0x9822,0x9823,
	0x9824,0x9825,0x9826,0x9827,0x9828,0x9829,0x982a,0x982b,0x982c,0x982d,0x982e,0x982f,0x9830,0x9831,0x9832,0x9833,
	0x9834,0x9835,0x9836,0x9837,0x9838,0x9839,0x983a,0x983b,0x983c,0x983d,0x983e,0x983f,0x9840,0x9841,0x9842,0x9843,
	0x9844,0x9845,0x9846,0x9847,0x9848,0x9849,0x984a,0x984b,0x984c,0x984d,0x984e,0x984f,0x9850,0x9851,0x9852,0x9853,
	0x9854,0x9855,0x9856,0x9857,0x9858,0x9859,0x985a,0x985b,0x985c,0x985d,0x985e,0x985f,0x9860,0x9861,0x9862,0x9863,
	0x9864,0x9865,0x9866,0x9867,0x9868,0x9869,0x986a,0x986b,0x986c,0x986d,0x986e,0x986e,0x986f,0x9870,0x9871,0x9872,
	0x9873,0x9874,0x9875,0x9876,0x9877,0x9878,0x9879,0x987a,0x987b,0x987c,0x987d,0x987e,0x987f,0x9880,0x9881,0x9882,
	0x9883,0x9884,0x9885,0x9886,0x9887,0x9888,0x9889,0x988a,0x988b,0x988c,0x988d,0x988e,0x988f,0x9890,0x9891,0x9892,
	0x9893,0x9894,0x9895,0x9896,0x9896,0x9897,0x9898,0x9899,0x989a,0x989b,0x989c,0x989d,0x989e,0x989f,0x98a0,0x98a1,
	0x98a2,0x98a3,0x98a4,0x98a5,0x98a6,0x98a7,0x98a8,0x98a9,0x98aa,0x98ab,0x98ac,0x98ad,0x98ae,0x98af,0x98b0,0x98b1,
	0x98b2,0x98b3,0x98b3,0x98b4,0x98b5,0x98b6,0x98b7,0x98b8,0x98b9,0x98ba,0x98bb,0x98bc,0x98bd,0x98be,0x98bf,0x98c0,
	0x98c1,0x98c2,0x98c3,0x98c4,0x98c5,0x98c6,0x98c7,0x98c8,0x98c9,0x98ca,0x98ca,0x98cb,0x98cc,0x98cd,0x98ce,0x98cf,
	0x98d0,0x98d1,0x98d2,0x98d3,0x98d4,0x98d5,0x98d6,0x98d7,0x98d8,0x98d9,0x98da,0x98db,0x98dc,0x98dd,0x98de,0x98df,
	0x98df,0x98e0,0x98e1,0x98e2,0x98e3,0x98e4,0x98e5,0x98e6,0x98e7,0x98e8,0x98e9,0x98ea,0x98eb,0x98ec,0x98ed,0x98ee,
	0x98ef,0x98f0,0x98f1,0x98f1,0x98f2,0x98f3,0x98f4,0x98f5,0x98f6,0x98f7,0x98f8,0x98f9,0x98fa,0x98fb,0x98fc,0x98fd,
	0x98fe,0x98ff,0x9900,0x9901,0x9902,0x9902,0x9903,0x9904,0x9905,0x9906,0x9907,0x9908,0x9909,0x990a,0x990b,0x990c,
	0x990d,0x990e,0x990f,0x9910,0x9911,0x9911,0x9912,0x9913,0x9914,0x9915,0x9916,0x9917,0x9918,0x9919,0x991a,0x991b,
	0x991c,0x991d,0x991e,0x991f,0x9920,0x9920,0x9921,0x9922,0x9923,0x9924,0x9925,0x9926,0x9927,0x9928,0x9929,0x992a,
	0x992b,0x992c,0x992d,0x992d,0x992e,0x992f,0x9930,0x9931,0x9932,0x9933,0x9934,0x9935,0x9936,0x9937,0x9938,0x9939,
	0x993a,0x993a,0x993b,0x993c,0x993d,0x993e,0x993f,0x9940,0x9941,0x9942,0x9943,0x9944,0x9945,0x9946,0x9947,0x9947,
	0x9948,0x9949,0x994a,0x994b,0x994c,0x994d,0x994e,0x994f,0x9950,0x9951,0x9952,0x9952,0x9953,0x9954,0x9955,0x9956,
	0x9957,0x9958,0x9959,0x995a,0x995b,0x995c,0x995d,0x995e,0x995e,0x995f,0x9960,0x9961,0x9962,0x9963,0x9964,0x9965,
	0x9966,0x9967,0x9968,0x9969,0x9969,0x996a,0x996b,0x996c,0x996d,0x996e,0x996f,0x9970,0x9971,0x9972,0x9973,0x9973,
	0x9974,0x9975,0x9976,0x9977,0x9978,0x9979,0x997a,0x997b,0x997c,0x997d,0x997d,0x997e,0x997f,0x9980,0x9981,0x9982,
	0x9983,0x9984,0x9985,0x9986,0x9987,0x9987,0x9988,0x9989,0x998a,0x998b,0x998c,0x998d,0x998e,0x998f,0x9990,0x9991,
	0x9991,0x9992,0x9993,0x9994,0x9995,0x9996,0x9997,0x9998,0x9999,0x999a,0x999a,0x999b,0x999c,0x999d,0x999e,0x999f,
	0x99a0,0x99a1,0x99a2,0x99a3,0x99a3,0x99a4,0x99a5,0x99a6,0x99a7,0x99a8,0x99a9,0x99aa,0x99ab,0x99ac,0x99ac,0x99ad,
	0x99ae,0x99af,0x99b0,0x99b1,0x99b2,0x99b3,0x99b4,0x99b5,0x99b5,0x99b6,0x99b7,0x99b8,0x99b9,0x99ba,0x99bb,0x99bc,
	0x99bd,0x99bd,0x99be,0x99bf,0x99c0,0x99c1,0x99c2,0x99c3,0x99c4,0x99c5,0x99c5,0x99c6,0x99c7,0x99c8,0x99c9,0x99ca,
	0x99cb,0x99cc,0x99cd,0x99ce,0x99ce,0x99cf,0x99d0,0x99d1,0x99d2,0x99d3,0x99d4,0x99d5,0x99d5,0x99d6,0x99d7,0x99d8,
	0x99d9,0x99da,0x99db,0x99dc,0x99dd,0x99dd,0x99de,0x99df,0x99e0,0x99e1,0x99e2,0x99e3,0x99e4,0x99e5,0x99e5,0x99e6,
	0x99e7,0x99e8,0x99e9,0x99ea,0x99eb,0x99ec,0x99ec,0x99ed,0x99ee,0x99ef,0x99f0,0x99f1,0x99f2,0x99f3,0x99f4,0x99f4,
	0x99f5,0x99f6,0x99f7,0x99f8,0x99f9,0x99fa,0x99fb,0x99fb,0x99fc,0x99fd,0x99fe,0x99ff,0x9a00,0x9a01,0x9a02,0x9a02,
	0x9a03,0x9a04,0x9a05,0x9a06,0x9a07,0x9a08,0x9a09,0x9a09,0x9a0a,0x9a0b,0x9a0c,0x9a0d,0x9a0e,0x9a0f,0x9a10,0x9a10,
	0x9a11,0x9a12,0x9a13,0x9a14,0x9a15,0x9a16,0x9a17,0x9a17,0x9a18,0x9a19,0x9a1a,0x9a1b,0x9a1c,0x9a1d,0x9a1d,0x9a1e,
	0x9a1f,0x9a20};


long long log_10(long long a)
{
	// 16bit out, 3bit int, 13 bit float
	long long out=0;
	long long in,idx,lsb;

	if(a==1)
		in=0;
	else
		in=a;
	if(in==65535)
		out=log_tbl[4096];
	else
	{
		idx=in>>4;
		lsb=in&0xf;
		out=(lsb*(long long)(log_tbl[idx+1])+ (16-lsb)*(long long)(log_tbl[idx]))>>4  ;// /15
		
	}
	/*else
	{
		for(i=0;i<4096;i++)
		{
			idx=i*16;
			idx_next=CLIP_hdr_vivid(0,65535,idx+16);
			if(in>=idx&&in<idx_next)
			{
				if(idx==65520)
				{
					out=((in-idx)*(long long)(log_tbl[i+1])+(idx_next-in)*(long long)(log_tbl[i]))/15;
					break;
				}
				else
				{
					out=((in-idx)*(long long)(log_tbl[i+1])+(idx_next-in)*(long long)(log_tbl[i]))>>4;
					break;
				}
			}
		}
	}*/

	
	return(out);
}
//pow10 table
		unsigned int pow10_tbl[256]={
		0x10000,0x10250,0x104a5,0x10700,0x10960,0x10bc6,0x10e31,0x110a2,0x11319,0x11595,0x11817,0x11a9f,0x11d2d,0x11fc0,0x1225a,0x124fa,
		0x1279f,0x12a4b,0x12cfd,0x12fb5,0x13274,0x13538,0x13804,0x13ad5,0x13dae,0x1408c,0x14372,0x1465e,0x14951,0x14c4b,0x14f4b,0x15253,
		0x15561,0x15877,0x15b94,0x15eb7,0x161e3,0x16515,0x1684f,0x16b90,0x16ed9,0x1722a,0x17582,0x178e2,0x17c4a,0x17fb9,0x18331,0x186b0,
		0x18a38,0x18dc8,0x19160,0x19500,0x198a9,0x19c5a,0x1a014,0x1a3d7,0x1a7a2,0x1ab75,0x1af52,0x1b338,0x1b726,0x1bb1e,0x1bf1f,0x1c329,
		0x1c73d,0x1cb5a,0x1cf80,0x1d3b0,0x1d7ea,0x1dc2e,0x1e07b,0x1e4d2,0x1e934,0x1ed9f,0x1f215,0x1f695,0x1fb1f,0x1ffb4,0x20454,0x208fe,
		0x20db3,0x21273,0x2173e,0x21c14,0x220f5,0x225e2,0x22ada,0x22fdd,0x234ec,0x23a07,0x23f2d,0x24460,0x2499e,0x24ee8,0x2543f,0x259a2,
		0x25f12,0x2648e,0x26a17,0x26fac,0x2754f,0x27aff,0x280bb,0x28685,0x28c5d,0x29242,0x29834,0x29e34,0x2a443,0x2aa5f,0x2b089,0x2b6c2,
		0x2bd09,0x2c35e,0x2c9c2,0x2d035,0x2d6b7,0x2dd48,0x2e3e8,0x2ea97,0x2f156,0x2f825,0x2ff03,0x305f1,0x30cef,0x313fd,0x31b1c,0x3224b,
		0x3298b,0x330db,0x3383c,0x33faf,0x34732,0x34ec7,0x3566e,0x35e26,0x365f0,0x36dcd,0x375bb,0x37dbc,0x385cf,0x38df5,0x3962d,0x39e79,
		0x3a6d8,0x3af4a,0x3b7d0,0x3c06a,0x3c917,0x3d1d9,0x3daae,0x3e398,0x3ec97,0x3f5ab,0x3fed3,0x40811,0x41164,0x41acd,0x4244b,0x42de0,
		0x4378b,0x4414b,0x44b23,0x45511,0x45f17,0x46933,0x47367,0x47db2,0x48815,0x49291,0x49d24,0x4a7d0,0x4b295,0x4bd72,0x4c869,0x4d379,
		0x4dea3,0x4e9e6,0x4f543,0x500bb,0x50c4e,0x517fb,0x523c3,0x52fa6,0x53ba5,0x547bf,0x553f6,0x56049,0x56cb8,0x57944,0x585ed,0x592b4,
		0x59f98,0x5ac99,0x5b9b9,0x5c6f7,0x5d454,0x5e1d0,0x5ef6b,0x5fd25,0x60aff,0x618f9,0x62714,0x6354f,0x643ab,0x65228,0x660c7,0x66f88,
		0x67e6a,0x68d6f,0x69c97,0x6abe2,0x6bb50,0x6cae2,0x6da98,0x6ea73,0x6fa72,0x70a96,0x71adf,0x72b4e,0x73be3,0x74c9e,0x75d81,0x76e8a,
		0x77fba,0x79112,0x7a293,0x7b43c,0x7c60d,0x7d808,0x7ea2d,0x7fc7b,0x80ef4,0x82198,0x83466,0x84761,0x85a87,0x86dd9,0x88158,0x89504,
		0x8a8de,0x8bce5,0x8d11b,0x8e580,0x8fa14,0x90ed7,0x923cb,0x938ee,0x94e43,0x963c9,0x97981,0x98f6b,0x9a588,0x9bbd8,0x9d25c,0x9e913
	};


long long pow_float_fix(long long x,long long y,long long shift_bit, int devide_flag)
{
	//y is 16 bit
	//pow10_tbl: 16bit float

	long long y_int,y_fra,out_int,out_fra,tmp_log,out,msb8,lsb5,pow10_int_bit,pow10_int;
	int i;
	out_int=1;
	pow10_int=1;
	if(x==0)
		return 0;
	if(y==0)
		return 1;
	y_int=y>>shift_bit;
	y_fra=y&((1<<shift_bit)-1);
	if(y_int==1&&y_fra==0)
		return x;
	else
	{
		
		tmp_log=(y_fra*log_10(x))>>shift_bit; // 3bit int, 13bit float
		pow10_int_bit=tmp_log>>13; // 3bit int
		msb8=(tmp_log&0x1fff)>>5; //8bit
		lsb5=tmp_log&0x1f;
		if(msb8==255)
			out_fra=pow10_tbl[255];
		/*for( i=0;i<255;i++)
		{
			if(msb8>=i&&msb8<(i+1))
				{
					out_fra=((lsb5*pow10_tbl[(i+1)]+(31-lsb5)*pow10_tbl[i]+16)*33)>>10; // "*33/32/32" to get close to "/31"
					break;
				}
		}*/
		else
		{
			out_fra=(lsb5*pow10_tbl[(msb8+1)]+(32-lsb5)*pow10_tbl[msb8]+16)>>5;
		}
		for( i=0;i<y_int;i++)
		{
			out_int=out_int*x;
			if(i>0)
				out_int=out_int>>16; // out_int: 16bit

		}
		for( i=0;i<pow10_int_bit;i++)
		{
			pow10_int=pow10_int*10;
		}
		if(out_int==1&&devide_flag==0)
		{
			out=(out_int*out_fra*pow10_int)<<16; //32bit float
			if(pow10_int_bit==4)
				out=out>>4;
		}
		else
		{
			out=out_int*out_fra*pow10_int;//16bit float
			if(pow10_int_bit==4)
				out=out>>4;
		}
		return out;
	}
}
#if CUVA_FW_TEST_ON_FPGA
char drvif_DM2_EOTF_Set_verify(unsigned int *EOTF_table32_R, unsigned int *EOTF_table32_G, unsigned int *EOTF_table32_B)
{
	UINT16 i;
	UINT32 timeoutcnt = 0x062500;
	UINT32 timeoutcnt_rw_addr =100;
	dm_hdr_eotf_lut_ctrl0_RBUS DM_HDR_EOTF_LUT_CTRL0_Reg;
	dm_hdr_eotf_lut_ctrl1_RBUS DM_HDR_EOTF_LUT_CTRL1_Reg;
	dm_hdr_eotf_lut_wr_data0_RBUS dm_hdr_eotf_lut_wr_data0_Reg;
	dm_hdr_eotf_lut_wr_data1_RBUS dm_hdr_eotf_lut_wr_data1_Reg;
	dm_hdr_eotf_lut_wr_data2_RBUS dm_hdr_eotf_lut_wr_data2_Reg;
	dm_hdr_eotf_lut_wr_data3_RBUS dm_hdr_eotf_lut_wr_data3_Reg;
	dm_hdr_eotf_lut_wr_data4_RBUS dm_hdr_eotf_lut_wr_data4_Reg;
	dm_hdr_eotf_lut_wr_data5_RBUS dm_hdr_eotf_lut_wr_data5_Reg;

	for(i=0;i<timeoutcnt_rw_addr;i++) //switch read/write , address will clean to 0 (some time not work)
	{
		DM_HDR_EOTF_LUT_CTRL0_Reg.regValue = IoReg_Fpga_Read32(DM_HDR_EOTF_LUT_CTRL0_reg);
		//write init
		DM_HDR_EOTF_LUT_CTRL0_Reg.regValue = IoReg_Fpga_Read32(DM_HDR_EOTF_LUT_CTRL0_reg);
		DM_HDR_EOTF_LUT_CTRL0_Reg.eotf_lut_enable = 1;
		DM_HDR_EOTF_LUT_CTRL0_Reg.eotf_lut_rw_sel = 1;
		IoReg_Fpga_Write32(DM_HDR_EOTF_LUT_CTRL0_reg, DM_HDR_EOTF_LUT_CTRL0_Reg.regValue);

		//Read init
		DM_HDR_EOTF_LUT_CTRL0_Reg.regValue = IoReg_Fpga_Read32(DM_HDR_EOTF_LUT_CTRL0_reg);
		DM_HDR_EOTF_LUT_CTRL0_Reg.eotf_lut_enable = 1;
		DM_HDR_EOTF_LUT_CTRL0_Reg.eotf_lut_rw_sel = 2;
		IoReg_Fpga_Write32(DM_HDR_EOTF_LUT_CTRL0_reg, DM_HDR_EOTF_LUT_CTRL0_Reg.regValue);

		DM_HDR_EOTF_LUT_CTRL1_Reg.regValue = IoReg_Fpga_Read32(DM_HDR_EOTF_LUT_CTRL1_reg);

		if(DM_HDR_EOTF_LUT_CTRL1_Reg.eotf_lut_rw_addr!=0)
			;//rtd_pr_vpq_debug("PQ WARNING, Set HDR EOTF table wrong, rw_address not 0 ,times=%d",i);
		else
			break;

	}// read/write OE/EO table havt to check rw_address is 0

	if (i >= (timeoutcnt_rw_addr-1)) {
		rtd_pr_vpq_emerg("PQ WARNING, Set HDR EOTF table wrong, rw_address not 0 ,times=%d",i);
		return -1;
	}

	//write init
	DM_HDR_EOTF_LUT_CTRL0_Reg.regValue = IoReg_Fpga_Read32(DM_HDR_EOTF_LUT_CTRL0_reg);
	DM_HDR_EOTF_LUT_CTRL0_Reg.eotf_lut_enable = 1;
	DM_HDR_EOTF_LUT_CTRL0_Reg.eotf_lut_rw_sel = 1;
	IoReg_Fpga_Write32(DM_HDR_EOTF_LUT_CTRL0_reg, DM_HDR_EOTF_LUT_CTRL0_Reg.regValue);

	//data check
	for (i = 1; i < EOTF_size; i++)
	{
		if (EOTF_table32_R[i] < EOTF_table32_R[i - 1])
			{rtd_pr_vpq_debug("PQ WARNING, HDR EOTF table wrong, EOTF_table32_R[%d] = %d > EOTF_table32_R[%d] = %d\n", i - 1, EOTF_table32_R[i - 1], i, EOTF_table32_R[i]);}
		if (EOTF_table32_G[i] < EOTF_table32_G[i - 1])
			{rtd_pr_vpq_debug("PQ WARNING, HDR EOTF table wrong, EOTF_table32_G[%d] = %d > EOTF_table32_G[%d] = %d\n", i - 1, EOTF_table32_G[i - 1], i, EOTF_table32_G[i]);}
		if (EOTF_table32_B[i] < EOTF_table32_B[i - 1])
			{rtd_pr_vpq_debug("PQ WARNING, HDR EOTF table wrong, EOTF_table32_B[%d] = %d > EOTF_table32_B[%d] = %d\n", i - 1, EOTF_table32_B[i - 1], i, EOTF_table32_B[i]);}
	}


	//push data to SRAM
	i = 0;
	while(i < EOTF_size)
	{
		//data
		dm_hdr_eotf_lut_wr_data0_Reg.eotf_wr_lut_data0 = EOTF_table32_R[i];
		dm_hdr_eotf_lut_wr_data2_Reg.eotf_wr_lut_data2 = EOTF_table32_G[i];
		dm_hdr_eotf_lut_wr_data4_Reg.eotf_wr_lut_data4 = EOTF_table32_B[i];

		if (i + 1 < EOTF_size)		//data protect
		{
			dm_hdr_eotf_lut_wr_data1_Reg.eotf_wr_lut_data1 = EOTF_table32_R[i + 1];
			dm_hdr_eotf_lut_wr_data3_Reg.eotf_wr_lut_data3 = EOTF_table32_G[i + 1];
			dm_hdr_eotf_lut_wr_data5_Reg.eotf_wr_lut_data5 = EOTF_table32_B[i + 1];
		}

		IoReg_Fpga_Write32(DM_HDR_EOTF_LUT_WR_DATA0_reg, dm_hdr_eotf_lut_wr_data0_Reg.regValue);
		IoReg_Fpga_Write32(DM_HDR_EOTF_LUT_WR_DATA1_reg, dm_hdr_eotf_lut_wr_data1_Reg.regValue);
		IoReg_Fpga_Write32(DM_HDR_EOTF_LUT_WR_DATA2_reg, dm_hdr_eotf_lut_wr_data2_Reg.regValue);
		IoReg_Fpga_Write32(DM_HDR_EOTF_LUT_WR_DATA3_reg, dm_hdr_eotf_lut_wr_data3_Reg.regValue);
		IoReg_Fpga_Write32(DM_HDR_EOTF_LUT_WR_DATA4_reg, dm_hdr_eotf_lut_wr_data4_Reg.regValue);
		IoReg_Fpga_Write32(DM_HDR_EOTF_LUT_WR_DATA5_reg, dm_hdr_eotf_lut_wr_data5_Reg.regValue);

		//write
		DM_HDR_EOTF_LUT_CTRL1_Reg.regValue = IoReg_Fpga_Read32(DM_HDR_EOTF_LUT_CTRL1_reg);
		DM_HDR_EOTF_LUT_CTRL1_Reg.eotf_lut_read_en = 0;
		DM_HDR_EOTF_LUT_CTRL1_Reg.eotf_lut_write_en = 1;
		IoReg_Fpga_Write32(DM_HDR_EOTF_LUT_CTRL1_reg, DM_HDR_EOTF_LUT_CTRL1_Reg.regValue);
		do
		{
			timeoutcnt--;
			DM_HDR_EOTF_LUT_CTRL1_Reg.regValue = IoReg_Fpga_Read32(DM_HDR_EOTF_LUT_CTRL1_reg);
		}
		while(DM_HDR_EOTF_LUT_CTRL1_Reg.eotf_lut_write_en && timeoutcnt > 10);

		if (timeoutcnt <= 10) {
			rtd_pr_vpq_emerg("PQ WARNING, EOTF Sram Timeout ,index=%d",i);
			return -1;
		}

		i = i + 2;
	}


	//write end
	DM_HDR_EOTF_LUT_CTRL0_Reg.regValue = IoReg_Fpga_Read32(DM_HDR_EOTF_LUT_CTRL0_reg);
	DM_HDR_EOTF_LUT_CTRL0_Reg.eotf_lut_enable = 1;
	DM_HDR_EOTF_LUT_CTRL0_Reg.eotf_lut_rw_sel = 0;
	IoReg_Fpga_Write32(DM_HDR_EOTF_LUT_CTRL0_reg, DM_HDR_EOTF_LUT_CTRL0_Reg.regValue);

	return 0;

}

char drvif_DM2_OETF_Set_verify(unsigned int *OETF_table16_R, unsigned int *OETF_table16_G, unsigned int *OETF_table16_B)
{
	UINT16 i;
	UINT32 timeoutcnt = 0x062500;
	UINT8 timeoutcnt_rw_addr =100;

	dm_hdr_oetf_lut_ctrl0_RBUS DM_HDR_OETF_LUT_CTRL0_Reg;
	dm_hdr_oetf_lut_ctrl1_RBUS DM_HDR_OETF_LUT_CTRL1_Reg;
	dm_hdr_oetf_lut_wr_data0_RBUS dm_hdr_oetf_lut_wr_data0_Reg;
	dm_hdr_oetf_lut_wr_data1_RBUS dm_hdr_oetf_lut_wr_data1_Reg;
	dm_hdr_oetf_lut_wr_data2_RBUS dm_hdr_oetf_lut_wr_data2_Reg;

	for(i=0;i<timeoutcnt_rw_addr;i++)//switch read/write , address will clean to 0 (some time not work)
	{
		//write init
		DM_HDR_OETF_LUT_CTRL0_Reg.regValue = IoReg_Fpga_Read32(DM_HDR_OETF_LUT_CTRL0_reg);
		DM_HDR_OETF_LUT_CTRL0_Reg.oetf_lut_enable = 1;
		DM_HDR_OETF_LUT_CTRL0_Reg.oetf_lut_rw_sel = 1;
		IoReg_Fpga_Write32(DM_HDR_OETF_LUT_CTRL0_reg, DM_HDR_OETF_LUT_CTRL0_Reg.regValue);
		//read init
		DM_HDR_OETF_LUT_CTRL0_Reg.regValue = IoReg_Fpga_Read32(DM_HDR_OETF_LUT_CTRL0_reg);
		DM_HDR_OETF_LUT_CTRL0_Reg.oetf_lut_enable = 1;
		DM_HDR_OETF_LUT_CTRL0_Reg.oetf_lut_rw_sel = 2;


		IoReg_Fpga_Write32(DM_HDR_OETF_LUT_CTRL0_reg, DM_HDR_OETF_LUT_CTRL0_Reg.regValue);

		DM_HDR_OETF_LUT_CTRL1_Reg.regValue = IoReg_Fpga_Read32(DM_HDR_OETF_LUT_CTRL1_reg);
		if(DM_HDR_OETF_LUT_CTRL1_Reg.oetf_lut_rw_addr!=0)
			;//rtd_pr_vpq_emerg("PQ WARNING, Set HDR OETF table wrong, rw_address not 0 ,times=%d",i);
		else
			break;
	} // read/write OE/EO table havt to check rw_address is 0

	if (i >= (timeoutcnt_rw_addr-1)) {
		rtd_pr_vpq_emerg("PQ WARNING, Set HDR OETF table wrong, rw_address not 0 ,times=%d",i);
		return -1;
	}

	//write init
	DM_HDR_OETF_LUT_CTRL0_Reg.regValue = IoReg_Fpga_Read32(DM_HDR_OETF_LUT_CTRL0_reg);
	DM_HDR_OETF_LUT_CTRL0_Reg.oetf_lut_enable = 1;
	DM_HDR_OETF_LUT_CTRL0_Reg.oetf_lut_rw_sel = 1;
	IoReg_Fpga_Write32(DM_HDR_OETF_LUT_CTRL0_reg, DM_HDR_OETF_LUT_CTRL0_Reg.regValue);

	//data check
	for (i = 1; i < OETF_size; i++)
	{
		if (OETF_table16_R[i] < OETF_table16_R[i - 1])
			{rtd_pr_vpq_debug("PQ WARNING, HDR OETF table wrong, OETF_table16_R[%d] = %d > OETF_table16_R[%d] = %d\n", i - 1, OETF_table16_R[i - 1], i, OETF_table16_R[i]);}
		if (OETF_table16_G[i] < OETF_table16_G[i - 1])
			{rtd_pr_vpq_debug("PQ WARNING, HDR OETF table wrong, OETF_table16_G[%d] = %d > OETF_table16_G[%d] = %d\n", i - 1, OETF_table16_G[i - 1], i, OETF_table16_G[i]);}
		if (OETF_table16_B[i] < OETF_table16_B[i - 1])
			{rtd_pr_vpq_debug("PQ WARNING, HDR OETF table wrong, OETF_table16_B[%d] = %d > OETF_table16_B[%d] = %d\n", i - 1, OETF_table16_B[i - 1], i, OETF_table16_B[i]);}
	}

	//push data to SRAM
	i = 0;
	while(i < OETF_size)
	{
		//data
		dm_hdr_oetf_lut_wr_data0_Reg.oetf_wr_lut_data0 = OETF_table16_R[i];
		dm_hdr_oetf_lut_wr_data1_Reg.oetf_wr_lut_data2 = OETF_table16_G[i];
		dm_hdr_oetf_lut_wr_data2_Reg.oetf_wr_lut_data4 = OETF_table16_B[i];

		if (i + 1 < OETF_size)
		{
			dm_hdr_oetf_lut_wr_data0_Reg.oetf_wr_lut_data1 = OETF_table16_R[i + 1];
			dm_hdr_oetf_lut_wr_data1_Reg.oetf_wr_lut_data3 = OETF_table16_G[i + 1];
			dm_hdr_oetf_lut_wr_data2_Reg.oetf_wr_lut_data5 = OETF_table16_B[i + 1];
		}

		IoReg_Fpga_Write32(DM_HDR_OETF_LUT_WR_DATA0_reg, dm_hdr_oetf_lut_wr_data0_Reg.regValue);
		IoReg_Fpga_Write32(DM_HDR_OETF_LUT_WR_DATA1_reg, dm_hdr_oetf_lut_wr_data1_Reg.regValue);
		IoReg_Fpga_Write32(DM_HDR_OETF_LUT_WR_DATA2_reg, dm_hdr_oetf_lut_wr_data2_Reg.regValue);

		//write
		DM_HDR_OETF_LUT_CTRL1_Reg.regValue = IoReg_Fpga_Read32(DM_HDR_OETF_LUT_CTRL1_reg);
		DM_HDR_OETF_LUT_CTRL1_Reg.oetf_lut_read_en = 0;
		DM_HDR_OETF_LUT_CTRL1_Reg.oetf_lut_write_en = 1;
		IoReg_Fpga_Write32(DM_HDR_OETF_LUT_CTRL1_reg, DM_HDR_OETF_LUT_CTRL1_Reg.regValue);
		do
		{
			timeoutcnt--;
			DM_HDR_OETF_LUT_CTRL1_Reg.regValue = IoReg_Fpga_Read32(DM_HDR_OETF_LUT_CTRL1_reg);
		}
		while(DM_HDR_OETF_LUT_CTRL1_Reg.oetf_lut_write_en && timeoutcnt > 10);

		if (timeoutcnt <= 10) {
			rtd_pr_vpq_emerg("PQ WARNING, OETF Sram Timeout ,index=%d",i);
			return -1;
		}

		i = i + 2;
	}


	//write end
	DM_HDR_OETF_LUT_CTRL0_Reg.regValue = IoReg_Fpga_Read32(DM_HDR_OETF_LUT_CTRL0_reg);
	DM_HDR_OETF_LUT_CTRL0_Reg.oetf_lut_enable = 1;
	DM_HDR_OETF_LUT_CTRL0_Reg.oetf_lut_rw_sel = 0;
	IoReg_Fpga_Write32(DM_HDR_OETF_LUT_CTRL0_reg, DM_HDR_OETF_LUT_CTRL0_Reg.regValue);

	return 0;

}

void drvif_DM2_CUVA_Set_verify(unsigned char shift_bit)
{
	dm_hdr_cuva_ctrl0_RBUS dm_hdr_cuva_ctrl0_reg;
	dm_hdr_eotf_lut_ctrl0_RBUS dm_hdr_eotf_lut_ctrl0_reg;
	dm_dm_submodule_enable_RBUS dm_dm_submodule_enable_reg;
	dm_hdr_oetf_lut_ctrl0_RBUS dm_hdr_oetf_lut_ctrl0_reg;
	dm_input_format_RBUS dm_input_format_reg;
	//dm_hdr_path_sel_RBUS dm_hdr_path_sel_reg;
	dm_hdr_gamma_ctrl0_RBUS dm_hdr_gamma_ctrl0_reg;
	dm_saturationadj_RBUS dm_saturationadj_reg;
	dm_dm_b02_lut_maxval_RBUS dm_dm_b02_lut_maxval_reg;
	dm_dither_set_RBUS dm_dither_set_reg;
	dm_eotf_para1_RBUS dm_eotf_para1_reg;
	dm_opttoopt_scale_RBUS dm_opttoopt_scale_reg;
	dm_opttoopt_offset_RBUS dm_opttoopt_offset_reg;
	dm_opttoopt_clip_RBUS dm_opttoopt_clip_reg;
	dm_opttoopt_coef0_RBUS dm_opttoopt_coef0_reg;
	dm_opttoopt_coef1_RBUS dm_opttoopt_coef1_reg;
	dm_opttoopt_coef2_RBUS dm_opttoopt_coef2_reg;
	dm_opttoopt_coef3_RBUS dm_opttoopt_coef3_reg;
	dm_opttoopt_coef4_RBUS dm_opttoopt_coef4_reg;
	dm_opttoopt_coef5_RBUS dm_opttoopt_coef5_reg;
	/* YUV2RGB setting */
	dm_ycctorgb_coef0_RBUS dm_ycctorgb_coef0_reg;
	dm_ycctorgb_coef1_RBUS dm_ycctorgb_coef1_reg;
	dm_ycctorgb_coef2_RBUS dm_ycctorgb_coef2_reg;
	dm_ycctorgb_coef3_RBUS dm_ycctorgb_coef3_reg;
	dm_ycctorgb_coef4_RBUS dm_ycctorgb_coef4_reg;
	dm_ycctorgb_coef5_RBUS dm_ycctorgb_coef5_reg;
	dm_ycctorgb_offset0_RBUS dm_ycctorgb_offset0_reg;
	dm_ycctorgb_offset1_RBUS dm_ycctorgb_offset1_reg;
	dm_ycctorgb_offset2_RBUS dm_ycctorgb_offset2_reg;
	dm_ycctorgb_scale_RBUS dm_ycctorgb_scale_reg;
	dm_signal_range_RBUS dm_signal_range_reg;
	
	dm_hdr_double_buffer_ctrl_RBUS dm_hdr_double_buffer_ctrl_reg;

	

	dm_input_format_reg.regValue = IoReg_Fpga_Read32(DM_Input_Format_reg);
	dm_input_format_reg.dm_in_sel=2;
	dm_input_format_reg.dm_inbits_sel=1;
	IoReg_Fpga_Write32(DM_Input_Format_reg, dm_input_format_reg.regValue);

	/*dm_hdr_path_sel_reg.regValue = IoReg_Fpga_Read32(DM_HDR_PATH_SEL_reg);
	dm_hdr_path_sel_reg.b0103_or_eotf=0;
	dm_hdr_path_sel_reg.b0105_or_oetf=0;
	dm_hdr_path_sel_reg.bbc_hdr_enable=0;
	dm_hdr_path_sel_reg.b05_position=2;
	dm_hdr_path_sel_reg.b03_no_sram_mode=1;
	dm_hdr_path_sel_reg.dm_b05_22bit_path=1;
	IoReg_Fpga_Write32(DM_HDR_PATH_SEL_reg, dm_hdr_path_sel_reg.regValue);*/

	dm_hdr_gamma_ctrl0_reg.regValue = IoReg_Fpga_Read32(DM_HDR_GAMMA_CTRL0_reg);
	dm_hdr_gamma_ctrl0_reg.gamma_out_shift_en=0;
	IoReg_Fpga_Write32(DM_HDR_GAMMA_CTRL0_reg, dm_hdr_gamma_ctrl0_reg.regValue);

	dm_saturationadj_reg.regValue = IoReg_Fpga_Read32(DM_SaturationAdj_reg);
	dm_saturationadj_reg.bypass_unsigned_en=1;
	IoReg_Fpga_Write32(DM_SaturationAdj_reg, dm_saturationadj_reg.regValue);

	dm_dm_b02_lut_maxval_reg.regValue = IoReg_Fpga_Read32(DM_DM_B02_LUT_MaxVal_reg);
	dm_dm_b02_lut_maxval_reg.b02_bypass_mode=0;
	IoReg_Fpga_Write32(DM_DM_B02_LUT_MaxVal_reg, dm_dm_b02_lut_maxval_reg.regValue);

	dm_dither_set_reg.regValue = IoReg_Fpga_Read32(DM_DITHER_SET_reg);
	dm_dither_set_reg.dither_in_format=1;
	IoReg_Fpga_Write32(DM_DITHER_SET_reg, dm_dither_set_reg.regValue);

	
	
	dm_opttoopt_scale_reg.regValue = IoReg_Fpga_Read32(DM_OPTtoOPT_Scale_reg);
	dm_opttoopt_scale_reg.opt2optscale=14;
	IoReg_Fpga_Write32(DM_OPTtoOPT_Scale_reg, dm_opttoopt_scale_reg.regValue);

	dm_opttoopt_offset_reg.regValue = IoReg_Fpga_Read32(DM_OPTtoOPT_Offset_reg);
	dm_opttoopt_offset_reg.opt2optoffset=0;
	IoReg_Fpga_Write32(DM_OPTtoOPT_Offset_reg, dm_opttoopt_offset_reg.regValue);

	dm_opttoopt_clip_reg.regValue = IoReg_Fpga_Read32(DM_OPTtoOPT_CLIP_reg);
	dm_opttoopt_clip_reg.opt2optminvalue=32769;//-32767
	dm_opttoopt_clip_reg.opt2optmaxvalue=65535;
	IoReg_Fpga_Write32(DM_OPTtoOPT_CLIP_reg, dm_opttoopt_clip_reg.regValue);

	dm_opttoopt_coef0_reg.regValue = IoReg_Fpga_Read32(DM_OPTtoOPT_coef0_reg);
	dm_opttoopt_coef0_reg.m33opt2opt00=8608;
	dm_opttoopt_coef0_reg.m33opt2opt01=22217;
	IoReg_Fpga_Write32(DM_OPTtoOPT_coef0_reg, dm_opttoopt_coef0_reg.regValue);

	dm_opttoopt_coef1_reg.regValue = IoReg_Fpga_Read32(DM_OPTtoOPT_coef1_reg);
	dm_opttoopt_coef1_reg.m33opt2opt02=1943;
	IoReg_Fpga_Write32(DM_OPTtoOPT_coef1_reg, dm_opttoopt_coef1_reg.regValue);

	dm_opttoopt_coef2_reg.regValue = IoReg_Fpga_Read32(DM_OPTtoOPT_coef2_reg);
	dm_opttoopt_coef2_reg.m33opt2opt10=60962;//-4574;
	dm_opttoopt_coef2_reg.m33opt2opt11=53727;//-11809;
	IoReg_Fpga_Write32(DM_OPTtoOPT_coef2_reg, dm_opttoopt_coef2_reg.regValue);

	dm_opttoopt_coef3_reg.regValue = IoReg_Fpga_Read32(DM_OPTtoOPT_coef3_reg);
	dm_opttoopt_coef3_reg.m33opt2opt12=16384;
	IoReg_Fpga_Write32(DM_OPTtoOPT_coef3_reg, dm_opttoopt_coef3_reg.regValue);

	dm_opttoopt_coef4_reg.regValue = IoReg_Fpga_Read32(DM_OPTtoOPT_coef4_reg);
	dm_opttoopt_coef4_reg.m33opt2opt20=16384;
	dm_opttoopt_coef4_reg.m33opt2opt21=50469;//-15067;
	IoReg_Fpga_Write32(DM_OPTtoOPT_coef4_reg, dm_opttoopt_coef4_reg.regValue);

	dm_opttoopt_coef5_reg.regValue = IoReg_Fpga_Read32(DM_OPTtoOPT_coef5_reg);
	dm_opttoopt_coef5_reg.m33opt2opt22=64219;//-1317;
	IoReg_Fpga_Write32(DM_OPTtoOPT_coef5_reg, dm_opttoopt_coef5_reg.regValue);

	dm_hdr_eotf_lut_ctrl0_reg.regValue = IoReg_Fpga_Read32(DM_HDR_EOTF_LUT_CTRL0_reg);
	dm_hdr_eotf_lut_ctrl0_reg.eotf_lut_enable=1;
	IoReg_Fpga_Write32(DM_HDR_EOTF_LUT_CTRL0_reg, dm_hdr_eotf_lut_ctrl0_reg.regValue);

	dm_eotf_para1_reg.regValue = IoReg_Fpga_Read32(DM_EOTF_para1_reg);
	dm_eotf_para1_reg.seotf=1;
	IoReg_Fpga_Write32(DM_EOTF_para1_reg, dm_eotf_para1_reg.regValue);

	dm_dm_submodule_enable_reg.regValue = IoReg_Fpga_Read32(DM_dm_submodule_enable_reg);
	dm_dm_submodule_enable_reg.b01_01_422to444_enable=1;
	dm_dm_submodule_enable_reg.b01_02_enable=0;
	dm_dm_submodule_enable_reg.b01_03_enable=1;
	dm_dm_submodule_enable_reg.b01_04_enable=0;
	dm_dm_submodule_enable_reg.b01_05_enable=1;
	dm_dm_submodule_enable_reg.b01_06_enable=1;
	dm_dm_submodule_enable_reg.b01_07_enable=0;
	dm_dm_submodule_enable_reg.b02_enable=0;
	dm_dm_submodule_enable_reg.b03_enable=0;
	dm_dm_submodule_enable_reg.b04_enable=0;
	dm_dm_submodule_enable_reg.b0501_enable=0;
	dm_dm_submodule_enable_reg.b0502_enable=0;
	dm_dm_submodule_enable_reg.dither_en=0;
	dm_dm_submodule_enable_reg.gamma_enable=0;
	IoReg_Fpga_Write32(DM_dm_submodule_enable_reg, dm_dm_submodule_enable_reg.regValue);

	dm_hdr_oetf_lut_ctrl0_reg.regValue = IoReg_Fpga_Read32(DM_HDR_OETF_LUT_CTRL0_reg);
	dm_hdr_oetf_lut_ctrl0_reg.oetf_lut_enable=0;
	IoReg_Fpga_Write32(DM_HDR_OETF_LUT_CTRL0_reg, dm_hdr_oetf_lut_ctrl0_reg.regValue);

	/* YUV2RGB setting */
	dm_ycctorgb_coef0_reg.regValue = IoReg_Fpga_Read32(DM_YCCtoRGB_coef0_reg);
	dm_ycctorgb_coef0_reg.regValue = 0x255f;
	IoReg_Fpga_Write32(DM_YCCtoRGB_coef0_reg, dm_ycctorgb_coef0_reg.regValue);

	dm_ycctorgb_coef1_reg.regValue = IoReg_Fpga_Read32(DM_YCCtoRGB_coef1_reg);
	dm_ycctorgb_coef1_reg.regValue = 0x35e0;
	IoReg_Fpga_Write32(DM_YCCtoRGB_coef1_reg, dm_ycctorgb_coef1_reg.regValue);

	dm_ycctorgb_coef2_reg.regValue = IoReg_Fpga_Read32(DM_YCCtoRGB_coef2_reg);
	dm_ycctorgb_coef2_reg.regValue = 0xf9ff255f;
	IoReg_Fpga_Write32(DM_YCCtoRGB_coef2_reg, dm_ycctorgb_coef2_reg.regValue);

	dm_ycctorgb_coef3_reg.regValue = IoReg_Fpga_Read32(DM_YCCtoRGB_coef3_reg);
	dm_ycctorgb_coef3_reg.regValue = 0xeb22;
	IoReg_Fpga_Write32(DM_YCCtoRGB_coef3_reg, dm_ycctorgb_coef3_reg.regValue);

	dm_ycctorgb_coef4_reg.regValue = IoReg_Fpga_Read32(DM_YCCtoRGB_coef4_reg);
	dm_ycctorgb_coef4_reg.regValue = 0x44bd255f;
	IoReg_Fpga_Write32(DM_YCCtoRGB_coef4_reg, dm_ycctorgb_coef4_reg.regValue);

	dm_ycctorgb_coef5_reg.regValue = IoReg_Fpga_Read32(DM_YCCtoRGB_coef5_reg);
	dm_ycctorgb_coef5_reg.regValue = 0x0;
	IoReg_Fpga_Write32(DM_YCCtoRGB_coef5_reg, dm_ycctorgb_coef5_reg.regValue);

	dm_ycctorgb_offset0_reg.regValue = IoReg_Fpga_Read32(DM_YCCtoRGB_offset0_reg);
	dm_ycctorgb_offset0_reg.regValue = 0x7517c0;
	IoReg_Fpga_Write32(DM_YCCtoRGB_offset0_reg, dm_ycctorgb_offset0_reg.regValue);

	dm_ycctorgb_offset1_reg.regValue = IoReg_Fpga_Read32(DM_YCCtoRGB_offset1_reg);
	dm_ycctorgb_offset1_reg.regValue = 0xffd399c0;
	IoReg_Fpga_Write32(DM_YCCtoRGB_offset1_reg, dm_ycctorgb_offset1_reg.regValue);

	dm_ycctorgb_offset2_reg.regValue = IoReg_Fpga_Read32(DM_YCCtoRGB_offset2_reg);
	dm_ycctorgb_offset2_reg.regValue = 0x92d1c0;
	IoReg_Fpga_Write32(DM_YCCtoRGB_offset2_reg, dm_ycctorgb_offset2_reg.regValue);

	dm_ycctorgb_scale_reg.regValue = IoReg_Fpga_Read32(DM_YCCtoRGB_Scale_reg);
	dm_ycctorgb_scale_reg.regValue = 0xd;
	IoReg_Fpga_Write32(DM_YCCtoRGB_Scale_reg, dm_ycctorgb_scale_reg.regValue);

	dm_signal_range_reg.regValue = IoReg_Fpga_Read32(DM_Signal_range_reg);
	dm_signal_range_reg.regValue = 0x3fff0000;
	IoReg_Fpga_Write32(DM_Signal_range_reg, dm_signal_range_reg.regValue);
	/* YUV2RGB setting */

	dm_hdr_cuva_ctrl0_reg.regValue = IoReg_Fpga_Read32(DM_HDR_CUVA_CTRL0_reg);
	dm_hdr_cuva_ctrl0_reg.hdr_cuva_en=1;
	dm_hdr_cuva_ctrl0_reg.hdr_cuva_k_en=1;
	dm_hdr_cuva_ctrl0_reg.hdr_cuva_color_en=1;
	dm_hdr_cuva_ctrl0_reg.hdr_cuva_y2r_en=1;
	dm_hdr_cuva_ctrl0_reg.hdr_cuva_k_shift_sel=shift_bit;
	IoReg_Fpga_Write32(DM_HDR_CUVA_CTRL0_reg, dm_hdr_cuva_ctrl0_reg.regValue);

	dm_hdr_double_buffer_ctrl_reg.regValue = IoReg_Fpga_Read32(DM_HDR_Double_Buffer_CTRL_reg);
	dm_hdr_double_buffer_ctrl_reg.dm_db_apply = 1;
	IoReg_Fpga_Write32(DM_HDR_Double_Buffer_CTRL_reg, dm_hdr_double_buffer_ctrl_reg.regValue);
}
#endif

void drvif_DM2_hdr_cuva_k_shift_sel_Set(unsigned char shift_bit)
{
	dm_hdr_cuva_ctrl0_RBUS dm_hdr_cuva_ctrl0_reg;
	dm_hdr_double_buffer_ctrl_RBUS dm_hdr_double_buffer_ctrl_reg;

	dm_hdr_double_buffer_ctrl_reg.regValue = IoReg_Read32(DM_HDR_Double_Buffer_CTRL_reg);
	dm_hdr_double_buffer_ctrl_reg.dm_db_en = 1;
	IoReg_Write32(DM_HDR_Double_Buffer_CTRL_reg, dm_hdr_double_buffer_ctrl_reg.regValue);
	
	dm_hdr_cuva_ctrl0_reg.regValue = IoReg_Read32(DM_HDR_CUVA_CTRL0_reg);
	dm_hdr_cuva_ctrl0_reg.hdr_cuva_k_shift_sel=shift_bit;
	IoReg_Write32(DM_HDR_CUVA_CTRL0_reg, dm_hdr_cuva_ctrl0_reg.regValue);

	dm_hdr_double_buffer_ctrl_reg.regValue = IoReg_Read32(DM_HDR_Double_Buffer_CTRL_reg);
	dm_hdr_double_buffer_ctrl_reg.dm_db_apply = 1;
	IoReg_Write32(DM_HDR_Double_Buffer_CTRL_reg, dm_hdr_double_buffer_ctrl_reg.regValue);

}

void drvif_DM2_hdr_cuva_En_Set(unsigned char En)
{
	dm_hdr_cuva_ctrl0_RBUS dm_hdr_cuva_ctrl0_reg;
	dm_hdr_double_buffer_ctrl_RBUS dm_hdr_double_buffer_ctrl_reg;

	dm_hdr_double_buffer_ctrl_reg.regValue = IoReg_Read32(DM_HDR_Double_Buffer_CTRL_reg);
	dm_hdr_double_buffer_ctrl_reg.dm_db_en = 1;
	IoReg_Write32(DM_HDR_Double_Buffer_CTRL_reg, dm_hdr_double_buffer_ctrl_reg.regValue);
	
	dm_hdr_cuva_ctrl0_reg.regValue = IoReg_Read32(DM_HDR_CUVA_CTRL0_reg);
	if (En == 1) {
		dm_hdr_cuva_ctrl0_reg.hdr_cuva_en=1;
		dm_hdr_cuva_ctrl0_reg.hdr_cuva_k_en=1;
		dm_hdr_cuva_ctrl0_reg.hdr_cuva_color_en=1;
		dm_hdr_cuva_ctrl0_reg.hdr_cuva_y2r_en=1;
	} else {
		dm_hdr_cuva_ctrl0_reg.hdr_cuva_en=0;
		dm_hdr_cuva_ctrl0_reg.hdr_cuva_k_en=0;
		dm_hdr_cuva_ctrl0_reg.hdr_cuva_color_en=0;
		dm_hdr_cuva_ctrl0_reg.hdr_cuva_y2r_en=0;
	}
	IoReg_Write32(DM_HDR_CUVA_CTRL0_reg, dm_hdr_cuva_ctrl0_reg.regValue);

	dm_hdr_double_buffer_ctrl_reg.regValue = IoReg_Read32(DM_HDR_Double_Buffer_CTRL_reg);
	dm_hdr_double_buffer_ctrl_reg.dm_db_apply = 1;
	IoReg_Write32(DM_HDR_Double_Buffer_CTRL_reg, dm_hdr_double_buffer_ctrl_reg.regValue);

}

void drvif_HDR_VIVID_B0106_set(unsigned char enable)
{
	dm_opttoopt_scale_RBUS dm_opttoopt_scale_reg;
	dm_opttoopt_offset_RBUS dm_opttoopt_offset_reg;
	dm_opttoopt_clip_RBUS dm_opttoopt_clip_reg;
	dm_opttoopt_coef0_RBUS dm_opttoopt_coef0_reg;
	dm_opttoopt_coef1_RBUS dm_opttoopt_coef1_reg;
	dm_opttoopt_coef2_RBUS dm_opttoopt_coef2_reg;
	dm_opttoopt_coef3_RBUS dm_opttoopt_coef3_reg;
	dm_opttoopt_coef4_RBUS dm_opttoopt_coef4_reg;
	dm_opttoopt_coef5_RBUS dm_opttoopt_coef5_reg;
	dm_hdr_double_buffer_ctrl_RBUS dm_hdr_double_buffer_ctrl_reg;
	dm_dm_submodule_enable_RBUS dm_submodule_enable_REG;
	
	dm_hdr_double_buffer_ctrl_reg.regValue = IoReg_Read32(DM_HDR_Double_Buffer_CTRL_reg);
	dm_hdr_double_buffer_ctrl_reg.dm_db_en = 1;
	IoReg_Write32(DM_HDR_Double_Buffer_CTRL_reg, dm_hdr_double_buffer_ctrl_reg.regValue);

	if (enable == 1) {
		dm_opttoopt_scale_reg.regValue = IoReg_Read32(DM_OPTtoOPT_Scale_reg);
		dm_opttoopt_scale_reg.opt2optscale=14;
		IoReg_Write32(DM_OPTtoOPT_Scale_reg, dm_opttoopt_scale_reg.regValue);

		dm_opttoopt_offset_reg.regValue = IoReg_Read32(DM_OPTtoOPT_Offset_reg);
		dm_opttoopt_offset_reg.opt2optoffset=0;
		IoReg_Write32(DM_OPTtoOPT_Offset_reg, dm_opttoopt_offset_reg.regValue);

		dm_opttoopt_clip_reg.regValue = IoReg_Read32(DM_OPTtoOPT_CLIP_reg);
		dm_opttoopt_clip_reg.opt2optminvalue=32769;//-32767
		dm_opttoopt_clip_reg.opt2optmaxvalue=65535;
		IoReg_Write32(DM_OPTtoOPT_CLIP_reg, dm_opttoopt_clip_reg.regValue);

		dm_opttoopt_coef0_reg.regValue = IoReg_Read32(DM_OPTtoOPT_coef0_reg);
		dm_opttoopt_coef0_reg.m33opt2opt00=8608;
		dm_opttoopt_coef0_reg.m33opt2opt01=22217;
		IoReg_Write32(DM_OPTtoOPT_coef0_reg, dm_opttoopt_coef0_reg.regValue);

		dm_opttoopt_coef1_reg.regValue = IoReg_Read32(DM_OPTtoOPT_coef1_reg);
		dm_opttoopt_coef1_reg.m33opt2opt02=1943;
		IoReg_Write32(DM_OPTtoOPT_coef1_reg, dm_opttoopt_coef1_reg.regValue);

		dm_opttoopt_coef2_reg.regValue = IoReg_Read32(DM_OPTtoOPT_coef2_reg);
		dm_opttoopt_coef2_reg.m33opt2opt10=60962;//-4574;
		dm_opttoopt_coef2_reg.m33opt2opt11=53727;//-11809;
		IoReg_Write32(DM_OPTtoOPT_coef2_reg, dm_opttoopt_coef2_reg.regValue);

		dm_opttoopt_coef3_reg.regValue = IoReg_Read32(DM_OPTtoOPT_coef3_reg);
		dm_opttoopt_coef3_reg.m33opt2opt12=16384;
		IoReg_Write32(DM_OPTtoOPT_coef3_reg, dm_opttoopt_coef3_reg.regValue);

		dm_opttoopt_coef4_reg.regValue = IoReg_Read32(DM_OPTtoOPT_coef4_reg);
		dm_opttoopt_coef4_reg.m33opt2opt20=16384;
		dm_opttoopt_coef4_reg.m33opt2opt21=50469;//-15067;
		IoReg_Write32(DM_OPTtoOPT_coef4_reg, dm_opttoopt_coef4_reg.regValue);

		dm_opttoopt_coef5_reg.regValue = IoReg_Read32(DM_OPTtoOPT_coef5_reg);
		dm_opttoopt_coef5_reg.m33opt2opt22=64219;//-1317;
		IoReg_Write32(DM_OPTtoOPT_coef5_reg, dm_opttoopt_coef5_reg.regValue);

		// enable		
		dm_submodule_enable_REG.regValue = IoReg_Read32(DM_dm_submodule_enable_reg);//read all block en/dis address
		dm_submodule_enable_REG.b01_06_enable = 1;
		IoReg_Write32(DM_dm_submodule_enable_reg, dm_submodule_enable_REG.regValue);//IoReg_Write32(address,value);
		dm_submodule_temp.b01_06_enable=1;
	} else {		
		dm_submodule_enable_REG.regValue = IoReg_Read32(DM_dm_submodule_enable_reg);//read all block en/dis address
		dm_submodule_enable_REG.b01_06_enable = 0;
		IoReg_Write32(DM_dm_submodule_enable_reg, dm_submodule_enable_REG.regValue);//IoReg_Write32(address,value);
		dm_submodule_temp.b01_06_enable=0;
	}

	dm_hdr_double_buffer_ctrl_reg.regValue = IoReg_Read32(DM_HDR_Double_Buffer_CTRL_reg);
	dm_hdr_double_buffer_ctrl_reg.dm_db_apply = 1;
	IoReg_Write32(DM_HDR_Double_Buffer_CTRL_reg, dm_hdr_double_buffer_ctrl_reg.regValue);
	
}


/* global variable for HDR CUVA*/
long long MinDisplayPQ=0; 
long long MaxDisplayPQ=3277; //16bit, 500 nit
long long inv_EOTF_MaxDisplayPQ;
long long max_lum;
long long MaxRefDisplay;
long long MIN_cuva=2182272883LL; // 32 bit float
long long targeted_system_display_maximum_luminance; // 16bit
long long EOTF_targeted_system_display_maximum_luminance; // 32bit float
long long max_display_mastering_luminance=26214; // 16bit, 4000 nit
long long maximum_maxrgb; // 16bit
long long average_maxrgb; // 16bit
long long variance_maxrgb; // 16bit
unsigned char spline_num;
unsigned char  spline_TH_mode;
unsigned char base_flag;
unsigned char base_param_Delta_mode;
unsigned char spline_flag;
long long spline_TH_MB;
long long Base_offset;
long long base_param_Delta;
long long spline_TH_0; //16bit float
long long spline_TH_Delta1_0;
long long spline_TH_Delta2_0;
long long spline_TH_1;
long long spline_TH_Delta1_1;
long long spline_TH_Delta2_1;
long long spline_Strength0; //16bit float
long long spline_Strength1;
unsigned char spline_TH_mode_1;
long long spline_TH_MB_2;
/* global variable for HDR CUVA*/

void base_9_2_2(long long *m_p, long long *m_a, long long *m_m, long long *m_n, long long *m_b, long long *K1, long long *K2, long long *K3)
{
	long long PvalueH0, PvalueL0, TPH0, TPL0, PdeltaH1, PdeltaL1, TPH1, TPL1; 
	long long tmp,tmp1,tmp2,tmp3,div_tmp1,div_tmp2;
	//int N=1;
	/*PvalueH0=3.5;
	PvalueL0=4.0;
	TPH0=0.6;
	TPL0=0.3;
	PdeltaH1=0.6;
	PdeltaL1=0;
	TPH1=0.9;
	TPL1=0.75;
	*m_m=2.4;
	*m_n=1;
	*K1=1;
	*K2=1;
	*K3=1;*/
	PvalueH0=229376;// 3bit int,16bit float
	PvalueL0=262144;// 3bit int,16bit float
	TPH0=39321;// 16bit float
	TPL0=19660;// 16bit float
	PdeltaH1=39321;// 16bit float
	PdeltaL1=0;// 16bit float
	TPH1=58982;// 16bit float
	TPL1=49152;// 16bit float
	
	*m_m=157286;// 3bit int, 16bit float
	*m_n=65535;// 3bit int, 16bit float
	*K1=65535;//16 bit float
	*K2=65535;//16 bit float
	*K3=65535;//16 bit float
	*m_b=MinDisplayPQ;
	/* calculate m_p */
	if((average_maxrgb)>TPH0)
		*m_p=PvalueH0; // 3bit int,16bit float
	else if((average_maxrgb)<TPL0)
		*m_p=PvalueL0; // 3bit int,16bit float
	else
	{
		//*m_p=PvalueH0*pow(((average_maxrgb-TPL0)/(TPH0-TPL0)),N) + PvalueL0*(1-pow(((average_maxrgb-TPL0)/(TPH0-TPL0)),N));
		//*m_p=PvalueH0*((average_maxrgb_pq<<4)-TPL0)/(TPH0-TPL0) + ((PvalueL0*(65536-((((average_maxrgb_pq<<4)-TPL0)<<16)/(TPH0-TPL0))))>>16); //m_p: // 3bit int,16bit float
		div_tmp1 = div64_s64(PvalueH0*(average_maxrgb-TPL0),(TPH0-TPL0));
		div_tmp2 = div64_s64(((average_maxrgb-TPL0)<<16),(TPH0-TPL0));
		*m_p= div_tmp1 + ((PvalueL0*(65536-(div_tmp2)))>>16); //m_p: // 3bit int,16bit float
		//*m_p=PvalueH0*(average_maxrgb-TPL0)/(TPH0-TPL0) + ((PvalueL0*(65536-(((average_maxrgb-TPL0)<<16)/(TPH0-TPL0))))>>16); //m_p: // 3bit int,16bit float
	}
	 
	/* update m_p by max_lum*/
	if(max_lum>(TPH1<<16))
		*m_p=*m_p+PdeltaH1;
	else if(max_lum<(TPL1<<16))
		*m_p=*m_p+PdeltaL1;
	else
	{
		div_tmp1 = div64_s64((max_lum-(TPL1<<16)),(TPH1-TPL1));
		*m_p=*m_p+((PdeltaH1*div_tmp1)>>16) + ((PdeltaL1*(65536-div_tmp1))>>16); //m_p: 16bit float
		//*m_p=*m_p+((PdeltaH1*((max_lum-(TPL1<<16))/(TPH1-TPL1)))>>16) + ((PdeltaL1*(65536-((max_lum-(TPL1<<16))/(TPH1-TPL1))))>>16); //m_p: 16bit float
	}
	
	/* calculate m_a */
	//*m_a=(inv_EOTF_MaxDisplayPQ-MinDisplayPQ)/pow((((*m_p) * pow(max_lum,(*m_n)))/(((*K1) * (*m_p)-(*K2))*pow(max_lum,(*m_n))+(*K3))),*m_m);
	tmp=((*m_p) * max_lum)>>16; // 16 bit float * 32bit float >>16 = 32bit float
	tmp1=((((*K1) * (*m_p))>>16)-(*K2)); //16bit float
	tmp2=((tmp1*max_lum)>>32)+(*K3); //16bit float
	div_tmp1 = div64_s64(tmp,tmp2);
	tmp3=pow_float_fix(div_tmp1,*m_m,16,0); //16bit -> need "/pow_float_fix(65535,*m_m,13)"
	if (tmp3 != 0)
		*m_a=div64_s64((inv_EOTF_MaxDisplayPQ-MinDisplayPQ)*pow_float_fix(65535,(*m_m)&0xffff,16,1),tmp3); // 16bit float
	//tmp3=pow_float_fix(tmp/tmp2,*m_m,16,0); //16bit -> need "/pow_float_fix(65535,*m_m,13)"
	//*m_a=((inv_EOTF_MaxDisplayPQ-MinDisplayPQ)*pow_float_fix(65535,(*m_m)&0xffff,16,1)/tmp3); // 16bit float
	
	//*m_a=(inv_EOTF_MaxDisplayPQ-MinDisplayPQ)/pow_float_fix(((((*m_p) * max_lum)>>16)/(((((((*K1) * (*m_p))>>16)-(*K2))*max_lum)>>32)+(*K3))),*m_m,13);
	//*m_a=(inv_EOTF_MaxDisplayPQ-MinDisplayPQ)/pow_float_fix(((((*m_p) * pow_float_fix(max_lum,*m_n,13))>>16)/(((((((*K1) * (*m_p))>>16)-(*K2))*pow_float_fix(max_lum,(*m_n),13))>>32)+(*K3))),*m_m,13); //pow_float_fix(32bit/16bit,16bit,13)->16bit ; m_a=32bit/16bit=16bit float
} 

void base_9_2_4(long long *m_p, long long *m_a, long long *m_m, long long *m_n, long long *m_b, long long *K1, long long *K2, long long *K3, long long m_p_0, long long m_a_0, long long m_m_0, long long m_n_0, long long m_b_0, long long K1_0, long long K2_0, long long K3_0)
{
	//double EOTF_MaxDisplayPQ,EOTF_targeted_system_display_maximum_luminance;
	long long tmp;
	long long tmp1,tmp2,tmp3,tmp4,div_tmp1,div_tmp2;
	*m_m=div64_s64((m_m_0<<16),10); //16bit float
	*m_n=div64_s64((m_n_0<<16),10); //16bit float
	*K1=K1_0; // 16bit float
	*K2=K2_0; // 16bit float
	*K3=K3_0; // 16bit float

	div_tmp1 = div64_s64(((long long)(inv_EOTF_MaxDisplayPQ-MinDisplayPQ)<<16),targeted_system_display_maximum_luminance);
	*m_b=(m_b_0*div_tmp1)>>32; //m_b_0:10bit float(>>4); targeted_system_display_maximum_luminance_pq:12bit float -> m_b:16bit float
	//*m_b=(m_b_0*(((long long)(inv_EOTF_MaxDisplayPQ-MinDisplayPQ)<<16)/targeted_system_display_maximum_luminance))>>32; //m_b_0:10bit float(>>4); targeted_system_display_maximum_luminance_pq:12bit float -> m_b:16bit float
	//*m_a=(m_a_0*(((long long)(inv_EOTF_MaxDisplayPQ-MinDisplayPQ)<<12)/targeted_system_display_maximum_luminance_pq))>>26; //m_a: 16bit float
	div_tmp2 = div64_s64((m_a_0<<16),1023);
	*m_a=(div_tmp2*div_tmp1)>>32; //m_a: 16bit float
	//*m_a=((m_a_0<<16)/1023*(((long long)(inv_EOTF_MaxDisplayPQ-MinDisplayPQ)<<16)/targeted_system_display_maximum_luminance))>>32; //m_a: 16bit float
	
	if(base_param_Delta_mode==2||base_param_Delta_mode==6) //base_param_Delta = -base_param_Delta
	{
		tmp=(long long)((MaxDisplayPQ<<16)-EOTF_targeted_system_display_maximum_luminance);
		tmp1=(long long)(abs_cuva(tmp));
		div_tmp1 = div64_s64(10000*tmp1,100);
		tmp2=div_tmp1>>23; //7bit int, 9bit float 
		//tmp2=(10000*tmp1/100)>>23; //7bit int, 9bit float 
		tmp3=pow_float_fix(tmp2,32768,16,0); // need /pow_float_fix((1<<9),32768,16)
		div_tmp1 = div64_s64(base_param_Delta*tmp3,pow_float_fix((1<<9),32768&0xffff,16,1));
		tmp4=div_tmp1>>16; //16bit float
		//tmp4=(base_param_Delta*tmp3/pow_float_fix((1<<9),32768&0xffff,16,1))>>16; //16bit float
		*m_p=m_p_0-tmp4;
		//*m_p=(m_p_0<<2)-tmp4;
		//*m_p=(m_p_0-((base_param_enable_Delta*pow_float_fix((10000*(long long)(abs((long long)(((MaxDisplayPQ)<<16)-EOTF_targeted_system_display_maximum_luminance)))/100)>>23,32768,16))>>5))>>2; //N=0.5; m_p: 4bit int, 12bit float
	}
	else
	{
		tmp=(long long)((MaxDisplayPQ<<16)-EOTF_targeted_system_display_maximum_luminance);
		tmp1=(long long)(abs_cuva(tmp));
		div_tmp1 = div64_s64(10000*tmp1,100);
		tmp2=div_tmp1>>23; //7bit int, 9bit float
		//tmp2=(10000*tmp1/100)>>23; //7bit int, 9bit float 
		tmp3=pow_float_fix(tmp2,32768,16,0); // need /pow_float_fix((1<<9),32768,16)
		div_tmp1 = div64_s64(base_param_Delta*tmp3,pow_float_fix((1<<9),32768&0xffff,16,1));
		tmp4=div_tmp1>>16; //16bit float
		//tmp4=(base_param_Delta*tmp3/pow_float_fix((1<<9),32768&0xffff,16,1))>>16; //16bit float
		*m_p=m_p_0+tmp4;
		//*m_p=(m_p_0<<2)+tmp4;
		//*m_p=(m_p_0+((base_param_enable_Delta*pow_float_fix((10000*(long long)(abs((long long)(((MaxDisplayPQ)<<16)-EOTF_targeted_system_display_maximum_luminance)))/100)>>23,32768,16))>>5))>>2; //N=0.5; m_p: 4bit int, 12bit float
	}
		
}

void base_9_2_5(long long *m_p, long long *m_a, long long *m_m, long long *m_n, long long *m_b, long long *K1, long long *K2, long long *K3, long long m_p_0, long long m_a_0, long long m_m_0, long long m_n_0, long long m_b_0, long long K1_0, long long K2_0, long long K3_0)
{
	long long m_p_1, m_m_1, m_n_1, m_a_1, m_b_1, K1_1, K2_1, K3_1;
	long long w;
	long long tmp,tmp1,tmp2,tmp3,tmp4,tmp5,pow_tmp0,pow_tmp1,div_tmp1;
	
	base_9_2_2(&m_p_1, &m_a_1, &m_m_1, &m_n_1, &m_b_1, &K1_1, &K2_1, &K3_1);
	if(base_param_Delta_mode==2||base_param_Delta_mode==6) //base_param_Delta = -base_param_Delta
	{
		tmp=(long long)((MaxDisplayPQ<<16)-EOTF_targeted_system_display_maximum_luminance);
		tmp1=abs_cuva(tmp);
		div_tmp1 = div64_s64(10000*tmp1,100);
		tmp2=div_tmp1>>23; //7bit int, 9bit float 
		//tmp2=(10000*tmp1/100)>>23; //7bit int, 9bit float 
		tmp3=pow_float_fix(tmp2,32768,16,0); // need /pow_float_fix((1<<9),32768,16)
		div_tmp1 = div64_s64(base_param_Delta*tmp3,pow_float_fix((1<<9),32768&0xffff,16,1));
		w=-(div_tmp1>>16); //w: 16bit float
		//w=-((base_param_Delta*tmp3/pow_float_fix((1<<9),32768&0xffff,16,1))>>16); //w: 16bit float
	}
	else
	{
		tmp=(long long)((MaxDisplayPQ<<16)-EOTF_targeted_system_display_maximum_luminance);
		tmp1=abs_cuva(tmp);
		div_tmp1 = div64_s64(10000*tmp1,100);
		tmp2=div_tmp1>>23; //7bit int, 9bit float 
		//tmp2=(10000*tmp1/100)>>23; //7bit int, 9bit float 
		tmp3=pow_float_fix(tmp2,32768,16,0); // need /pow_float_fix((1<<9),32768,16)
		div_tmp1 = div64_s64(base_param_Delta*tmp3,pow_float_fix((1<<9),32768&0xffff,16,1));
		w=div_tmp1>>16; //w: 16bit float
		//w=(base_param_Delta*tmp3/pow_float_fix((1<<9),32768&0xffff,16,1))>>16; //w: 16bit float
	}
	if(w<0)
		w=0;
	else if(w>65536)
		w=65536;

	div_tmp1 = div64_s64((65536-w)*(m_m_0<<16),10);
	*m_m=((div_tmp1)+w*m_m_1)>>16; //m_m: 16bit float
	//*m_m=((((65536-w)*(m_m_0<<16)/10))+w*m_m_1)>>16; //m_m: 16bit float
	div_tmp1 = div64_s64((65536-w)*(m_n_0<<16),10);
	*m_n=((div_tmp1)+w*m_n_1)>>16; //m_n: 16bit float
	//*m_n=((((65536-w)*(m_n_0<<16)/10))+w*m_n_1)>>16; //m_n: 16bit float
	*K1=((65536-w)*K1_0+w*K1_1)>>16; //16 bit float
	*K2=((65536-w)*K2_0+w*K2_1)>>16; //16 bit float
	*K3=((65536-w)*K3_0+w*K3_1)>>16; //16 bit float
	//*m_p=((((65536-w)*m_p_0)<<2)+w*m_p_1)>>16; // 4bit int, 16 bit float
	*m_p=(((65536-w)*m_p_0)+w*m_p_1)>>16; // 4bit int, 16 bit float
	*m_b=MinDisplayPQ;

	pow_tmp0=pow_float_fix(max_lum>>16,(*m_n),16,0);
	pow_tmp1=pow_float_fix(65535,(*m_n)&0xffff,16,1);// reduse computation time
	div_tmp1 = div64_s64((*m_p)*pow_tmp0 , pow_tmp1);
	tmp=div_tmp1>>16; //16bit float
	//tmp=((*m_p)*pow_tmp0 /pow_tmp1)>>16; //16bit float
	tmp1=((((*K1)*(*m_p))>>16)-(*K2)); //16bit float
	tmp2=pow_tmp0;//16bit float
	div_tmp1 = div64_s64(tmp1*tmp2,pow_tmp1);
	tmp3=(div_tmp1>>16)+(*K3); //16 bit float
	//tmp3=((tmp1*tmp2/pow_tmp1)>>16)+(*K3); //16 bit float
	tmp4=div64_s64((tmp<<16),tmp3);//16 bit float
	//tmp4=(tmp<<16)/tmp3;//16 bit float
	tmp5=pow_float_fix(tmp4,(*m_m),16,0);
	if (tmp5 != 0)
		*m_a=div64_s64((inv_EOTF_MaxDisplayPQ-MinDisplayPQ)*pow_float_fix(65535,(*m_m)&0xffff,16,1),tmp5); //16bit float
	//*m_a=((inv_EOTF_MaxDisplayPQ-MinDisplayPQ)*pow_float_fix(65535,(*m_m)&0xffff,16,1)/tmp5); //16bit float
	//*m_a=(inv_EOTF_MaxDisplayPQ-MinDisplayPQ)/pow_float_fix((((*m_p)*pow_float_fix(max_lum>>16,(*m_n),13))/((((((*K1)*(*m_p))>>16)-(*K2))*pow_float_fix(max_lum>>16,(*m_n),13))>>16+(*K3))),(*m_m),13);
	//*m_a=(inv_EOTF_MaxDisplayPQ-MinDisplayPQ)/pow_float_fix((((*m_p)*pow_float_fix(max_lum>>16,(*m_n),13))/((((((*K1)*(*m_p))>>16)-(*K2))*pow_float_fix(max_lum>>16,(*m_n),13))>>16+(*K3))),(*m_m),13); //m_a:16bit float
}

void spline_9_3_2_1(long long *TH3_0, long long *MB_0, long long *base_offset)
{
	long long HLMAXH2, HLMAXL2, TdmaxH2, TdmaxL2;
	long long AVMAXH3, AVMAXL3, SdmaxH3, SdmaxL3;
	long long div_tmp1,div_tmp2;
	/*HLMAXH2=0.6;
	HLMAXL2=0.3;
	TdmaxH2=0.25;
	TdmaxL2=0.1;
	
	AVMAXH3=0.6;
	AVMAXL3=0.3;
	SdmaxH3=1.0;
	SdmaxL3=0.96;*/

	//below all 16 bit float
	HLMAXH2=39321; 
	HLMAXL2=19660;
	TdmaxH2=16384;
	TdmaxL2=6553;
	
	AVMAXH3=39321;
	AVMAXL3=19660;
	SdmaxH3=65535;
	SdmaxL3=62914;
	
	if((average_maxrgb)>HLMAXH2)
		*TH3_0=TdmaxL2;
	else if((average_maxrgb)<HLMAXL2)
		*TH3_0=TdmaxH2;
	else
	{
		div_tmp1 = div64_s64(TdmaxL2*(average_maxrgb-HLMAXL2),(HLMAXH2-HLMAXL2));
		div_tmp2 = div64_s64(((average_maxrgb-HLMAXL2)<<16),(HLMAXH2-HLMAXL2));
		*TH3_0= div_tmp1 + ((TdmaxH2*(65535-div_tmp2))>>16); //16bit float
		//*TH3_0=TdmaxL2*(average_maxrgb-HLMAXL2)/(HLMAXH2-HLMAXL2) + ((TdmaxH2*(65535-(((average_maxrgb-HLMAXL2)<<16)/(HLMAXH2-HLMAXL2))))>>16); //16bit float
	}
	
	if((average_maxrgb)>AVMAXH3)
		*MB_0=SdmaxL3;
	else if((average_maxrgb)<AVMAXL3)
		*MB_0=SdmaxH3;
	else
	{
		div_tmp1 = div64_s64(SdmaxL3*(average_maxrgb-AVMAXL3),(AVMAXH3-AVMAXL3));
		div_tmp2 = div64_s64(((average_maxrgb-AVMAXL3)<<16),(AVMAXH3-AVMAXL3));
		*MB_0= div_tmp1 + ((SdmaxH3*(65535-div_tmp2))>>16); //16bit float
		//*MB_0=SdmaxL3*(average_maxrgb-AVMAXL3)/(AVMAXH3-AVMAXL3) + ((SdmaxH3*(65535-(((average_maxrgb-AVMAXL3)<<16)/(AVMAXH3-AVMAXL3))))>>16); //16bit float
	}
	*base_offset=0;			
}

void spline_9_3_2_2(long long *TH3_0, long long *MB_0, long long *base_offset)
{
	*TH3_0=spline_TH_0; //16bit float
	*MB_0=spline_TH_MB; //16bit float
	*base_offset=Base_offset; //16bit float
}

long long pow_tmp_9323_0,pow_tmp_9323_1,pow_tmp_9323_2;//reduce computation time

void spline_9_3_2_3(long long *TH3_0, long long *MB_0, long long *base_offset, long long *m_p, long long *m_a, long long *m_m, long long *m_n, long long *m_b, long long *K1, long long *K2, long long *K3)
{
	long long MB_mid_0 = 0, TH3_mid_0 = 0,tmp_m_a = 0;
	long long m_p_T[4]={163840,229376,294912,491520}; //16 bit float
	long long m_a_T[4]={64881,57606,50921,35389}; //16 bit float
	long long wa,H;
	long long tmp,tmp1,tmp2,tmp3,tmp4,tmp5,div_tmp1,div_tmp2;
	int i;

	pow_tmp_9323_0=pow_float_fix(max_lum>>16,(*m_n),16,0);//reduce computation time
	pow_tmp_9323_1=pow_float_fix(65535,(*m_n)&0xffff,16,1);
	pow_tmp_9323_2=pow_float_fix(65535,(*m_m)&0xffff,16,1);
	
	if(base_param_Delta_mode>=3||base_flag==0)
	{
		;
	}
	else
	{
		MB_mid_0=*MB_0; //16 bit float
		TH3_mid_0=*TH3_0; //16 bit float
		if((*m_a)>(*m_p)) // if m_a <= m_p -> end of function
		{
			if((*m_p)==491520) //7.5*65536=491520
				*m_a=35389; //0.54*65536
			else
			{
				for(i=0;i<3;i++)
				{
					if((*m_p)>=m_p_T[i] && (*m_p)<m_p_T[i+1])
					{
						tmp_m_a=div64_s64(((((*m_p)-m_p_T[i])*m_a_T[i+1])+((m_p_T[i+1]-(*m_p))*m_a_T[i])),(m_p_T[i+1]-m_p_T[i])); //16 bit float
						//tmp_m_a=((((*m_p)-m_p_T[i])*m_a_T[i+1])+((m_p_T[i+1]-(*m_p))*m_a_T[i]))/(m_p_T[i+1]-m_p_T[i]); //16 bit float
					}
				}
			}

			tmp=div64_s64((*m_p)*pow_tmp_9323_0,pow_tmp_9323_1); // need /pow_float_fix(65535,(*m_n),16) ; 32bit
			//tmp=(*m_p)*pow_tmp_9323_0/pow_tmp_9323_1; // need /pow_float_fix(65535,(*m_n),16) ; 32bit
			tmp1=(((*K1)*(*m_p))>>16)-(*K2); //16bit float
			tmp2=pow_tmp_9323_0; // need /pow_float_fix(65535,(*m_n),16)
			tmp3=div64_s64(tmp1*tmp2 , pow_tmp_9323_1); //32bit
			//tmp3=tmp1*tmp2 / pow_tmp_9323_1; //32bit
			div_tmp1 = div64_s64(tmp*pow_float_fix(65535,(*m_n),16,0),pow_tmp_9323_1);
			tmp4=div64_s64((div_tmp1<<16),tmp3); //16bit float
			//tmp4=((tmp*pow_float_fix(65535,(*m_n),16,0)/pow_tmp_9323_1)<<16)/tmp3; //16bit float
			tmp5=pow_float_fix(tmp4,(*m_m),16,0); // need /pow_float_fix(65535,(*m_m),16)
			div_tmp1 = div64_s64(tmp_m_a*tmp5,pow_tmp_9323_2);
			H=(div_tmp1+((*m_b)<<16))>>16; //16bit float
			//H=(tmp_m_a*tmp5/pow_tmp_9323_2+((*m_b)<<16))>>16; //16bit float
			div_tmp1 = div64_s64((inv_EOTF_MaxDisplayPQ<<16),max_lum);
			div_tmp2 = div64_s64((H<<32),max_lum);
			wa=div64_s64((( div_tmp1 - div_tmp2)<<16) , (65535-div_tmp2)); //16bit float
			//wa=((((inv_EOTF_MaxDisplayPQ<<16)/max_lum) - ((H<<32)/max_lum))<<16) / (65535-((H<<32)/max_lum)); //16bit float
			*m_b=((65535-wa)*(*m_b))>>16; //16bit float
			*MB_0=min_cuva(max_cuva(MB_mid_0+(((65535-MB_mid_0)*wa)>>16) , MB_mid_0) , 65535); //16bit float
			*TH3_0=min_cuva(max_cuva(TH3_mid_0+(((max_lum-(TH3_mid_0<<16))*wa)>>32) , TH3_mid_0) , 65535); //16bit float
			
			//H=tmp_m_a*pow((((*m_p)*pow(max_lum,(*m_n)))/(((*K1)*(*m_p)-(*K2)) * pow(max_lum,(*m_n)) + (*K3))),(*m_m)) + (*m_b);
			//wa=((inv_EOTF_MaxDisplayPQ/max_lum) - (H/max_lum)) / (1-(H/max_lum));
			//*m_b=(1-wa)*(*m_b);
			//*MB_0=min(max(MB_mid_0+(1-MB_mid_0)*wa , MB_mid_0) , 1);
			//*TH3_0=min(max(TH3_mid_0+(max_lum-TH3_mid_0)*wa , TH3_mid_0) , 1);

		}
	}
}

void spline_9_3_3_1(long long *TH3_0, long long *MB_0, long long *base_offset, long long *m_p, long long *m_a, long long *m_m, long long *m_n, long long *m_b, long long *K1, long long *K2, long long *K3,long long *TH1_1, long long *TH2_1, long long *TH3_1, long long *MA_0_1, long long *MB_0_1, long long *MC_0_1, long long *MD_0_1, long long *MA_1_1, long long *MB_1_1, long long *MC_1_1, long long *MD_1_1)
{
	long long tmp,tmp1,tmp2,tmp3,tmp4,tmp5,tmp6,pow_tmp0,div_tmp1,div_tmp2;
	long long tTH1_1, tTH2_1, tTH3_1;
	long long VA1, VA2, VA3;
	long long B=9830, C=32768, D=32768; //16bit float
	long long GD1,GD3;
	long long tMA_0_1, tMB_0_1, tMC_0_1, tMD_0_1, tMA_1_1, tMB_1_1, tMC_1_1, tMD_1_1;
	long long DTH2, DTH3, h1, h2;
	
	tTH1_1=*TH3_0; //16bit float
	tTH2_1=tTH1_1+B; //16bit float
	tTH3_1=((tTH2_1<<16)+C*tTH2_1-D*tTH1_1)>>16; //16bit float
	
	VA1=(((*MB_0)*tTH1_1)>>16)+(*base_offset);//16bit float

	pow_tmp0=pow_float_fix(tTH3_1,(*m_n),16,0);
	
	tmp=pow_tmp0; // need /pow_float_fix(65535,(*m_n)&0xffff,16,1)
	tmp1=div64_s64((*m_p)*tmp,pow_tmp_9323_1);//32bit float
	//tmp1=(*m_p)*tmp/pow_tmp_9323_1;//32bit float
	tmp2=(((*K1)*(*m_p))>>16)-(*K2); //16bit float
	tmp3=pow_tmp0; // need /pow_float_fix(65535,(*m_n)&0xffff,16,1)
	div_tmp1 = div64_s64(tmp2*tmp3,pow_tmp_9323_1);
	tmp4=(div_tmp1+((*K3)<<16))>>16; //16bit float
	//tmp4=(tmp2*tmp3/pow_tmp_9323_1+((*K3)<<16))>>16; //16bit float
	div_tmp1 = div64_s64(tmp1,tmp4);
	tmp5=pow_float_fix(div_tmp1,(*m_m),16,0);//need /pow_float_fix(65535,(*m_m)&0xffff,16,1)
	//tmp5=pow_float_fix(tmp1/tmp4,(*m_m),16,0);//need /pow_float_fix(65535,(*m_m)&0xffff,16,1)
	div_tmp1 = div64_s64((*m_a)*tmp5,pow_tmp_9323_2);
	VA3=(div_tmp1+((*m_b)<<16))>>16; //16bit float
	//VA3=((*m_a)*tmp5/pow_tmp_9323_2+((*m_b)<<16))>>16; //16bit float
	div_tmp1 = div64_s64((tTH2_1-tTH1_1)*(VA3-VA1),(tTH3_1-tTH1_1));
	VA2=VA1+div_tmp1; //16bit float
	//VA2=VA1+((tTH2_1-tTH1_1)*(VA3-VA1)/(tTH3_1-tTH1_1)); //16bit float
	
	tMA_0_1=VA1;
	tMA_1_1=VA2;
	
	tMB_0_1=*MB_0;
	GD1=*MB_0;

	tmp=((((((*m_a)*(*m_m)*(*m_p))>>16)*(*K3))>>16)*(*m_n))>>32; //16bit float
	tmp1=pow_float_fix(tTH3_1,(*m_n-65536),16,0); // need /pow_float_fix(65535,((*m_n-65535)&0xffff),16)
	tmp2=div64_s64((*m_p)*pow_tmp0,pow_tmp_9323_1); //16bit float
	//tmp2=((*m_p)*pow_tmp0/pow_tmp_9323_1); //16bit float
	div_tmp1 = div64_s64(((((*K1)*(*m_p))>>16)-(*K2)) * pow_tmp0 , pow_tmp_9323_1);
	tmp3=(div_tmp1>>16) + (*K3); //16bit float
	//tmp3=((((((*K1)*(*m_p))>>16)-(*K2)) * pow_tmp0 / pow_tmp_9323_1)>>16) + (*K3); //16bit float
	div_tmp1 = div64_s64(tmp2,tmp3);
	tmp4=div64_s64(pow_float_fix(div_tmp1,(*m_m+65536),16,0),pow_float_fix(65535,((*m_m+65536)&0xffff),16,1)); // need /pow_float_fix(65535,(*m_m+65535),16) ; 16bit
	//tmp4=pow_float_fix((tmp2)/tmp3,(*m_m+65536),16,0)/pow_float_fix(65535,((*m_m+65536)&0xffff),16,1); // need /pow_float_fix(65535,(*m_m+65535),16) ; 16bit
	tmp5=div64_s64(pow_tmp0 * (*m_p) , pow_tmp_9323_1);
	//tmp5=pow_tmp0 * (*m_p) / pow_tmp_9323_1;
	div_tmp1 = div64_s64(4294967296,(tmp5>>16));
	tmp6=pow_float_fix(div_tmp1,131072,16,0);
	//tmp6=pow_float_fix(((4294967296)/(tmp5>>16)),131072,16,0);
	//GD3=(((tmp * tmp1 / pow_float_fix(65535,((*m_n-65536)&0xffff),16,1) * tmp4)>>32) * tmp6 / pow_float_fix(65535,131072&0xffff,16,1))>>32;  //16bit float
	if(*m_n-65536==0)
	{
		div_tmp1 = div64_s64(tmp * tmp1 , pow_float_fix(65535,((*m_n-65536)&0xffff),16,1));
		div_tmp2 = div64_s64(((div_tmp1 * tmp4)>>16) * tmp6 , pow_float_fix(65535,131072&0xffff,16,1));
		GD3=div_tmp2>>32;  //16bit float
		//GD3=(((tmp * tmp1 / pow_float_fix(65535,((*m_n-65536)&0xffff),16,1) * tmp4)>>16) * tmp6 / pow_float_fix(65535,131072&0xffff,16,1))>>32;  //16bit float
	}
	else
	{
		div_tmp1 = div64_s64(tmp * tmp1 , pow_float_fix(65535,((*m_n-65536)&0xffff),16,1));
		div_tmp2 = div64_s64(((div_tmp1 * tmp4)>>32) * tmp6 , pow_float_fix(65535,131072&0xffff,16,1));
		GD3=div_tmp2>>32;  //16bit float
		//GD3=(((tmp * tmp1 / pow_float_fix(65535,((*m_n-65536)&0xffff),16,1) * tmp4)>>32) * tmp6 / pow_float_fix(65535,131072&0xffff,16,1))>>32;  //16bit float
	}
	
	
	DTH2=tTH2_1-tTH1_1;
	DTH3=tTH3_1-tTH2_1;
	h1=DTH2;
	h2=DTH3;
	// calculate MB_1_1, MC_0_1, MD_0_1, MC_1_1, MD_1_1
	/*tMB_1_1 = -(3.0*VA1*h2*h2 + 3.0*VA2*h1*h1 - 3.0*VA3*h1*h1 - 3.0*h2*h2*VA2 + h1*h1*h2*GD3 + GD1*h1*h2*h2)/(2.0*h2*(h1*h1 + h2*h1));
	tMC_0_1 = (3.0*VA2 - 2.0*GD1*h1 - 3.0*VA1 - tMB_1_1*h1)/(h1*h1);
	tMD_0_1 = (h1*GD1 + h1*tMB_1_1 + 2.0*VA1 - 2.0*VA2)/(h1*h1*h1);
	tMC_1_1 = tMC_0_1 + 3.0*tMD_0_1*h1;
	tMD_1_1 = -(VA3 - VA2 - h2*GD3 + tMC_0_1*h2*h2 + 3.0*tMD_0_1*h1*h2*h2)/(2.0*h2*h2*h2);*/
	div_tmp1 = div64_s64((3*VA1*h2*h2 + 3*VA2*h1*h1 - 3*VA3*h1*h1 - 3*h2*h2*VA2 + ((h1*h1*h2)>>16)*GD3 + ((GD1*h1*h2)>>16)*h2),((2*h2*(h1*h1 + h2*h1))>>16));
	tMB_1_1 = -(div_tmp1); //16bit float	
	//tMB_1_1 = -((3*VA1*h2*h2 + 3*VA2*h1*h1 - 3*VA3*h1*h1 - 3*h2*h2*VA2 + ((h1*h1*h2)>>16)*GD3 + ((GD1*h1*h2)>>16)*h2)/((2*h2*(h1*h1 + h2*h1))>>16)); //16bit float	
	tMC_0_1 = div64_s64(((3*(VA2<<16) - 2*GD1*h1 - 3*(VA1<<16) - tMB_1_1*h1)<<16),(h1*h1)); //16bit float
	//tMC_0_1 = ((3*(VA2<<16) - 2*GD1*h1 - 3*(VA1<<16) - tMB_1_1*h1)<<16)/(h1*h1); //16bit float
	tMD_0_1 = div64_s64(((h1*GD1 + h1*tMB_1_1 + 2*(VA1<<16) - 2*(VA2<<16))<<16),((h1*h1*h1)>>16)); //16bit float
	//tMD_0_1 = ((h1*GD1 + h1*tMB_1_1 + 2*(VA1<<16) - 2*(VA2<<16))<<16)/((h1*h1*h1)>>16); //16bit float
	tMC_1_1 = ((tMC_0_1<<16) + 3*tMD_0_1*h1)>>16; //16bit float
	tMD_1_1 = -div64_s64(((((VA3<<16) - (VA2<<16) - h2*GD3)<<16) + tMC_0_1*h2*h2 + (3*((tMD_0_1*h1*h2)>>16)*h2)),((2*h2*h2*h2)>>16)); //16bit float
	//tMD_1_1 = -((((VA3<<16) - (VA2<<16) - h2*GD3)<<16) + tMC_0_1*h2*h2 + (3*((tMD_0_1*h1*h2)>>16)*h2))/((2*h2*h2*h2)>>16); //16bit float

	// assign tmp calculation result to the output pointer
	*TH1_1=tTH1_1;
	*TH2_1=tTH2_1;
	*TH3_1=tTH3_1;
	*MA_0_1=tMA_0_1;
	*MB_0_1=tMB_0_1;
	*MC_0_1=tMC_0_1;
	*MD_0_1=tMD_0_1;
	*MA_1_1=tMA_1_1;
	*MB_1_1=tMB_1_1;
	*MC_1_1=tMC_1_1;
	*MD_1_1=tMD_1_1;
}

void spline_9_3_3_2(long long *TH3_0, long long *MB_0, long long *base_offset, long long *m_p, long long *m_a, long long *m_m, long long *m_n, long long *m_b, long long *K1, long long *K2, long long *K3,long long *TH1_1, long long *TH2_1, long long *TH3_1, long long *MA_0_1, long long *MB_0_1, long long *MC_0_1, long long *MD_0_1, long long *MA_1_1, long long *MB_1_1, long long *MC_1_1, long long *MD_1_1)
{
	long long tTH1_1, tTH2_1, tTH3_1;
	long long VA1, VA2, VA3;
	long long GD1,GD3;
	long long tMA_0_1, tMB_0_1, tMC_0_1, tMD_0_1, tMA_1_1, tMB_1_1, tMC_1_1, tMD_1_1;
	long long tmp,tmp1,tmp2,tmp3,tmp4,tmp5,tmp6,pow_tmp0,div_tmp1,div_tmp2;
	long long DTH2, DTH3, h1, h2;
	
	tTH1_1=*TH3_0; //16bit float
	tTH2_1=tTH1_1+spline_TH_Delta1_0; //16bit float
	tTH3_1=tTH1_1+spline_TH_Delta1_0+spline_TH_Delta2_0; //16bit float

	pow_tmp0=pow_float_fix(tTH3_1,(*m_n),16,0);
	
	VA1=((*MB_0)*tTH1_1+((*base_offset)<<16))>>16; //16bit float
	
	div_tmp1 = div64_s64((*m_p)* pow_tmp0,pow_tmp_9323_1);
	tmp=div_tmp1>>16; //  16bit float
	//tmp=((*m_p)* pow_tmp0/pow_tmp_9323_1)>>16; //  16bit float
	tmp1=(((*K1)*(*m_p))>>16)-(*K2); //16bit float
	tmp2=pow_tmp0; // need /pow_float_fix(65535,(*m_n&0xffff),16); 32bit
	div_tmp1 = div64_s64(tmp1*tmp2,pow_tmp_9323_1);
	tmp3=(div_tmp1>>16)+(*K3); //16bit float
	//tmp3=((tmp1*tmp2/pow_tmp_9323_1)>>16)+(*K3); //16bit float
	tmp4=div64_s64(tmp<<16,tmp3); //16bit float
	//tmp4=(tmp<<16)/tmp3; //16bit float
	div_tmp1 = div64_s64((*m_a)*pow_float_fix(tmp4,(*m_m),16,0),pow_tmp_9323_2);
	VA3=(div_tmp1+((*m_b)<<16))>>16; //16bit float
	//VA3=(((*m_a)*pow_float_fix(tmp4,(*m_m),16,0)/pow_tmp_9323_2)+((*m_b)<<16))>>16; //16bit float
	
	
	if(VA3>tTH3_1 && base_param_Delta_mode!=3 && base_param_Delta_mode!=2 && base_param_Delta_mode!=6)
	{
		*m_b=*m_b-(VA3-tTH3_1);//16bit float
		VA3=tTH3_1;//16bit float
	}
	div_tmp1 = div64_s64((tTH2_1-tTH1_1)*(VA3-VA1),(tTH3_1-tTH1_1));
	VA2=((VA1 + div_tmp1)<<16) + (((VA3-VA1)*spline_Strength0/2)); //32bit float
	//VA2=((VA1 + ((tTH2_1-tTH1_1)*(VA3-VA1)/(tTH3_1-tTH1_1)))<<16) + (((VA3-VA1)*spline_Strength0/2)); //32bit float
	
	if((VA2>>16)>tTH2_1 && (base_param_Delta_mode!=2&&base_param_Delta_mode!=3&&base_param_Delta_mode!=6))
		VA2=tTH2_1<<16; //16bit float
	
	tMA_0_1=VA1; //16bit float
	tMA_1_1=VA2>>16; //16bit float
	
	tMB_0_1=*MB_0; //16bit float
	GD1=*MB_0; //16bit float
	/*tmp=((((((*m_a)*(*m_m)*(*m_p))>>16)*(*K3))>>16)*(*m_n))>>32; //16bit float
	tmp1=pow_float_fix(tTH3_1,(*m_n-65535),16,0); // need /pow_float_fix(65535,((*m_n-65535)&0xffff),16)
	tmp2=((*m_p)*pow_float_fix(tTH3_1,(*m_n),16,0)/pow_float_fix(65535,(*m_n&0xffff),16,1))>>16; //16bit float
	tmp3=((((((*K1)*(*m_p))>>16)-(*K2)) * pow_float_fix(tTH3_1,(*m_n),16,0) / pow_float_fix(65535,(*m_n&0xffff),16,1))>>16) + (*K3); //16bit float
	tmp4=pow_float_fix((tmp2<<16)/tmp3,(*m_m+65535),16,0)/pow_float_fix(65535,((*m_m+65535)&0xffff),16,1); // need /pow_float_fix(65535,(*m_m+65535),16) ; 16bit
	//tmp5=pow_float_fix(((65535<<16)/((pow_float_fix(tTH3_1,(*m_n),16,0) * (*m_p) / pow_float_fix(65535,(*m_n&0xffff),16,1))>>16)),131070,16,0); // need /pow_float_fix(65535,131070,16)
	tmp5=(pow_float_fix(tTH3_1,(*m_n),16,0) * (*m_p) / pow_float_fix(65535,(*m_n&0xffff),16,1));
	tmp6=pow_float_fix(((4294967296)/(tmp5>>16)),131072,16,0);
	GD3=(((tmp * tmp1 / pow_float_fix(65535,((*m_n-65535)&0xffff),16,1) * tmp4)>>32) * tmp6 / pow_float_fix(65535,131072&0xffff,16,1))>>32;  //16bit float*/

	tmp=((((((*m_a)*(*m_m)*(*m_p))>>16)*(*K3))>>16)*(*m_n))>>32; //16bit float
	tmp1=pow_float_fix(tTH3_1,(*m_n-65536),16,0); // need /pow_float_fix(65535,((*m_n-65535)&0xffff),16)
	tmp2=div64_s64((*m_p)*pow_tmp0,pow_tmp_9323_1); //16bit float
	//tmp2=((*m_p)*pow_tmp0/pow_tmp_9323_1); //16bit float
	div_tmp1 = div64_s64(((((*K1)*(*m_p))>>16)-(*K2)) * pow_tmp0 , pow_tmp_9323_1);
	tmp3=(div_tmp1>>16) + (*K3); //16bit float
	//tmp3=((((((*K1)*(*m_p))>>16)-(*K2)) * pow_tmp0 / pow_tmp_9323_1)>>16) + (*K3); //16bit float
	div_tmp1 = div64_s64(tmp2,tmp3);
	tmp4=div64_s64(pow_float_fix(div_tmp1,(*m_m+65536),16,0),pow_float_fix(65535,((*m_m+65536)&0xffff),16,1)); // need /pow_float_fix(65535,(*m_m+65535),16) ; 16bit
	//tmp4=pow_float_fix((tmp2)/tmp3,(*m_m+65536),16,0)/pow_float_fix(65535,((*m_m+65536)&0xffff),16,1); // need /pow_float_fix(65535,(*m_m+65535),16) ; 16bit
	tmp5=div64_s64(pow_tmp0 * (*m_p) , pow_tmp_9323_1);
	//tmp5=(pow_tmp0 * (*m_p) / pow_tmp_9323_1);
	div_tmp1 = div64_s64(4294967296,(tmp5>>16));
	tmp6=pow_float_fix(div_tmp1,131072,16,0);
	//tmp6=pow_float_fix(((4294967296)/(tmp5>>16)),131072,16,0);
	if(*m_n-65536==0)
	{
		div_tmp1 = div64_s64(tmp * tmp1 , pow_float_fix(65535,((*m_n-65536)&0xffff),16,1));
		div_tmp2 = div64_s64((( div_tmp1* tmp4)>>16) * tmp6 , pow_float_fix(65535,131072&0xffff,16,1));
		GD3=div_tmp2>>32;  //16bit float
		//GD3=(((tmp * tmp1 / pow_float_fix(65535,((*m_n-65536)&0xffff),16,1) * tmp4)>>16) * tmp6 / pow_float_fix(65535,131072&0xffff,16,1))>>32;  //16bit float
	}
	else
	{
		div_tmp1 = div64_s64(tmp * tmp1 , pow_float_fix(65535,((*m_n-65536)&0xffff),16,1));
		div_tmp2 = div64_s64((( div_tmp1* tmp4)>>32) * tmp6 , pow_float_fix(65535,131072&0xffff,16,1));
		GD3=div_tmp2>>32;  //16bit float
		//GD3=(((tmp * tmp1 / pow_float_fix(65535,((*m_n-65536)&0xffff),16,1) * tmp4)>>32) * tmp6 / pow_float_fix(65535,131072&0xffff,16,1))>>32;  //16bit float
	}

	//GD3=(((((tmp*tmp1/pow_float_fix(65535,((*m_n-65535)&0xffff),16,1))>>16)*tmp4/pow_float_fix(65535,((*m_m+65535)&0xffff),16,1))>>16)*tmp5/pow_float_fix(65535,131070&0xffff,16,1))>>16; //16bit float
	
	//GD3=(*m_a)*(*m_m)*(*m_p)*(*K3)*(*m_n)*pow(tTH3_1,(*m_n-1)) * (pow((((*m_p)*pow(tTH3_1,(*m_n)))/(((*K1)*(*m_p)-(*K2))*pow(tTH3_1,(*m_n))+(*K3))),(*m_m+1))) * (pow((1.0/(pow(tTH3_1,(*m_n))*(*m_p))),2));
	
	
	DTH2=tTH2_1-tTH1_1;
	DTH3=tTH3_1-tTH2_1;
	h1=DTH2;
	h2=DTH3;
	// calculate MB_1_1, MC_0_1, MD_0_1, MC_1_1, MD_1_1
	/*tMB_1_1 = -(3.0*VA1*h2*h2 + 3.0*VA2*h1*h1 - 3.0*VA3*h1*h1 - 3.0*h2*h2*VA2 + h1*h1*h2*GD3 + GD1*h1*h2*h2)/(2.0*h2*(h1*h1 + h2*h1));
	tMC_0_1 = (3.0*VA2 - 2.0*GD1*h1 - 3.0*VA1 - tMB_1_1*h1)/(h1*h1);
	tMD_0_1 = (h1*GD1 + h1*tMB_1_1 + 2*VA1 - 2.0*VA2)/(h1*h1*h1);
	tMC_1_1 = tMC_0_1 + 3.0*tMD_0_1*h1;
	tMD_1_1 = -(VA3 - VA2 - h2*GD3 + tMC_0_1*h2*h2 + 3.0*tMD_0_1*h1*h2*h2)/(2.0*h2*h2*h2);*/
	tMB_1_1 = -div64_s64((3*VA1*h2*h2 + ((3*VA2*h1)>>16)*h1 - 3*VA3*h1*h1 - h2*((3*h2*VA2)>>16) + ((h1*h1*h2)>>16)*GD3 + ((GD1*h1*h2)>>16)*h2),((2*h2*(h1*h1 + h2*h1))>>16)); //16bit float
	//tMB_1_1 = -((3*VA1*h2*h2 + ((3*VA2*h1)>>16)*h1 - 3*VA3*h1*h1 - h2*((3*h2*VA2)>>16) + ((h1*h1*h2)>>16)*GD3 + ((GD1*h1*h2)>>16)*h2)/((2*h2*(h1*h1 + h2*h1))>>16)); //16bit float
	tMC_0_1 = div64_s64(((3*(VA2) - 2*GD1*h1 - 3*(VA1<<16) - tMB_1_1*h1)<<16),(h1*h1)); //16bit float
	//tMC_0_1 = ((3*(VA2) - 2*GD1*h1 - 3*(VA1<<16) - tMB_1_1*h1)<<16)/(h1*h1); //16bit float
	tMD_0_1 =div64_s64(((h1*GD1 + h1*tMB_1_1 + 2*(VA1<<16) - 2*(VA2))<<16),((h1*h1*h1)>>16)); //16bit float
	//tMD_0_1 = ((h1*GD1 + h1*tMB_1_1 + 2*(VA1<<16) - 2*(VA2))<<16)/((h1*h1*h1)>>16); //16bit float
	tMC_1_1 = ((tMC_0_1<<16) + 3*tMD_0_1*h1)>>16; //16bit float
	tMD_1_1 = -div64_s64(((((VA3<<16) - (VA2) - h2*GD3)<<16) + tMC_0_1*h2*h2 + (3*((tMD_0_1*h1*h2)>>16)*h2)),((2*h2*h2*h2)>>16)); //16bit float
	//tMD_1_1 = -((((VA3<<16) - (VA2) - h2*GD3)<<16) + tMC_0_1*h2*h2 + (3*((tMD_0_1*h1*h2)>>16)*h2))/((2*h2*h2*h2)>>16); //16bit float
	// assign tmp calculation result to the output pointer
	*TH1_1=tTH1_1;
	*TH2_1=tTH2_1;
	*TH3_1=tTH3_1;
	*MA_0_1=tMA_0_1;
	*MB_0_1=tMB_0_1;
	*MC_0_1=tMC_0_1;
	*MD_0_1=tMD_0_1;
	*MA_1_1=tMA_1_1;
	*MB_1_1=tMB_1_1;
	*MC_1_1=tMC_1_1;
	*MD_1_1=tMD_1_1;
}

void spline_9_3_3_3(long long *TH3_0, long long *MB_0, long long *base_offset, long long *m_p, long long *m_a, long long *m_m, long long *m_n, long long *m_b, long long *K1, long long *K2, long long *K3, long long *TH1_1, long long *TH2_1, long long *TH3_1, long long *MA_0_1, long long *MB_0_1, long long *MC_0_1, long long *MD_0_1, long long *MA_1_1, long long *MB_1_1, long long *MC_1_1, long long *MD_1_1, long long *TH1_2, long long *TH2_2, long long *TH3_2, long long *MA_0_2, long long *MB_0_2, long long *MC_0_2, long long *MD_0_2, long long *MA_1_2, long long *MB_1_2, long long *MC_1_2, long long *MD_1_2)
{
	long long tTH1_2, tTH2_2, tTH3_2;
	long long VA1, VA2, VA3;
	long long GD1,GD2,GD3 = 0;
	long long tMA_0_2, tMB_0_2, tMC_0_2, tMD_0_2, tMA_1_2, tMB_1_2, tMC_1_2, tMD_1_2;
	long long TH_str;
	long long down_T, down_T1, up_T, up_T1, mid_T;
	long long tmp,tmp1,tmp2,tmp3,tmp4,tmp5,tmp6,pow_tmp0,pow_tmp1,pow_tmp2,pow_tmp3,div_tmp1,div_tmp2;
	long long DTH2, DTH3, h1, h2;

	if(spline_num==1)
	{
		tTH1_2=spline_TH_0; //16bit float
		tTH2_2=(spline_TH_0+spline_TH_Delta1_0)<<16; // ****** 32bit float *****
		tTH3_2=(spline_TH_0+spline_TH_Delta1_0+spline_TH_Delta2_0)<<16; // ****** 32bit float *****
	}
	else // 3spline_num=2 : use second set parameter
	{
		tTH1_2=spline_TH_1; //16bit float
		tTH2_2=(spline_TH_1+spline_TH_Delta1_1)<<16; // ****** 32bit float *****
		tTH3_2=(spline_TH_1+spline_TH_Delta1_1+spline_TH_Delta2_1)<<16; // ****** 32bit float *****
		spline_TH_mode=spline_TH_mode_1;
	}
	if(tTH3_2<(*TH3_1<<16))
	{
		spline_num=1;
		*TH1_2=tTH1_2;
		*TH2_2=tTH2_2>>16; //16bit float
		*TH3_2=tTH3_2>>16; //16bit float
	}
	else
	{
		if(tTH1_2<(*TH3_1))
		{
			tTH1_2=(*TH3_1);
			tTH2_2=((tTH1_2<<16)+tTH3_2)/2; // ****** 32bit float *****
		}

		pow_tmp0=pow_float_fix(tTH1_2,(*m_n),16,0);
		pow_tmp1=pow_float_fix((tTH3_2>>16),(*m_n),16,0);
		pow_tmp2=pow_float_fix(65535,((*m_m+65535)&0xffff),16,1);
		pow_tmp3=pow_float_fix(65535,131072&0xffff,16,1);
		
		tmp=div64_s64((*m_p)* pow_tmp0,pow_tmp_9323_1); // need /pow_float_fix(65535,(*m_n),16) -> 32bit float
		//tmp=(*m_p)* pow_tmp0/pow_tmp_9323_1; // need /pow_float_fix(65535,(*m_n),16) -> 32bit float
		tmp1=(((*K1)*(*m_p))>>16)-(*K2); //16bit float
		tmp2=pow_tmp0; // need /pow_float_fix(65535,(*m_n),16)

		div_tmp1 = div64_s64(tmp1*tmp2,pow_tmp_9323_1);
		tmp3=(div_tmp1+((*K3)<<16))>>16; //16bit float
		//tmp3=(tmp1*tmp2/pow_tmp_9323_1+((*K3)<<16))>>16; //16bit float
		tmp4=div64_s64(tmp,tmp3); //16bit float
		//tmp4=(tmp)/tmp3; //16bit float
		div_tmp1 = div64_s64((*m_a)*pow_float_fix(tmp4,(*m_m),16,0),pow_tmp_9323_2);
		VA1=(div_tmp1+((*m_b)<<16)); //32bit float
		//VA1=(((*m_a)*pow_float_fix(tmp4,(*m_m),16,0)/pow_tmp_9323_2)+((*m_b)<<16)); //32bit float

		tmp=div64_s64((*m_p)* pow_tmp1,pow_tmp_9323_1); // need /pow_float_fix(65535,(*m_n),16) -> 32bit float
		//tmp=(*m_p)* pow_tmp1/pow_tmp_9323_1; // need /pow_float_fix(65535,(*m_n),16) -> 32bit float
		tmp1=(((*K1)*(*m_p))>>16)-(*K2); //16bit float
		tmp2=pow_tmp1; // need /pow_float_fix(65535,(*m_n),16)
		div_tmp1 = div64_s64(tmp1*tmp2,pow_tmp_9323_1);
		tmp3=(div_tmp1+((*K3)<<16))>>16; //16bit float
		//tmp3=(tmp1*tmp2/pow_tmp_9323_1+((*K3)<<16))>>16; //16bit float
		tmp4=div64_s64(tmp,tmp3); //16bit float
		//tmp4=(tmp)/tmp3; //16bit float
		div_tmp1 = div64_s64((*m_a)*pow_float_fix(tmp4,(*m_m),16,0),pow_tmp_9323_2);
		VA3=(div_tmp1+((*m_b)<<16)); // ****** 32bit float *****
		//VA3=((*m_a)*pow_float_fix(tmp4,(*m_m),16,0)/pow_tmp_9323_2+((*m_b)<<16)); // ****** 32bit float *****
		
		if((spline_TH_mode==1||spline_TH_mode==2) && base_param_Delta_mode!=3)
		{
			VA3=inv_EOTF_MaxDisplayPQ; // ****** 32bit float *****
			if(VA3>tTH3_2 && (base_param_Delta_mode!=2 && base_param_Delta_mode!=6)) //!= 2 and 6 
			{
				tTH3_2=VA3; // ****** 32bit float *****
				tTH2_2=(tTH1_2<<16)+(tTH3_2-(tTH1_2<<16))/2; // ****** 32bit float *****
				pow_tmp1=pow_float_fix((tTH3_2>>16),(*m_n),16,0);
			} 
		}
		else if((spline_TH_mode==1||spline_TH_mode==2) && base_param_Delta_mode==3)
			VA3=targeted_system_display_maximum_luminance<<16; // ****** 32bit float *****
			//VA3=targeted_system_display_maximum_luminance_pq<<20; // ****** 32bit float *****
		else if(spline_TH_mode==3)
			; // VA3=VA3 ****** 32bit float *****

		div_tmp1 = div64_s64(((tTH2_2>>16)-tTH1_2)*(VA3-(VA1)),(tTH3_2-(tTH1_2<<16)));
		VA2=((VA1>>16) + div_tmp1 + (((VA3-(VA1))*spline_Strength1/2)>>32))<<16; // ****** 32bit float *****
		//VA2=((VA1>>16) + (((tTH2_2>>16)-tTH1_2)*(VA3-(VA1))/(tTH3_2-(tTH1_2<<16))) + (((VA3-(VA1))*spline_Strength1/2)>>32))<<16; // ****** 32bit float *****
		
		if((spline_TH_mode==1||spline_TH_mode==2) && (VA2)>tTH2_2 && (base_param_Delta_mode!=2&&base_param_Delta_mode!=3&&base_param_Delta_mode!=6))
			VA2=tTH2_2; // ****** 32bit float *****
		
		tMA_0_2=VA1>>16; //16bit float
		tMA_1_2=VA2; // ****** 32bit float *****

		tmp=((((((*m_a)*(*m_m)*(*m_p))>>16)*(*K3))>>16)*(*m_n))>>32; //16bit float
		tmp1=pow_float_fix(tTH1_2,(*m_n-65536),16,0); // need /pow_float_fix(65535,(*m_n-65535),16)
		tmp2=div64_s64((*m_p)*pow_tmp0,pow_tmp_9323_1); //32bit float
		//tmp2=(*m_p)*pow_tmp0/pow_tmp_9323_1; //32bit float
		div_tmp1 = div64_s64(((((*K1)*(*m_p))>>16)-(*K2)) * pow_tmp0 , pow_tmp_9323_1);
		tmp3=( div_tmp1 + ((*K3)<<16))>>16; //16bit float
		//tmp3=(((((*K1)*(*m_p))>>16)-(*K2)) * pow_tmp0 / pow_tmp_9323_1 + ((*K3)<<16))>>16; //16bit float
		div_tmp1 = div64_s64(tmp2,tmp3);
		tmp4=div64_s64(pow_float_fix(div_tmp1,(*m_m+65536),16,0),pow_tmp2); // need /pow_float_fix(65535,(*m_m+65535),16)
		//tmp4=pow_float_fix((tmp2)/tmp3,(*m_m+65536),16,0)/pow_tmp2; // need /pow_float_fix(65535,(*m_m+65535),16)
		div_tmp1 = div64_s64(pow_tmp0*(*m_p),pow_tmp_9323_1);
		div_tmp2 = div64_s64(4294967296,(div_tmp1>>16));
		tmp5=pow_float_fix(div_tmp2,131072,16,0); // need /pow_float_fix(65535,131070,16)
		//tmp5=pow_float_fix(((4294967296)/((pow_tmp0*(*m_p)/pow_tmp_9323_1)>>16)),131072,16,0); // need /pow_float_fix(65535,131070,16)
		if(*m_n-65536==0)
		{	
			div_tmp1 = div64_s64(tmp * tmp1 , pow_float_fix(65535,((*m_n-65536)&0xffff),16,1));
			div_tmp2 = div64_s64((( div_tmp1* tmp4)>>16) * tmp5 , pow_tmp3);
			tMB_0_2=div_tmp2>>32;  //16bit float
			//tMB_0_2=(((tmp * tmp1 / pow_float_fix(65535,((*m_n-65536)&0xffff),16,1) * tmp4)>>16) * tmp5 / pow_tmp3)>>32;  //16bit float
		}
		else
		{
			div_tmp1 = div64_s64(tmp * tmp1 , pow_float_fix(65535,((*m_n-65536)&0xffff),16,1));
			div_tmp2 = div64_s64((( div_tmp1* tmp4)>>32) * tmp5 , pow_tmp3);
			tMB_0_2=div_tmp2>>32;  //16bit float
			//tMB_0_2=(((tmp * tmp1 / pow_float_fix(65535,((*m_n-65536)&0xffff),16,1) * tmp4)>>32) * tmp5 / pow_tmp3)>>32;  //16bit float
		}

		GD1=tMB_0_2; //16bit float
		
		if((spline_TH_mode==1||spline_TH_mode==2) && VA3==tTH3_2 && (base_param_Delta_mode!=2&&base_param_Delta_mode!=3&&base_param_Delta_mode!=6))
			GD3=65536; //=1
		if(spline_TH_mode==1)
		{
			TH_str=spline_Strength1; //16bit float

			up_T1=div64_s64(((VA3-(VA1))<<16),(tTH3_2-tTH2_2)); //16bit float
			//up_T1=((VA3-(VA1))<<16)/(tTH3_2-tTH2_2); //16bit float
			mid_T=div64_s64(((VA3-(VA1))<<16),(tTH3_2-(tTH1_2<<16))); //16bit float
			//mid_T=((VA3-(VA1))<<16)/(tTH3_2-(tTH1_2<<16)); //16bit float
			down_T1=div64_s64((VA3-(VA1))*6553,(tTH3_2-(tTH1_2<<16))); //*6553 = *0.1<<16 ; //16bit float
			//down_T1=(VA3-(VA1))*6553/(tTH3_2-(tTH1_2<<16)); //*6553 = *0.1<<16 ; //16bit float
			down_T=down_T1<GD1? GD1:down_T1; //16bit float
			up_T=up_T1<GD1? GD1:up_T1; //16bit float
			
			if(TH_str<0)
				GD3=(down_T*(-TH_str) + mid_T*(65536+TH_str))>>16; //16bit float
			else
				GD3=(up_T*TH_str + mid_T*(65536-TH_str))>>16; //16bit float
		} 
		else
		{
			/*tmp=((((((*m_a)*(*m_m)*(*m_p))>>16)*(*K3))>>16)*(*m_n))>>32; //16bit float
			tmp1=pow_float_fix((tTH3_2>>16),(*m_n-65535),16); // need /pow_float_fix(65535,(*m_n-65535),16)
			tmp2=(*m_p)*pow_float_fix((tTH3_2>>16),(*m_n),16)/pow_float_fix(65535,(*m_n),16); //16bit float
			tmp3=((((*K1)*(*m_p))>>16)-(*K2)) * pow_float_fix((tTH3_2>>16),(*m_n),16) / pow_float_fix(65535,(*m_n),16) + (*K3); //16bit float
			tmp4=pow_float_fix((tmp2<<16)/tmp3,(*m_m+65535),16); // need /pow_float_fix(65535,(*m_m+65535),16)
			tmp5=pow_float_fix(((65535<<16)/(pow_float_fix((tTH3_2>>16),(*m_n),16)*(*m_p)/pow_float_fix(65535,(*m_n),16))),131070,16); // need /pow_float_fix(65535,131070,16)

			GD2=tmp*tmp1/pow_float_fix(65535,(*m_n-65535),16)*tmp4/pow_float_fix(65535,(*m_m+65535),16)*tmp5/pow_float_fix(65535,131070,16); //16bit float*/
			//GD2=(*m_a)*(*m_m)*(*m_p)*(*K3)*(*m_n)*pow(tTH3_2,(*m_n-1)) * (pow((((*m_p)*pow(tTH3_2,(*m_n)))/(((*K1)*(*m_p)-(*K2))*pow(tTH3_2,(*m_n))+(*K3))),(*m_m+1))) * (pow((1.0/(pow(tTH3_2,(*m_n))*(*m_p))),2));

	
			tmp=((((((*m_a)*(*m_m)*(*m_p))>>16)*(*K3))>>16)*(*m_n))>>32; //16bit float
			tmp1=pow_float_fix((tTH3_2>>16),(*m_n-65535),16,0); // need /pow_float_fix(65535,((*m_n-65535)&0xffff),16)
			tmp2=div64_s64((*m_p)*pow_tmp1,pow_tmp_9323_1); //16bit float
			//tmp2=((*m_p)*pow_tmp1/pow_tmp_9323_1); //16bit float
			div_tmp1 = div64_s64(((((*K1)*(*m_p))>>16)-(*K2)) * pow_tmp1 , pow_tmp_9323_1);
			tmp3=(div_tmp1>>16) + (*K3); //16bit float
			//tmp3=((((((*K1)*(*m_p))>>16)-(*K2)) * pow_tmp1 / pow_tmp_9323_1)>>16) + (*K3); //16bit float
			div_tmp1 = div64_s64(tmp2,tmp3);
			tmp4=div64_s64(pow_float_fix(div_tmp1,(*m_m+65535),16,0),pow_tmp2); // need /pow_float_fix(65535,(*m_m+65535),16) ; 16bit
			//tmp4=pow_float_fix((tmp2)/tmp3,(*m_m+65535),16,0)/pow_tmp2; // need /pow_float_fix(65535,(*m_m+65535),16) ; 16bit
			tmp5=div64_s64(pow_tmp1 * (*m_p) , pow_tmp_9323_1);
			//tmp5=(pow_tmp1 * (*m_p) / pow_tmp_9323_1);
			div_tmp1 = div64_s64(4294967296,(tmp5>>16));
			tmp6=pow_float_fix(div_tmp1,131072,16,0);
			//tmp6=pow_float_fix(((4294967296)/(tmp5>>16)),131072,16,0);
			div_tmp1 = div64_s64(tmp * tmp1 , pow_float_fix(65535,((*m_n-65535)&0xffff),16,1) );
			div_tmp2 = div64_s64(((div_tmp1* tmp4)>>32) * tmp6 , pow_tmp3);
			GD2=div_tmp2>>32;  //16bit float
			//GD2=(((tmp * tmp1 / pow_float_fix(65535,((*m_n-65535)&0xffff),16,1) * tmp4)>>32) * tmp6 / pow_tmp3)>>32;  //16bit float

			if(spline_TH_mode==2)
				GD3=GD2-spline_TH_MB_2; //16bit float
			else if(spline_TH_mode==3)
				GD3=GD2; //16bit float
		}
		
		
		DTH2=(tTH2_2-(tTH1_2<<16))>>16; //16bit float
		DTH3=(tTH3_2-tTH2_2)>>16; //16bit float
		h1=DTH2; //16bit float
		h2=DTH3; //16bit float
		// calculate MB_1_1, MC_0_1, MD_0_1, MC_1_1, MD_1_1
		/*tMB_1_2 = -(3.0*VA1*h2*h2 + 3.0*VA2*h1*h1 - 3.0*VA3*h1*h1 - 3.0*h2*h2*VA2 + h1*h1*h2*GD3 + GD1*h1*h2*h2)/(2.0*h2*(h1*h1 + h2*h1));
		tMC_0_2 = (3.0*VA2 - 2.0*GD1*h1 - 3.0*VA1 - tMB_1_2*h1)/(h1*h1);
		tMD_0_2 = (h1*GD1 + h1*tMB_1_2 + 2.0*VA1 - 2.0*VA2)/(h1*h1*h1);
		tMC_1_2 = tMC_0_2+ 3.0*tMD_0_2*h1;
		tMD_1_2 = -(VA3 - VA2 - h2*GD3 + tMC_0_2*h2*h2 + 3.0*tMD_0_2*h1*h2*h2)/(2.0*h2*h2*h2);*/

		tMB_1_2 = -div64_s64((((3*VA1*h2)>>16)*h2 + 3*((VA2*h1)>>16)*h1 - 3*((VA3*h1)>>16)*h1 - 3*h2*((h2*VA2)>>16) + ((h1*h1*h2)>>16)*GD3 + ((GD1*h1*h2)>>16)*h2),((2*h2*(h1*h1 + h2*h1))>>16)); //16bit float
		//tMB_1_2 = -((((3*VA1*h2)>>16)*h2 + 3*((VA2*h1)>>16)*h1 - 3*((VA3*h1)>>16)*h1 - 3*h2*((h2*VA2)>>16) + ((h1*h1*h2)>>16)*GD3 + ((GD1*h1*h2)>>16)*h2)/((2*h2*(h1*h1 + h2*h1))>>16)); //16bit float
		tMC_0_2 = div64_s64(((3*VA2 - 2*GD1*h1 - 3*(VA1) - tMB_1_2*h1)<<16),(h1*h1)); //16bit float
		tMD_0_2 = div64_s64(((h1*GD1 + h1*tMB_1_2 + 2*(VA1) - 2*VA2)<<16),((h1*h1*h1)>>16)); //16bit float
		tMC_1_2 = ((tMC_0_2<<16) + 3*tMD_0_2*h1)>>16; //16bit float
		tMD_1_2 = -div64_s64(((((VA3 - VA2 - h2*GD3)<<16) + tMC_0_2*h2*h2 + (3*((tMD_0_2*h1*h2)>>16)*h2))<<14),((2*h2*h2*h2)>>2)); //16bit float

		// assign tmp calculation result to the output pointer
		*TH1_2=tTH1_2; //16bit float
		*TH2_2=tTH2_2>>16; //16bit float
		*TH3_2=tTH3_2>>16; //16bit float
		*MA_0_2=tMA_0_2;
		*MB_0_2=tMB_0_2;
		*MC_0_2=tMC_0_2;
		*MD_0_2=tMD_0_2;
		*MA_1_2=tMA_1_2>>16;//16bit float
		*MB_1_2=tMB_1_2;
		*MC_1_2=tMC_1_2;
		*MD_1_2=tMD_1_2;
	}
}

//#endif
void drvif_fwif_color_ScalerVIP_set_HDR10_vivid_metadata2reg_frameSync(int display_Brightness, _RPC_system_setting_info *RPC_sys_info, VIP_HDR10_vivid_CTRL* HDR10_vivi_CTRL)
{
#if CUVA_FW_TEST_ON_FPGA
	dm_hdr_path_sel_RBUS dm_hdr_path_sel_reg;
#endif
	static unsigned char CNT = 0;
	HDR_VIVID_Metadata *pMT;

	unsigned char Debug_Log=0, Debug_log_delay=0;
	/* 9.2 base curve*/
	long long m_p,m_a,m_m,m_n,m_b,K1,K2,K3;
	long long m_p_0, m_a_0, m_m_0, m_n_0, m_b_0, K1_0, K2_0, K3_0;
	unsigned char spline_enable_num;
	/* 9.2.3 calculate max_lum */
	long long A=26214,B=13107; // 16bit float
	long long MAX1;
	/* 9.3 - 3spline */
	long long TH3_0, MB_0, base_offset;
	long long TH1_1, TH2_1, TH3_1, MA_0_1, MB_0_1, MC_0_1, MD_0_1, MA_1_1, MB_1_1, MC_1_1, MD_1_1;
	long long TH1_2=0, TH2_2=0, TH3_2=0, MA_0_2=0, MB_0_2=0, MC_0_2=0, MD_0_2=0, MA_1_2=0, MB_1_2=0, MC_1_2=0, MD_1_2=0;
	/* 9.4 tone mapping */
	int px,i;
	long long max;
	long long debug_tmp=0,debug_tmp2=0;
	long long tm_r,tm_g,tm_b;
	long long BASEH,MBH,H1;
	long long L1,L2;
	long long max_Tm;
	long long K,kmax;
	long long color_r,color_g,color_b;
	long long C0,C1;
	long long tm_r_PQ,tm_g_PQ,tm_b_PQ;

	long long max_TM_PQ=0;
	long long TML,RML,TML_TM;
	long long Sca,SatR,M,A_color,B_color;


	long long color_saturation_gain0; //16bit float
	long long color_saturation_gain1; //16bit float
	/* gen 1DLUT1  */
	//long long pre_Eo=0, yout_new;
	//int work_around=0;
	//unsigned int y_lut1[1025]={0};
	long long y_idx;
	long long tmp,tmp1,tmp2,div_tmp1,div_tmp2;
	/*gen EOTF_out_curve*/
	long long EOTF_input=0;
	long long EOTF_tmp=0;
	long long EOTF_tmp2=0;
	
	/* shift_bit need to be set to the BBCGain register */
	unsigned char shift_bit=0;

	if (HDR10_vivi_CTRL->Enable != 1 || HDR10_vivi_CTRL->update_DMA_Flag == 1)
		return;

	CNT++;
	
	Debug_Log = HDR10_vivi_CTRL->Debug_Log;
	Debug_log_delay = HDR10_vivi_CTRL->Debug_Delay;

	pMT = drvif_fwif_color_Get_HDR10_vivid_METADATA_Buff();
																								
	pMT->system_start_code										=		 RPC_sys_info->HDR_info.hdr_VIVID_Metadata.system_start_code                                          ;
	pMT->minimum_maxrgb_pq[0]                                  =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata.minimum_maxrgb_pq[0], 1)                                       ;
	pMT->average_maxrgb_pq[0]                                  =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata.average_maxrgb_pq[0], 1)                                       ;
	pMT->variance_maxrgb_pq[0]                                 =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata.variance_maxrgb_pq[0], 1)                                      ;
	pMT->maximum_maxrgb_pq[0]                                  =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata.maximum_maxrgb_pq[0], 1)                                       ;
	pMT->tone_mapping_enable_mode_flag[0]                      =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.tone_mapping_enable_mode_flag[0]                           ;
	pMT->tone_mapping_param_enable_num[0]                      =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.tone_mapping_param_enable_num[0]                           ;
	pMT->targeted_system_display_maximum_luminance_pq[0][0]    =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata.targeted_system_display_maximum_luminance_pq[0][0], 1)         ;
	pMT->targeted_system_display_maximum_luminance_pq[1][0]    =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata.targeted_system_display_maximum_luminance_pq[1][0], 1)         ;
	pMT->base_enable_flag[0][0]                                =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_enable_flag[0][0]                                     ;
	pMT->base_enable_flag[1][0]                                =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_enable_flag[1][0]                                     ;
	pMT->base_param_m_p[0][0]                                  =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_m_p[0][0], 1)                                       ;
	pMT->base_param_m_p[1][0]                                  =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_m_p[1][0], 1)                                       ;
	pMT->base_param_m_m[0][0]                                  =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_m_m[0][0]                                       ;
	pMT->base_param_m_m[1][0]                                  =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_m_m[1][0]                                       ;
	pMT->base_param_m_a[0][0]                                  =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_m_a[0][0], 1)                                       ;
	pMT->base_param_m_a[1][0]                                  =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_m_a[1][0], 1)                                       ;
	pMT->base_param_m_b[0][0]                                  =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_m_b[0][0], 1)                                       ;
	pMT->base_param_m_b[1][0]                                  =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_m_b[1][0], 1)                                       ;
	pMT->base_param_m_n[0][0]                                  =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_m_n[0][0]                                       ;
	pMT->base_param_m_n[1][0]                                  =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_m_n[1][0]                                       ;
	pMT->base_param_K1[0][0]                                   =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_K1[0][0]                                        ;
	pMT->base_param_K1[1][0]                                   =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_K1[1][0]                                        ;
	pMT->base_param_K2[0][0]                                   =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_K2[0][0]                                        ;
	pMT->base_param_K2[1][0]                                   =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_K2[1][0]                                        ;
	pMT->base_param_K3[0][0]                                   =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_K3[0][0]                                        ;
	pMT->base_param_K3[1][0]                                   =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_K3[1][0]                                        ;
	pMT->base_param_Delta_enable_mode[0][0]                    =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_Delta_enable_mode[0][0]                         ;
	pMT->base_param_Delta_enable_mode[1][0]                    =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_Delta_enable_mode[1][0]                         ;
	pMT->base_param_enable_Delta[0][0]                         =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_enable_Delta[0][0]                              ;
	pMT->base_param_enable_Delta[1][0]                         =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.base_param_enable_Delta[1][0]                              ;
	pMT->_3Spline_enable_flag[0][0]                            =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_enable_flag[0][0]                                 ;
	pMT->_3Spline_enable_flag[1][0]                            =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_enable_flag[1][0]                                 ;
	pMT->_3Spline_enable_num[0][0]                             =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_enable_num[0][0]                                  ;
	pMT->_3Spline_enable_num[1][0]                             =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_enable_num[1][0]                                  ;
	pMT->_3Spline_TH_enable_mode[0][0][0]                      =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_mode[0][0][0]                           ;
	pMT->_3Spline_TH_enable_mode[0][1][0]                      =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_mode[0][1][0]                           ;
	pMT->_3Spline_TH_enable_mode[1][0][0]                      =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_mode[1][0][0]                           ;
	pMT->_3Spline_TH_enable_mode[1][1][0]                      =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_mode[1][1][0]                           ;
	pMT->_3Spline_TH_enable_MB[0][0][0]                        =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_MB[0][0][0]                             ;
	pMT->_3Spline_TH_enable_MB[0][1][0]                        =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_MB[0][1][0]                             ;
	pMT->_3Spline_TH_enable_MB[1][0][0]                        =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_MB[1][0][0]                             ;
	pMT->_3Spline_TH_enable_MB[1][1][0]                        =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_MB[1][1][0]                             ;
	pMT->_3Spline_TH_enable[0][0][0]                           =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable[0][0][0], 1)                                ;
	pMT->_3Spline_TH_enable[0][1][0]                           =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable[0][1][0], 1)                                ;
	pMT->_3Spline_TH_enable[1][0][0]                           =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable[1][0][0], 1)                                ;
	pMT->_3Spline_TH_enable[1][1][0]                           =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable[1][1][0], 1)                               ;
	pMT->_3Spline_TH_enable_Delta1[0][0][0]                    =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_Delta1[0][0][0], 1)                        ;
	pMT->_3Spline_TH_enable_Delta1[0][1][0]                    =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_Delta1[0][1][0], 1)                        ;
	pMT->_3Spline_TH_enable_Delta1[1][0][0]                    =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_Delta1[1][0][0], 1)                         ;
	pMT->_3Spline_TH_enable_Delta1[1][1][0]                    =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_Delta1[1][1][0], 1)                        ;
	pMT->_3Spline_TH_enable_Delta2[0][0][0]                    =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_Delta2[0][0][0], 1)                        ;
	pMT->_3Spline_TH_enable_Delta2[0][1][0]                    =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_Delta2[0][1][0], 1)                         ;
	pMT->_3Spline_TH_enable_Delta2[1][0][0]                    =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_Delta2[1][0][0], 1)                         ;
	pMT->_3Spline_TH_enable_Delta2[1][1][0]                    =        fwif_color_ChangeOneUINT16Endian(RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_TH_enable_Delta2[1][1][0], 1)                         ;
	pMT->_3Spline_enable_Strength[0][0][0]                     =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_enable_Strength[0][0][0]                          ;
	pMT->_3Spline_enable_Strength[0][1][0]                     =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_enable_Strength[0][1][0]                          ;
	pMT->_3Spline_enable_Strength[1][0][0]                     =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_enable_Strength[1][0][0]                          ;
	pMT->_3Spline_enable_Strength[1][1][0]                     =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata._3Spline_enable_Strength[1][1][0]                          ;
	pMT->color_saturation_mapping_enable_flag[0]               =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.color_saturation_mapping_enable_flag[0]                    ;
	pMT->color_saturation_enable_num[0]                        =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.color_saturation_enable_num[0]                             ;
	pMT->color_saturation_enable_gain[0][0]                    =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.color_saturation_enable_gain[0][0]                         ;
	pMT->color_saturation_enable_gain[1][0]                    =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.color_saturation_enable_gain[1][0]                         ;
	pMT->color_saturation_enable_gain[2][0]                    =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.color_saturation_enable_gain[2][0]                         ;
	pMT->color_saturation_enable_gain[3][0]                    =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.color_saturation_enable_gain[3][0]                         ;
	pMT->color_saturation_enable_gain[4][0]                    =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.color_saturation_enable_gain[4][0]                         ;
	pMT->color_saturation_enable_gain[5][0]                    =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.color_saturation_enable_gain[5][0]                         ;
	pMT->color_saturation_enable_gain[6][0]                    =        RPC_sys_info->HDR_info.hdr_VIVID_Metadata.color_saturation_enable_gain[6][0]                         ;

#if CUVA_FW_TEST_ON_FPGA
/* //frame 1727
	pMT->system_start_code										=		 1                                          ;
	pMT->minimum_maxrgb_pq[0]                                  =      0  ;
	pMT->average_maxrgb_pq[0]                                  =        1954;
	pMT->variance_maxrgb_pq[0]                                 =       2331;
	pMT->maximum_maxrgb_pq[0]                                  =        3120                             ;
	pMT->tone_mapping_enable_mode_flag[0]                      =        1;
	pMT->tone_mapping_param_enable_num[0]                      =        0;
	pMT->targeted_system_display_maximum_luminance_pq[0][0]    =        2770         ;
	pMT->targeted_system_display_maximum_luminance_pq[1][0]    =        0         ;
	pMT->base_enable_flag[0][0]                                =        1;
	pMT->base_enable_flag[1][0]                                =        0;
	pMT->base_param_m_p[0][0]                                  =        7372 ;
	pMT->base_param_m_p[1][0]                                  =        0;
	pMT->base_param_m_m[0][0]                                  =        24;
	pMT->base_param_m_m[1][0]                                  =        0;
	pMT->base_param_m_a[0][0]                                  =        736;
	pMT->base_param_m_a[1][0]                                  =        0;
	pMT->base_param_m_b[0][0]                                  =      178;
	pMT->base_param_m_b[1][0]                                  =        0;
	pMT->base_param_m_n[0][0]                                  =        10;
	pMT->base_param_m_n[1][0]                                  =        0;
	pMT->base_param_K1[0][0]                                   =        1;
	pMT->base_param_K1[1][0]                                   =        0                                  ;
	pMT->base_param_K2[0][0]                                   =        1                                       ;
	pMT->base_param_K2[1][0]                                   =        0                                ;
	pMT->base_param_K3[0][0]                                   =        1                                 ;
	pMT->base_param_K3[1][0]                                   =        0                                     ;
	pMT->base_param_Delta_enable_mode[0][0]                    =        6          ;
	pMT->base_param_Delta_enable_mode[1][0]                    =        0    ;
	pMT->base_param_enable_Delta[0][0]                         =        6 ;
	pMT->base_param_enable_Delta[1][0]                         =        0                              ;
	pMT->_3Spline_enable_flag[0][0]                            =        1;
	pMT->_3Spline_enable_flag[1][0]                            =        0;
	pMT->_3Spline_enable_num[0][0]                             =        1                              ;
	pMT->_3Spline_enable_num[1][0]                             =        0                                 ;
	pMT->_3Spline_TH_enable_mode[0][0][0]                      =        0;
	pMT->_3Spline_TH_enable_mode[0][1][0]                      =        0                           ;
	pMT->_3Spline_TH_enable_mode[1][0][0]                      =        2;
	pMT->_3Spline_TH_enable_mode[1][1][0]                      =        0                           ;
	pMT->_3Spline_TH_enable_MB[0][0][0]                        =        240      ;
	pMT->_3Spline_TH_enable_MB[0][1][0]                        =        0                            ;
	pMT->_3Spline_TH_enable_MB[1][0][0]                        =        0                          ;
	pMT->_3Spline_TH_enable_MB[1][1][0]                        =        0                            ;
	pMT->_3Spline_TH_enable[0][0][0]                           =        532                                ;
	pMT->_3Spline_TH_enable[0][1][0]                           =        0                                ;
	pMT->_3Spline_TH_enable[1][0][0]                           =        1965                               ;
	pMT->_3Spline_TH_enable[1][1][0]                           =        0                             ;
	pMT->_3Spline_TH_enable_Delta1[0][0][0]                    =        613                        ;
	pMT->_3Spline_TH_enable_Delta1[0][1][0]                    =        0                        ;
	pMT->_3Spline_TH_enable_Delta1[1][0][0]                    =        570                        ;
	pMT->_3Spline_TH_enable_Delta1[1][1][0]                    =        0                       ;
	pMT->_3Spline_TH_enable_Delta2[0][0][0]                    =        695                        ;
	pMT->_3Spline_TH_enable_Delta2[0][1][0]                    =        0                        ;
	pMT->_3Spline_TH_enable_Delta2[1][0][0]                    =        570                         ;
	pMT->_3Spline_TH_enable_Delta2[1][1][0]                    =        0                        ;
	pMT->_3Spline_enable_Strength[0][0][0]                     =        126                         ;
	pMT->_3Spline_enable_Strength[0][1][0]                     =        0                          ;
	pMT->_3Spline_enable_Strength[1][0][0]                     =        141                          ;
	pMT->_3Spline_enable_Strength[1][1][0]                     =        0                          ;
	pMT->color_saturation_mapping_enable_flag[0]               =        1                   ;
	pMT->color_saturation_enable_num[0]                        =        2                             ;
	pMT->color_saturation_enable_gain[0][0]                    =        38                     ;
	pMT->color_saturation_enable_gain[1][0]                    =        24                         ;
	pMT->color_saturation_enable_gain[2][0]                    =        0                         ;
	pMT->color_saturation_enable_gain[3][0]                    =        0                         ;
	pMT->color_saturation_enable_gain[4][0]                    =       0                        ;
	pMT->color_saturation_enable_gain[5][0]                    =        0                       ;
	pMT->color_saturation_enable_gain[6][0]                    =              0                 ;
*/
/*  //frame 103
	pMT->system_start_code										=		 1                                          ;
	pMT->minimum_maxrgb_pq[0]                                  =      50  ;
	pMT->average_maxrgb_pq[0]                                  =        2400;
	pMT->variance_maxrgb_pq[0]                                 =       2467;
	pMT->maximum_maxrgb_pq[0]                                  =        3631                             ;
	pMT->tone_mapping_enable_mode_flag[0]                      =        1;
	pMT->tone_mapping_param_enable_num[0]                      =        1;
	pMT->targeted_system_display_maximum_luminance_pq[0][0]    =        2770         ;
	pMT->targeted_system_display_maximum_luminance_pq[1][0]    =        2080         ;
	pMT->base_enable_flag[0][0]                                =        1;
	pMT->base_enable_flag[1][0]                                =        0;
	pMT->base_param_m_p[0][0]                                  =        7065 ;
	pMT->base_param_m_p[1][0]                                  =        0;
	pMT->base_param_m_m[0][0]                                  =        24;
	pMT->base_param_m_m[1][0]                                  =        0;
	pMT->base_param_m_a[0][0]                                  =        745;
	pMT->base_param_m_a[1][0]                                  =        0;
	pMT->base_param_m_b[0][0]                                  =      0;
	pMT->base_param_m_b[1][0]                                  =        0;
	pMT->base_param_m_n[0][0]                                  =        10;
	pMT->base_param_m_n[1][0]                                  =        0;
	pMT->base_param_K1[0][0]                                   =        1;
	pMT->base_param_K1[1][0]                                   =        0                                  ;
	pMT->base_param_K2[0][0]                                   =        1                                       ;
	pMT->base_param_K2[1][0]                                   =        0                                ;
	pMT->base_param_K3[0][0]                                   =        1                                 ;
	pMT->base_param_K3[1][0]                                   =        0                                     ;
	pMT->base_param_Delta_enable_mode[0][0]                    =        1          ;
	pMT->base_param_Delta_enable_mode[1][0]                    =        0    ;
	pMT->base_param_enable_Delta[0][0]                         =        0 ;
	pMT->base_param_enable_Delta[1][0]                         =        0                              ;
	pMT->_3Spline_enable_flag[0][0]                            =        0;
	pMT->_3Spline_enable_flag[1][0]                            =        1;
	pMT->_3Spline_enable_num[0][0]                             =        0                              ;
	pMT->_3Spline_enable_num[1][0]                             =        0                                 ;
	pMT->_3Spline_TH_enable_mode[0][0][0]                      =        0;
	pMT->_3Spline_TH_enable_mode[0][1][0]                      =        1                           ;
	pMT->_3Spline_TH_enable_mode[1][0][0]                      =        0;
	pMT->_3Spline_TH_enable_mode[1][1][0]                      =        0                           ;
	pMT->_3Spline_TH_enable_MB[0][0][0]                        =        0      ;
	pMT->_3Spline_TH_enable_MB[0][1][0]                        =        0                            ;
	pMT->_3Spline_TH_enable_MB[1][0][0]                        =        0                          ;
	pMT->_3Spline_TH_enable_MB[1][1][0]                        =        0                            ;
	pMT->_3Spline_TH_enable[0][0][0]                           =        0                                ;
	pMT->_3Spline_TH_enable[0][1][0]                           =        3069                                ;
	pMT->_3Spline_TH_enable[1][0][0]                           =        0                               ;
	pMT->_3Spline_TH_enable[1][1][0]                           =        0                             ;
	pMT->_3Spline_TH_enable_Delta1[0][0][0]                    =        0                        ;
	pMT->_3Spline_TH_enable_Delta1[0][1][0]                    =        421                        ;
	pMT->_3Spline_TH_enable_Delta1[1][0][0]                    =        0                        ;
	pMT->_3Spline_TH_enable_Delta1[1][1][0]                    =        0                       ;
	pMT->_3Spline_TH_enable_Delta2[0][0][0]                    =        0                        ;
	pMT->_3Spline_TH_enable_Delta2[0][1][0]                    =        140                        ;
	pMT->_3Spline_TH_enable_Delta2[1][0][0]                    =        0                         ;
	pMT->_3Spline_TH_enable_Delta2[1][1][0]                    =        0                        ;
	pMT->_3Spline_enable_Strength[0][0][0]                     =        0                         ;
	pMT->_3Spline_enable_Strength[0][1][0]                     =        127                          ;
	pMT->_3Spline_enable_Strength[1][0][0]                     =        0                          ;
	pMT->_3Spline_enable_Strength[1][1][0]                     =        0                          ;
	pMT->color_saturation_mapping_enable_flag[0]               =        1                   ;
	pMT->color_saturation_enable_num[0]                        =        2                             ;
	pMT->color_saturation_enable_gain[0][0]                    =        38                     ;
	pMT->color_saturation_enable_gain[1][0]                    =        25                         ;
	pMT->color_saturation_enable_gain[2][0]                    =        0                         ;
	pMT->color_saturation_enable_gain[3][0]                    =        0                         ;
	pMT->color_saturation_enable_gain[4][0]                    =       0                        ;
	pMT->color_saturation_enable_gain[5][0]                    =        0                       ;
	pMT->color_saturation_enable_gain[6][0]                    =              0                 ;
	*/
  //test scene4
	pMT->system_start_code										=		 1                                          ;
	pMT->minimum_maxrgb_pq[0]                                  =      0  ;
	pMT->average_maxrgb_pq[0]                                  =        1893;
	pMT->variance_maxrgb_pq[0]                                 =       4055;
	pMT->maximum_maxrgb_pq[0]                                  =        4094                             ;
	pMT->tone_mapping_enable_mode_flag[0]                      =        1;
	pMT->tone_mapping_param_enable_num[0]                      =        1;
	pMT->targeted_system_display_maximum_luminance_pq[0][0]    =        2770         ;
	pMT->targeted_system_display_maximum_luminance_pq[1][0]    =        2080         ;
	pMT->base_enable_flag[0][0]                                =        1;
	pMT->base_enable_flag[1][0]                                =        0;
	pMT->base_param_m_p[0][0]                                  =        9241 ;
	pMT->base_param_m_p[1][0]                                  =        0;
	pMT->base_param_m_m[0][0]                                  =        24;
	pMT->base_param_m_m[1][0]                                  =        0;
	pMT->base_param_m_a[0][0]                                  =        750;
	pMT->base_param_m_a[1][0]                                  =        0;
	pMT->base_param_m_b[0][0]                                  =      0;
	pMT->base_param_m_b[1][0]                                  =        0;
	pMT->base_param_m_n[0][0]                                  =        10;
	pMT->base_param_m_n[1][0]                                  =        0;
	pMT->base_param_K1[0][0]                                   =        1;
	pMT->base_param_K1[1][0]                                   =        0                                  ;
	pMT->base_param_K2[0][0]                                   =        1                                       ;
	pMT->base_param_K2[1][0]                                   =        0                                ;
	pMT->base_param_K3[0][0]                                   =        1                                 ;
	pMT->base_param_K3[1][0]                                   =        0                                     ;
	pMT->base_param_Delta_enable_mode[0][0]                    =        6          ;
	pMT->base_param_Delta_enable_mode[1][0]                    =        0    ;
	pMT->base_param_enable_Delta[0][0]                         =        16 ;
	pMT->base_param_enable_Delta[1][0]                         =        0                              ;
	pMT->_3Spline_enable_flag[0][0]                            =        1;
	pMT->_3Spline_enable_flag[1][0]                            =        1;
	pMT->_3Spline_enable_num[0][0]                             =        1                              ;
	pMT->_3Spline_enable_num[1][0]                             =        0                                 ;
	pMT->_3Spline_TH_enable_mode[0][0][0]                      =        0;
	pMT->_3Spline_TH_enable_mode[0][1][0]                      =        1                           ;
	pMT->_3Spline_TH_enable_mode[1][0][0]                      =        0;
	pMT->_3Spline_TH_enable_mode[1][1][0]                      =        0                           ;
	pMT->_3Spline_TH_enable_MB[0][0][0]                        =        224      ;
	pMT->_3Spline_TH_enable_MB[0][1][0]                        =        0                            ;
	pMT->_3Spline_TH_enable_MB[1][0][0]                        =        0                          ;
	pMT->_3Spline_TH_enable_MB[1][1][0]                        =        0                            ;
	pMT->_3Spline_TH_enable[0][0][0]                           =        368;
	pMT->_3Spline_TH_enable[0][1][0]                           =        2715                                ;
	pMT->_3Spline_TH_enable[1][0][0]                           =        0                               ;
	pMT->_3Spline_TH_enable[1][1][0]                           =        0                             ;
	pMT->_3Spline_TH_enable_Delta1[0][0][0]                    =        267                        ;
	pMT->_3Spline_TH_enable_Delta1[0][1][0]                    =        0                        ;
	pMT->_3Spline_TH_enable_Delta1[1][0][0]                    =        613                        ;
	pMT->_3Spline_TH_enable_Delta1[1][1][0]                    =        0                       ;
	pMT->_3Spline_TH_enable_Delta2[0][0][0]                    =        534                        ;
	pMT->_3Spline_TH_enable_Delta2[0][1][0]                    =        0                        ;
	pMT->_3Spline_TH_enable_Delta2[1][0][0]                    =        613                         ;
	pMT->_3Spline_TH_enable_Delta2[1][1][0]                    =        0                        ;
	pMT->_3Spline_enable_Strength[0][0][0]                     =        127                         ;
	pMT->_3Spline_enable_Strength[0][1][0]                     =        0                          ;
	pMT->_3Spline_enable_Strength[1][0][0]                     =        165                          ;
	pMT->_3Spline_enable_Strength[1][1][0]                     =        0                          ;
	pMT->color_saturation_mapping_enable_flag[0]               =        1                   ;
	pMT->color_saturation_enable_num[0]                        =        2                             ;
	pMT->color_saturation_enable_gain[0][0]                    =        38                     ;
	pMT->color_saturation_enable_gain[1][0]                    =        25                         ;
	pMT->color_saturation_enable_gain[2][0]                    =        0                         ;
	pMT->color_saturation_enable_gain[3][0]                    =        0                         ;
	pMT->color_saturation_enable_gain[4][0]                    =       0                        ;
	pMT->color_saturation_enable_gain[5][0]                    =        0                       ;
	pMT->color_saturation_enable_gain[6][0]                    =              0                 ;
#endif

#if 1	/** for debug */
		if((Debug_Log&_BIT1)!=0) {
			if (CNT >= Debug_log_delay) {
				//CNT = 0;
				rtd_printk(KERN_INFO,"HDR10_vivid", "system_start_code=%d, minimum_maxrgb_pq[0]=%d, average_maxrgb_pq[0]=%d,\n", pMT->system_start_code, pMT->minimum_maxrgb_pq[0], pMT->average_maxrgb_pq[0]);								 
				rtd_printk(KERN_INFO,"HDR10_vivid", "variance_maxrgb_pq[0]=%d, maximum_maxrgb_pq[0]=%d, tone_mapping_enable_mode_flag[0]=%d,\n", pMT->variance_maxrgb_pq[0], pMT->maximum_maxrgb_pq[0], pMT->tone_mapping_enable_mode_flag[0]);					 
				rtd_printk(KERN_INFO,"HDR10_vivid", "tone_mapping_param_enable_num[0]=%d, targeted_system_display_maximum_luminance_pq[0][0]=%d, targeted_system_display_maximum_luminance_pq[1][0]=%d,\n", pMT->tone_mapping_param_enable_num[0], pMT->targeted_system_display_maximum_luminance_pq[0][0], pMT->targeted_system_display_maximum_luminance_pq[1][0]);	 
				rtd_printk(KERN_INFO,"HDR10_vivid", "base_enable_flag[0][0]=%d, base_enable_flag[1][0]=%d, base_param_m_p[0][0]=%d, base_param_m_p[1][0]=%d,\n", pMT->base_enable_flag[0][0], pMT->base_enable_flag[1][0], pMT->base_param_m_p[0][0], pMT->base_param_m_p[1][0]);								 
				rtd_printk(KERN_INFO,"HDR10_vivid", "base_param_m_m[0][0]=%d, base_param_m_m[1][0]=%d, base_param_m_a[0][0]=%d, base_param_m_a[1][0]=%d,\n", pMT->base_param_m_m[0][0], pMT->base_param_m_m[1][0], pMT->base_param_m_a[0][0], pMT->base_param_m_a[1][0]);								 
				rtd_printk(KERN_INFO,"HDR10_vivid", "base_param_m_b[0][0]=%d, base_param_m_b[1][0]=%d, base_param_m_n[0][0]=%d, base_param_m_n[1][0]=%d,\n", pMT->base_param_m_b[0][0], pMT->base_param_m_b[1][0], pMT->base_param_m_n[0][0], pMT->base_param_m_n[1][0]);								 
				rtd_printk(KERN_INFO,"HDR10_vivid", "base_param_K1[0][0]=%d, base_param_K1[1][0]=%d, base_param_K2[0][0]=%d, base_param_K2[1][0]=%d,\n", pMT->base_param_K1[0][0], pMT->base_param_K1[1][0], pMT->base_param_K2[0][0], pMT->base_param_K2[1][0]);								   
				rtd_printk(KERN_INFO,"HDR10_vivid", "base_param_K3[0][0]=%d, base_param_K3[1][0]=%d, base_param_Delta_enable_mode[0][0]=%d,\n", pMT->base_param_K3[0][0], pMT->base_param_K3[1][0], pMT->base_param_Delta_enable_mode[0][0]);					  
				rtd_printk(KERN_INFO,"HDR10_vivid", "base_param_Delta_enable_mode[1][0]=%d, base_param_enable_Delta[0][0]=%d, base_param_enable_Delta[1][0]=%d,\n", pMT->base_param_Delta_enable_mode[1][0], pMT->base_param_enable_Delta[0][0], pMT->base_param_enable_Delta[1][0]);						  
				rtd_printk(KERN_INFO,"HDR10_vivid", "_3Spline_enable_flag[0][0]=%d, _3Spline_enable_flag[1][0]=%d, _3Spline_enable_num[0][0]=%d, _3Spline_enable_num[1][0]=%d,\n", pMT->_3Spline_enable_flag[0][0], pMT->_3Spline_enable_flag[1][0], pMT->_3Spline_enable_num[0][0], pMT->_3Spline_enable_num[1][0]);							
				rtd_printk(KERN_INFO,"HDR10_vivid", "_3Spline_TH_enable_mode[0][0][0]=%d, _3Spline_TH_enable_mode[0][1][0]=%d, _3Spline_TH_enable_mode[1][0][0]=%d, _3Spline_TH_enable_mode[1][1][0]=%d,\n", pMT->_3Spline_TH_enable_mode[0][0][0], pMT->_3Spline_TH_enable_mode[0][1][0], pMT->_3Spline_TH_enable_mode[1][0][0], pMT->_3Spline_TH_enable_mode[1][1][0]);					  
				rtd_printk(KERN_INFO,"HDR10_vivid", "_3Spline_TH_enable_MB[0][0][0]=%d, _3Spline_TH_enable_MB[0][1][0]=%d, _3Spline_TH_enable_MB[1][0][0]=%d, _3Spline_TH_enable_MB[1][1][0]=%d,\n", pMT->_3Spline_TH_enable_MB[0][0][0], pMT->_3Spline_TH_enable_MB[0][1][0], pMT->_3Spline_TH_enable_MB[1][0][0], pMT->_3Spline_TH_enable_MB[1][1][0]);					   
				rtd_printk(KERN_INFO,"HDR10_vivid", "_3Spline_TH_enable[0][0][0]=%d, _3Spline_TH_enable[0][1][0]=%d, _3Spline_TH_enable[1][0][0]=%d, _3Spline_TH_enable[1][1][0]=%d,\n", pMT->_3Spline_TH_enable[0][0][0], pMT->_3Spline_TH_enable[0][1][0], pMT->_3Spline_TH_enable[1][0][0], pMT->_3Spline_TH_enable[1][1][0]);						   
				rtd_printk(KERN_INFO,"HDR10_vivid", "_3Spline_TH_enable_Delta1[0][0][0]=%d, _3Spline_TH_enable_Delta1[0][1][0]=%d, _3Spline_TH_enable_Delta1[1][0][0]=%d, _3Spline_TH_enable_Delta1[1][1][0]=%d,\n", pMT->_3Spline_TH_enable_Delta1[0][0][0], pMT->_3Spline_TH_enable_Delta1[0][1][0], pMT->_3Spline_TH_enable_Delta1[1][0][0], pMT->_3Spline_TH_enable_Delta1[1][1][0]);					
				rtd_printk(KERN_INFO,"HDR10_vivid", "_3Spline_TH_enable_Delta2[0][0][0]=%d, _3Spline_TH_enable_Delta2[0][1][0]=%d, _3Spline_TH_enable_Delta2[1][0][0]=%d, _3Spline_TH_enable_Delta2[1][1][0]=%d,\n", pMT->_3Spline_TH_enable_Delta2[0][0][0], pMT->_3Spline_TH_enable_Delta2[0][1][0], pMT->_3Spline_TH_enable_Delta2[1][0][0], pMT->_3Spline_TH_enable_Delta2[1][1][0]);				   
				rtd_printk(KERN_INFO,"HDR10_vivid", "_3Spline_enable_Strength[0][0][0]=%d, _3Spline_enable_Strength[0][1][0]=%d, _3Spline_enable_Strength[1][0][0]=%d, _3Spline_enable_Strength[1][1][0]=%d,\n", pMT->_3Spline_enable_Strength[0][0][0], pMT->_3Spline_enable_Strength[0][1][0], pMT->_3Spline_enable_Strength[1][0][0], pMT->_3Spline_enable_Strength[1][1][0]);					
				rtd_printk(KERN_INFO,"HDR10_vivid", "color_saturation_mapping_enable_flag[0]=%d, color_saturation_enable_num[0]=%d,\n", pMT->color_saturation_mapping_enable_flag[0], pMT->color_saturation_enable_num[0]);						 
				rtd_printk(KERN_INFO,"HDR10_vivid", "color_saturation_enable_gain[0][0]=%d, color_saturation_enable_gain[1][0]=%d, color_saturation_enable_gain[2][0]=%d, color_saturation_enable_gain[3][0]=%d,\n", pMT->color_saturation_enable_gain[0][0], pMT->color_saturation_enable_gain[1][0], pMT->color_saturation_enable_gain[2][0], pMT->color_saturation_enable_gain[3][0]);					
				rtd_printk(KERN_INFO,"HDR10_vivid", "color_saturation_enable_gain[4][0]=%d, color_saturation_enable_gain[5][0]=%d, color_saturation_enable_gain[6][0]=%d,\n", pMT->color_saturation_enable_gain[4][0], pMT->color_saturation_enable_gain[5][0], pMT->color_saturation_enable_gain[6][0]);					 
			}
		}
#endif
	
	/* HDR_CUVA process */
		if (HDR10_vivi_CTRL->Debug_Cal_skip_flag == 1)
			return;

		/* 9.2 base curve*/
		spline_enable_num=pMT->_3Spline_enable_num[0][0];
		// global variable 
		targeted_system_display_maximum_luminance=div64_s64(((long long)(pMT->targeted_system_display_maximum_luminance_pq[0][0])<<16),4095); // 16bit
		maximum_maxrgb=div64_s64(((long long)(pMT->maximum_maxrgb_pq[0])<<16),4095); //16bit float
		average_maxrgb=div64_s64(((long long)(pMT->average_maxrgb_pq[0])<<16),4095); //16bit float
		variance_maxrgb=div64_s64(((long long)(pMT->variance_maxrgb_pq[0])<<16),4095); //16bit float
		base_flag=pMT->base_enable_flag[0][0];
		base_param_Delta_mode=pMT->base_param_Delta_enable_mode[0][0];
		spline_flag=pMT->_3Spline_enable_flag[0][0];
		base_param_Delta=div64_s64(((long long)(pMT->base_param_enable_Delta[0][0])<<16),127); //16 bit float
		spline_TH_0 = div64_s64(((long long)(pMT->_3Spline_TH_enable[0][0][0])<<16),4095); //16bit float
		spline_TH_Delta1_0 = div64_s64(((long long)(pMT->_3Spline_TH_enable_Delta1[0][0][0])<<14),1023); //16bit float
		spline_TH_Delta2_0 = div64_s64(((long long)(pMT->_3Spline_TH_enable_Delta2[0][0][0])<<14),1023); //16bit float
		spline_TH_1 = div64_s64(((long long)(pMT->_3Spline_TH_enable[1][0][0])<<16),4095); //16bit float
		spline_TH_Delta1_1 = div64_s64(((long long)(pMT->_3Spline_TH_enable_Delta1[1][0][0])<<14),1023);//16bit float
		spline_TH_Delta2_1 = div64_s64(((long long)(pMT->_3Spline_TH_enable_Delta2[1][0][0])<<14),1023);//16bit float
		spline_Strength0 = div64_s64((2*(long long)(pMT->_3Spline_enable_Strength[0][0][0])<<16),255)-65536; //16bit float
		spline_Strength1 = div64_s64((2*(long long)(pMT->_3Spline_enable_Strength[1][0][0])<<16),255)-65536; //16bit float
		spline_TH_mode_1 = pMT->_3Spline_TH_enable_mode[1][0][0];
		m_p_0=div64_s64(((10*(long long)(pMT->base_param_m_p[0][0]) )<<16),16383); // 16bit float
		m_a_0=(long long)(pMT->base_param_m_a[0][0]); //10bit float -> >>10
		m_m_0=(long long)(pMT->base_param_m_m[0][0]); // 6bit -> /10
		m_n_0=(long long)(pMT->base_param_m_n[0][0]);//-> /10
		m_b_0=div64_s64(((long long)(pMT->base_param_m_b[0][0])<<14),1023);// 16bit float
		K1_0=(long long)(pMT->base_param_K1[0][0])<<16;//0 or 1, 16bit float
		K2_0=(long long)(pMT->base_param_K2[0][0])<<16;//0 or 1, 16bit float
		if(pMT->base_param_K3[0][0]==2)
			K3_0=maximum_maxrgb ;// 16bit float
		else
			K3_0=(long long)(pMT->base_param_K3[0][0])<<16;//0,1, 16bit float

		/* 9.2.3 calculate max_lum */
		inv_EOTF_MaxDisplayPQ=inv_EO_lut(((MaxDisplayPQ<<16)*10000)>>14)<<16; // 32bit float
		MaxRefDisplay=inv_EO_lut(((max_display_mastering_luminance<<16)*10000)>>14)<<16; // 32bit float
		EOTF_targeted_system_display_maximum_luminance=EOTF_2084(targeted_system_display_maximum_luminance<<16);// 32bit float
		MAX1=B*maximum_maxrgb+A*2*average_maxrgb+(65536-A-B)*variance_maxrgb; //MAX1=32 bit float
		
		// max_lum: 32 bit float
		if(MAX1>MaxRefDisplay) 
			max_lum=MaxRefDisplay;
		else if(MAX1<MIN_cuva)
			max_lum=MIN_cuva;
		else
			max_lum=MAX1;
		if(max_lum<inv_EOTF_MaxDisplayPQ)
			max_lum=inv_EOTF_MaxDisplayPQ;
		/* 9.2.3 calculate max_lum */

		if(pMT->tone_mapping_enable_mode_flag[0]==0||(pMT->tone_mapping_enable_mode_flag[0]==1&&base_flag==0))
		{
			base_9_2_2(&m_p, &m_a, &m_m, &m_n, &m_b, &K1, &K2, &K3);
		}
		else
		{
			if((targeted_system_display_maximum_luminance<<16)==inv_EOTF_MaxDisplayPQ||base_param_Delta_mode==3)
			{
				m_p=m_p_0; //16bit float 
				m_a=div64_s64((m_a_0<<16),1023); //16bit float
				m_m=div64_s64((m_m_0<<16),10); //16bit float
				m_n=div64_s64((m_n_0<<16),10); //16bit float
				m_b=m_b_0; //16bit float
				K1=K1_0; //0 or 1, 16bit float
				K2=K2_0; //0 or 1, 16bit float
				K3=K3_0; //0 or 1, 16bit float
			}
			else if(base_param_Delta_mode==0||base_param_Delta_mode==2||base_param_Delta_mode==4||base_param_Delta_mode==6)
			{
				base_9_2_4(&m_p, &m_a, &m_m, &m_n, &m_b, &K1, &K2, &K3, m_p_0, m_a_0, m_m_0, m_n_0, m_b_0, K1_0, K2_0, K3_0);
			} 
			else
			{
				base_9_2_5(&m_p, &m_a, &m_m, &m_n, &m_b, &K1, &K2, &K3, m_p_0, m_a_0, m_m_0, m_n_0, m_b_0, K1_0, K2_0, K3_0);
			}
		} 
		if((Debug_Log&_BIT0)!=0) 
			{
			if (CNT >= Debug_log_delay) 
				{
					rtd_printk(KERN_INFO,"HDR10_vivid", "m_p=%lld, m_a=%lld, m_m=%lld, m_n=%lld, m_b=%lld, k1=%lld, k2=%lld, k3=%lld,\n", m_p, m_a, m_m, m_n, m_b, K1, K2, K3);								 
				}
			}
		/* 9.3 - 3spline */

		//set spline_num, spline_TH_mode
		if(pMT->tone_mapping_enable_mode_flag[0]==0||(pMT->tone_mapping_enable_mode_flag[0]==1&&spline_flag==0))
		{
			spline_num=1;
			spline_TH_mode=0;
		}
		else // from meta data
		{
			spline_num=spline_enable_num+1;
			spline_TH_mode=pMT->_3Spline_TH_enable_mode[0][0][0];
		}

		if(spline_TH_mode==0)
		{
			//spline_TH_MB=(spline_TH_enable_MB>>2)/63.0;
			//Base_offset=(spline_TH_enable_MB & 3)*0.1/3.0;
			spline_TH_MB=div64_s64((((long long)(pMT->_3Spline_TH_enable_MB[0][0][0])>>2)<<16),63); //16bit float
			Base_offset=div64_s64((((long long)(pMT->_3Spline_TH_enable_MB[0][0][0]) & 3)<<16),30);  //16bit float
		}
		else
		{
			//spline_TH_MB=spline_TH_enable_MB*1.1/255.0;
			//spline_TH_MB=spline_TH_enable_MB*282; //16 bit float
			spline_TH_MB=div64_s64((long long)(pMT->_3Spline_TH_enable_MB[0][0][0])*72089,255); //16 bit float
		}
		
		if(spline_TH_mode_1 == 2)
			spline_TH_MB_2 = div64_s64((long long)(pMT->_3Spline_TH_enable_MB[1][0][0])*72089,255); //16 bit float

		if(pMT->tone_mapping_enable_mode_flag[0]==0||(pMT->tone_mapping_enable_mode_flag[0]==1&&spline_flag==0&&spline_TH_mode==0)||(pMT->tone_mapping_enable_mode_flag[0]==1&&spline_flag==1&&((spline_TH_mode!=0) )))
		{
			spline_9_3_2_1(&TH3_0, &MB_0, &base_offset);
			spline_9_3_2_3(&TH3_0, &MB_0, &base_offset, &m_p, &m_a, &m_m, &m_n, &m_b, &K1, &K2, &K3);
			spline_9_3_3_1(&TH3_0, &MB_0, &base_offset, &m_p, &m_a, &m_m, &m_n, &m_b, &K1, &K2, &K3, &TH1_1, &TH2_1, &TH3_1, &MA_0_1, &MB_0_1, &MC_0_1, &MD_0_1, &MA_1_1, &MB_1_1, &MC_1_1, &MD_1_1);
		}
		else if(pMT->tone_mapping_enable_mode_flag[0]==1&&spline_flag==1&&spline_TH_mode==0)
		{
			spline_9_3_2_2(&TH3_0, &MB_0, &base_offset);
			spline_9_3_2_3(&TH3_0, &MB_0, &base_offset, &m_p, &m_a, &m_m, &m_n, &m_b, &K1, &K2, &K3);
			spline_9_3_3_2(&TH3_0, &MB_0, &base_offset, &m_p, &m_a, &m_m, &m_n, &m_b, &K1, &K2, &K3, &TH1_1, &TH2_1, &TH3_1, &MA_0_1, &MB_0_1, &MC_0_1, &MD_0_1, &MA_1_1, &MB_1_1, &MC_1_1, &MD_1_1);
		}
		if((Debug_Log&_BIT0)!=0) 
		{
			if (CNT >= Debug_log_delay) 
			{
				rtd_printk(KERN_INFO,"HDR10_vivid", "TH3_0=%lld, MB_0=%lld, base_offset=%lld\n", TH3_0, MB_0, base_offset);
				rtd_printk(KERN_INFO,"HDR10_vivid", "TH1_1=%lld, TH2_1=%lld, TH3_1=%lld, MA_0_1=%lld, MB_0_1=%lld, MC_0_1=%lld, MD_0_1=%lld, MA_1_1=%lld, MB_1_1=%lld, MC_1_1=%lld, MD_1_1=%lld,\n", TH1_1, TH2_1, TH3_1, MA_0_1, MB_0_1, MC_0_1, MD_0_1, MA_1_1, MB_1_1, MC_1_1, MD_1_1);								 
			}
		}
		/* second 3spline curve */
		if(pMT->tone_mapping_enable_mode_flag[0]==1&&spline_flag==1&&((spline_num==1&&(spline_TH_mode==1||spline_TH_mode==2||spline_TH_mode==3))||spline_num==2))
		{
			spline_9_3_3_3(&TH3_0, &MB_0, &base_offset, &m_p, &m_a, &m_m, &m_n, &m_b, &K1, &K2, &K3, &TH1_1, &TH2_1, &TH3_1, &MA_0_1, &MB_0_1, &MC_0_1, &MD_0_1, &MA_1_1, &MB_1_1, &MC_1_1, &MD_1_1, &TH1_2, &TH2_2, &TH3_2, &MA_0_2, &MB_0_2, &MC_0_2, &MD_0_2, &MA_1_2, &MB_1_2, &MC_1_2, &MD_1_2);
			if(spline_num==1)
				spline_num=2;
			if((Debug_Log&_BIT0)!=0) 
			{
				if (CNT >= Debug_log_delay) 
				{
					rtd_printk(KERN_INFO,"HDR10_vivid", "TH1_2=%lld, TH2_2=%lld, TH3_2=%lld, MA_0_2=%lld, MB_0_2=%lld, MC_0_2=%lld, MD_0_2=%lld, MA_1_2=%lld, MB_1_2=%lld, MC_1_2=%lld, MD_1_2=%lld,\n", TH1_2, TH2_2, TH3_2, MA_0_2, MB_0_2, MC_0_2, MD_0_2, MA_1_2, MB_1_2, MC_1_2, MD_1_2);
				}
			}
		}
		
	/* 9.4 tone mapping */

	color_saturation_gain0=(long long)(pMT->color_saturation_enable_gain[0][0])<<9; //16bit float
	color_saturation_gain1=((long long)(pMT->color_saturation_enable_gain[1][0])&0xFC)<<9; //16bit float

	TML=inv_EOTF_MaxDisplayPQ; //32bit float
	RML=MaxRefDisplay; //32bit
	SatR=26214; //16bit float
	M=((long long)(pMT->color_saturation_enable_gain[1][0])&0x3); 
	

	//gen K, Sca table
	y_idx = 0;
	max=1;
	kmax=0;
	for (px = 0; px < 1025; px++)
	{
		
		//max = maxRGBPQ(r, g, b); //16bit float
		
		if ((spline_TH_mode == 1 || spline_TH_mode == 2) && max > TH3_2)
		{
			H1 = TH3_2 - TH2_2; //16bit float
			BASEH = (((MD_1_2 * H1 * H1) >> 16) * H1 + MC_1_2 * H1 * H1 + ((MB_1_2 * H1) << 16) + (MA_1_2 << 32)) >> 16; //32bit float
			MBH = (3 * MD_1_2 * H1 * H1 + ((2 * MC_1_2 * H1) << 16) + (MB_1_2 << 32)) >> 32;							 //16bit float
			max_Tm = (MBH * (max - TH3_2) + BASEH) >> 16;																 //16bit float
		}
		else if (spline_num > 0 && (max >= 0 && max <= TH3_0))
		{
			max_Tm = (MB_0 * max + (base_offset << 16)) >> 16; //16bit float
		}
		else if (TH1_1 < max && max < TH3_1)
		{
			L1 = max - TH1_1; //16bit float
			L2 = max - TH2_1; //16bit float
			if (TH1_1 < max && max <= TH2_1)
				max_Tm = (((MD_0_1 * L1 * L1) >> 16) * L1 + MC_0_1 * L1 * L1 + ((MB_0_1 * L1) << 16) + (MA_0_1 << 32)) >> 32; //16bit float
			else
				max_Tm = (((MD_1_1 * L2 * L2) >> 16) * L2 + MC_1_1 * L2 * L2 + ((MB_1_1 * L2) << 16) + (MA_1_1 << 32)) >> 32; //16bit float
		}
		else if (spline_num == 2 && TH1_2 < max && max < TH3_2)
		{
			L1 = max - TH1_2; //16bit float
			L2 = max - TH2_2; //16bit float
			if (TH1_2 < max && max <= TH2_2)
				max_Tm = (((MD_0_2 * L1 * L1) >> 16) * L1 + MC_0_2 * L1 * L1 + ((MB_0_2 * L1) << 16) + (MA_0_2 << 32)) >> 32; //16bit float
			else
				max_Tm = (((MD_1_2 * L2 * L2) >> 16) * L2 + MC_1_2 * L2 * L2 + ((MB_1_2 * L2) << 16) + (MA_1_2 << 32)) >> 32; //16bit float
		}
		else
		{
			tmp = pow_float_fix(max, m_n, 16, 0);
			//pow_tmp=pow_float_fix(65535, m_n & 0xffff, 16, 1);	
			//tmp1 = m_p * tmp / pow_float_fix(65535, m_n & 0xffff, 16, 1);																			  //32bit float
			//tmp2 = (((K1 * m_p - (K2 << 16)) >> 16) * pow_float_fix(max, m_n, 16, 0) / pow_float_fix(65535, m_n & 0xffff, 16, 1) + (K3 << 16)) >> 16; //16bit float
			tmp1 = div64_s64(m_p * tmp , pow_tmp_9323_1);
			div_tmp1 = div64_s64(((K1 * m_p - (K2 << 16)) >> 16) * tmp , pow_tmp_9323_1);
			tmp2 = (div_tmp1 + (K3 << 16)) >> 16; //16bit float
			div_tmp1 = div64_s64(tmp1 , tmp2);
			div_tmp2 = div64_s64(m_a * pow_float_fix(div_tmp1, m_m, 16, 0) , pow_float_fix(65535, m_m & 0xffff, 16, 1));
			max_Tm = (div_tmp2 + (m_b << 16)) >> 16;					  //16bit float
		}
		if (EOTF_2084(max << 16) == 0)
			K = 0;
		else
			K = div64_s64((EOTF_2084(max_Tm << 16) << 16) , EOTF_2084(max << 16)); //16bit float
		if(px==3 || px==4)
		{
			debug_tmp = EOTF_2084(max_Tm << 16);
			debug_tmp2 = EOTF_2084(max << 16);
			if((Debug_Log&_BIT0)!=0) 
				if (CNT >= Debug_log_delay) 
					rtd_printk(KERN_INFO,"HDR10_vivid", "idx=%d, max=%lld, max_TM=%lld, EO(max_Tm)=%lld, EO(max)=%lld, K=%lld\n",px, max,max_Tm,debug_tmp,debug_tmp2,K);
		}

		//store K table for HW
		HDR10_vivi_CTRL->k_hdr10_vivid[px] = K;

		if(K>kmax)
			kmax = K;
		/***** reduse computation time *****/
		//tm_b = (EOTF_2084(b << 16) * K) >> 16; //32bit float
		//tm_g = (EOTF_2084(g << 16) * K) >> 16; //32bit float
		//tm_r = (EOTF_2084(r << 16) * K) >> 16; //32bit float
		
		// change to use mac for calculating Sca table for HW
		tm_r = (EOTF_2084(max << 16) * K) >> 16; //32bit float
		tm_g=tm_r;
		tm_b=tm_r;
	
		TML_TM = inv_EO_lut((MaxDisplayPQ * K * 10000) >> 14) << 16; //32bit float
		/* 9.5 color correction */
		if (pMT->color_saturation_mapping_enable_flag[0] == 0)
		/***** reduse computation time *****/
		//if (1) 
		{
			color_b = tm_b;
			color_g = tm_g;
			color_r = tm_r;
		}
		else
		{
			C0 = color_saturation_gain0; //16bit float
			C1 = color_saturation_gain1; //16bit float

			/***** reduse computation time *****/
			//tm_b_PQ = inv_EO_lut((tm_b * 10000) >> 14) << 16; //32bit
			//tm_g_PQ = inv_EO_lut((tm_g * 10000) >> 14) << 16; //32bit
			tm_r_PQ = inv_EO_lut((tm_r * 10000) >> 14) << 16; //32bit
			tm_g_PQ=tm_r_PQ;
			tm_b_PQ=tm_r_PQ;

			max_TM_PQ = maxRGBPQ(tm_r_PQ, tm_g_PQ, tm_b_PQ); //32bit float
			//max_TM_PQ=inv_EOTF_2084(EOTF_2084(max)*K);
			if ((max << 16) > TML && pMT->color_saturation_enable_num[0] >= 2)
			{
				A_color = div64_s64((TML << 16),RML);	 //16bit float

				div_tmp1 = div64_s64((TML_TM << 16) , TML);
				B_color = div64_s64(pow_float_fix(div_tmp1, C0, 16, 0) , pow_float_fix(65535, C0 & 0xffff, 16, 1)); //16bit float

				if ((TML >> 16) < max && max < (RML >> 16))
				//Sca=B_color-C1*SatR*pow((max-A_color*RML)/(RML-A_color*RML),M);
				{
					tmp = div64_s64(((max << 32) - A_color * RML) , (((RML << 16) - A_color * RML) >> 16)); //16bit float
					tmp1 = 1;
					for (i = 0; i < M; i++)
					{
						tmp1 = tmp1 * tmp;
						if (i > 0)
							tmp1 = tmp1 >> 16; //16bit float
					}
					Sca = ((B_color << 32) - C1 * SatR * tmp1) >> 32; //16bit float
				}
				else
					Sca = ((B_color << 16) - C1 * SatR) >> 16; //16bit float

				if (Sca < 0)
					Sca = 0;
				else if (Sca > 65536)
					Sca = 65536;
			}
			else
			{
				//Sca=pow(max_TM_PQ/max,C0);
				if (max == 0)
					Sca = 0; //16bit float
				else
				{
					div_tmp1 = div64_s64(max_TM_PQ , max);
					Sca = div64_s64(pow_float_fix(CLIP_hdr_vivid(0, 65535, div_tmp1), C0, 16, 0) , pow_float_fix(65535, C0 & 0xffff, 16, 1)); //16bit float
				}
				if (Sca < 52428)//0.8
					Sca = 52428;
				else if (Sca > 65536)
					Sca = 65536;
			}
			//store Sca table
			HDR10_vivi_CTRL->sca_hdr10_vivid[px] = Sca>>8;
			
		}

		EOTF_tmp = div64_s64(EOTF_2084(EOTF_input<<16),MaxDisplayPQ);
		EOTF_tmp = CLIP_hdr_vivid(0,65535,EOTF_tmp);
		EOTF_tmp2 = div64_s64(pow_float_fix(EOTF_tmp, 29491, 16, 0) , pow_float_fix(65535, 29491, 16, 1)); //16bit
		EOTF_tmp2 = CLIP_hdr_vivid(0,4294967295LL,(EOTF_tmp2<<16));
		HDR10_vivi_CTRL->EOTF_hdr10_vivid[px] =  (unsigned int) (EOTF_tmp2);
		max =CLIP_hdr_vivid(0,65535, max + 64);
		EOTF_input = CLIP_hdr_vivid(0,65535,EOTF_input +64);
	}

	if(kmax<65536)
		shift_bit = 0;
	else if(kmax<(1<<17))
		shift_bit = 1;
	else if(kmax<(1<<18))
		shift_bit = 2;
	else if(kmax<(1<<19))
		shift_bit = 3;
	else
		shift_bit = 4;

	if(shift_bit != 0)
	{
		for(px=0;px<1025;px++)
			HDR10_vivi_CTRL->k_hdr10_vivid[px] = HDR10_vivi_CTRL->k_hdr10_vivid[px]>>shift_bit;
	}

	/*for(px=0;px<1025;px++)
		rtd_printk(KERN_EMERG,"HDR10_vivid", "KKKKKKKKKKK=%u,\n", k_hdr10_vivid[px]);*/

	/*for(px=0;px<1025;px++)
		rtd_printk(KERN_EMERG,"HDR10_vivid", "SCA=%u,\n", sca_hdr10_vivid[px]);*/

	/*for(px=0;px<1025;px++)
		rtd_printk(KERN_EMERG,"HDR10_vivid", "EOTF=%u,\n", EOTF_hdr10_vivid[px]);*/
	HDR10_vivi_CTRL->CUVA_K_shift_bit = shift_bit;

	HDR10_vivi_CTRL->update_DMA_Flag = 1;

	if (CNT >= Debug_log_delay)
		CNT = 0;

#if 0
	
		//*** these settings must be set before writing EOTF and OETF curve ***//
		dm_hdr_path_sel_reg.regValue = IoReg_Fpga_Read32(DM_HDR_PATH_SEL_reg);
		dm_hdr_path_sel_reg.b0103_or_eotf=0;
		dm_hdr_path_sel_reg.b0105_or_oetf=0;
		dm_hdr_path_sel_reg.bbc_hdr_enable=0;
		dm_hdr_path_sel_reg.b05_position=2;
		dm_hdr_path_sel_reg.b03_no_sram_mode=1;
		dm_hdr_path_sel_reg.dm_b05_22bit_path=1;
		IoReg_Fpga_Write32(DM_HDR_PATH_SEL_reg, dm_hdr_path_sel_reg.regValue);
		//*** these settings must be set before writing EOTF and OETF curve ***//
	
		/* write EOTF_hdr10_vivid to EOTF */
		ret=drvif_DM2_EOTF_Set_verify(EOTF_hdr10_vivid, EOTF_hdr10_vivid, EOTF_hdr10_vivid);
		
		/* write k_hdr10_vivid and sca_hdr10_vivid to OETF */
		ret2=drvif_DM2_OETF_Set_verify(k_hdr10_vivid, sca_hdr10_vivid, OETF_0);
		
		/* set CUVA */
		drvif_DM2_CUVA_Set_verify(shift_bit);
#endif
	
#if 0
	/* gen 1DLUT  */

	y_idx = 0;
	for (px = 0; px < 4096; px++)
	{
		u_idx = 32768;
		v_idx = 32768;
		y_in = y_idx;
		u = u_idx;
		v = v_idx;
		cb_in = CLIP(-32768, 32768, u - 32768);
		cr_in = CLIP(-32768, 32768, v - 32768);

		//BT2020
		r = CLIP(0, 65535, (65536 * y_in + 0 * cb_in + 96639 * cr_in) >> 16);	  //16bit
		g = CLIP(0, 65535, (65536 * y_in - 10780 * cb_in - 37441 * cr_in) >> 16); //16bit
		b = CLIP(0, 65535, (65536 * y_in + 123299 * cb_in - 6 * cr_in) >> 16);	  //16bit
		
		/* 601 full
		r = CLIP(0, 65535, (65536 * y_in + 0 * cb_in + 91881 * cr_in) >> 16);	  //16bit
		g = CLIP(0, 65535, (65536 * y_in - 22551 * cb_in - 46799 * cr_in) >> 16); //16bit
		b = CLIP(0, 65535, (65536 * y_in + 116130 * cb_in + 0 * cr_in) >> 16);	  //16bit
		*/
		max = maxRGBPQ(r, g, b); //16bit float
		if ((spline_TH_mode == 1 || spline_TH_mode == 2) && max > TH3_2)
		{
			H1 = TH3_2 - TH2_2; //16bit float
			BASEH = (((MD_1_2 * H1 * H1) >> 16) * H1 + MC_1_2 * H1 * H1 + ((MB_1_2 * H1) << 16) + (MA_1_2 << 32)) >> 16; //32bit float
			MBH = (3 * MD_1_2 * H1 * H1 + ((2 * MC_1_2 * H1) << 16) + (MB_1_2 << 32)) >> 32;							 //16bit float
			max_Tm = (MBH * (max - TH3_2) + BASEH) >> 16;																 //16bit float
		}
		else if (spline_num > 0 && (max >= 0 && max <= TH3_0))
		{
			max_Tm = (MB_0 * max + (base_offset << 16)) >> 16; //16bit float
		}
		else if (TH1_1 < max && max < TH3_1)
		{
			L1 = max - TH1_1; //16bit float
			L2 = max - TH2_1; //16bit float
			if (TH1_1 < max && max <= TH2_1)
				max_Tm = (((MD_0_1 * L1 * L1) >> 16) * L1 + MC_0_1 * L1 * L1 + ((MB_0_1 * L1) << 16) + (MA_0_1 << 32)) >> 32; //16bit float
			else
				max_Tm = (((MD_1_1 * L2 * L2) >> 16) * L2 + MC_1_1 * L2 * L2 + ((MB_1_1 * L2) << 16) + (MA_1_1 << 32)) >> 32; //16bit float
		}
		else if (spline_num == 2 && TH1_2 < max && max < TH3_2)
		{
			L1 = max - TH1_2; //16bit float
			L2 = max - TH2_2; //16bit float
			if (TH1_2 < max && max <= TH2_2)
				max_Tm = (((MD_0_2 * L1 * L1) >> 16) * L1 + MC_0_2 * L1 * L1 + ((MB_0_2 * L1) << 16) + (MA_0_2 << 32)) >> 32; //16bit float
			else
				max_Tm = (((MD_1_2 * L2 * L2) >> 16) * L2 + MC_1_2 * L2 * L2 + ((MB_1_2 * L2) << 16) + (MA_1_2 << 32)) >> 32; //16bit float
		}
		else
		{
			tmp = pow_float_fix(max, m_n, 16, 0);
			//pow_tmp=pow_float_fix(65535, m_n & 0xffff, 16, 1);	
			//tmp1 = m_p * tmp / pow_float_fix(65535, m_n & 0xffff, 16, 1);																			  //32bit float
			//tmp2 = (((K1 * m_p - (K2 << 16)) >> 16) * pow_float_fix(max, m_n, 16, 0) / pow_float_fix(65535, m_n & 0xffff, 16, 1) + (K3 << 16)) >> 16; //16bit float
			tmp1 = div64_s64(m_p * tmp , pow_tmp_9323_1);
			div_tmp1 = div64_s64(((K1 * m_p - (K2 << 16)) >> 16) * tmp , pow_tmp_9323_1);
			tmp2 = (div_tmp1 + (K3 << 16)) >> 16; //16bit float
			div_tmp1 = div64_s64(tmp1 , tmp2);
			div_tmp2 = div64_s64(m_a * pow_float_fix(div_tmp1, m_m, 16, 0) , pow_float_fix(65535, m_m & 0xffff, 16, 1));
			max_Tm = (div_tmp2 + (m_b < 16)) >> 16;					  //16bit float
		}
		if (EOTF_2084(max << 16) == 0)
			K = 0;
		else
			K = div64_s64((EOTF_2084(max_Tm << 16) << 16) , EOTF_2084(max << 16)); //16bit float

		/***** reduse computation time *****/
		//tm_b = (EOTF_2084(b << 16) * K) >> 16; //32bit float
		//tm_g = (EOTF_2084(g << 16) * K) >> 16; //32bit float
		tm_r = (EOTF_2084(r << 16) * K) >> 16; //32bit float
		tm_g=tm_r;
		tm_b=tm_r;
	
		TML_TM = inv_EO_lut((MaxDisplayPQ * K * 10000) >> 14) << 16; //32bit float
		/* 9.5 color correction */
		//if (pMT->color_saturation_mapping_enable_flag[0] == 0)
		/***** reduse computation time *****/
		if (1) 
		{
			color_b = tm_b;
			color_g = tm_g;
			color_r = tm_r;
		}
		else
		{
			C0 = color_saturation_gain0; //16bit float
			C1 = color_saturation_gain1; //16bit float

			/***** reduse computation time *****/
			//tm_b_PQ = inv_EO_lut((tm_b * 10000) >> 14) << 16; //32bit
			//tm_g_PQ = inv_EO_lut((tm_g * 10000) >> 14) << 16; //32bit
			tm_r_PQ = inv_EO_lut((tm_r * 10000) >> 14) << 16; //32bit
			tm_g_PQ=tm_r_PQ;
			tm_b_PQ=tm_r_PQ;
			//BT2020
			/*Y=0.2627*tm_r_PQ+0.678*tm_g_PQ+0.0593*tm_b_PQ;
			Cb=(-0.1396)*tm_r_PQ-0.3604*tm_g_PQ+0.5*tm_b_PQ;
			Cr=0.5*tm_r_PQ-0.4598*tm_g_PQ-0.0402*tm_b_PQ;*/
			
			Y = (17216 * tm_r_PQ + 44434 * tm_g_PQ + 3886 * tm_b_PQ) >> 32;		 //16bit float
			Cb = ((-9149) * tm_r_PQ - 23619 * tm_g_PQ + 32768 * tm_b_PQ) >> 32; //16bit float
			Cr = (32768 * tm_r_PQ - 30133 * tm_g_PQ - 2635 * tm_b_PQ) >> 32;	 //16bit float
			
			//601
			/*Y=0.299*tm_r_PQ+0.587*tm_g_PQ+0.114*tm_b_PQ;
			Cb=(-0.1687)*tm_r_PQ-0.3313*tm_g_PQ+0.5*tm_b_PQ;
			Cr=0.5*tm_r_PQ-0.4187*tm_g_PQ-0.0813*tm_b_PQ;*/
			/*Y = (19595 * tm_r_PQ + 38470 * tm_g_PQ + 7471 * tm_b_PQ) >> 32;		 //16bit float
			Cb = ((-11056) * tm_r_PQ - 21712 * tm_g_PQ + 32768 * tm_b_PQ) >> 32; //16bit float
			Cr = (32768 * tm_r_PQ - 27440 * tm_g_PQ - 5328 * tm_b_PQ) >> 32;	 //16bit float */
			//test2
			/*Y=0.2627*tm_r_PQ+0.428*tm_g_PQ+0.3093*tm_b_PQ;
			Cb=(-0.1295)*tm_r_PQ-0.211*tm_g_PQ+0.3405*tm_b_PQ;
			Cr=0.6466*tm_r_PQ-0.3753*tm_g_PQ-0.2713*tm_b_PQ;*/

			Y = CLIP(0, 65535, Y);
			Cb = CLIP(-32768, 32768, Cb); //-0.5~0.5
			Cr = CLIP(-32768, 32768, Cr); //-0.5~0.5

			max_TM_PQ = maxRGBPQ(tm_r_PQ, tm_g_PQ, tm_b_PQ); //32bit float
			//max_TM_PQ=inv_EOTF_2084(EOTF_2084(max)*K);
			if ((max << 16) > TML && pMT->color_saturation_enable_num[0] >= 2)
			{
				A_color = (TML << 16) / RML;																		 //16bit float
				B_color = pow_float_fix((TML_TM << 16) / TML, C0, 16, 0) / pow_float_fix(65535, C0 & 0xffff, 16, 1); //16bit float

				if ((TML >> 16) < max && max < (RML >> 16))
				//Sca=B_color-C1*SatR*pow((max-A_color*RML)/(RML-A_color*RML),M);
				{
					tmp = ((max << 32) - A_color * RML) / (((RML << 16) - A_color * RML) >> 16); //16bit float
					tmp1 = 1;
					for (i = 0; i < M; i++)
					{
						tmp1 = tmp1 * tmp;
						if (i > 0)
							tmp1 = tmp1 >> 16; //16bit float
					}
					Sca = ((B_color << 32) - C1 * SatR * tmp1) >> 32; //16bit float
				}
				else
					Sca = ((B_color << 16) - C1 * SatR) >> 16; //16bit float

				if (Sca < 0)
					Sca = 0;
				else if (Sca > 65535)
					Sca = 65535;
			}
			else
			{
				//Sca=pow(max_TM_PQ/max,C0);
				if (max == 0)
					Sca = 0; //16bit float
				else
					Sca = pow_float_fix(CLIP(0, 65535, max_TM_PQ / max), C0, 16, 0) / pow_float_fix(65535, C0 & 0xffff, 16, 1); //16bit float
				if (Sca < 52428)//0.8
					Sca = 52428;
				else if (Sca > 65535)
					Sca = 65535;
			}
			//Y = Y; //16bit
			Cb = (Cb * Sca) >> 16; //16bit
			Cr = (Cr * Sca) >> 16; //16bit
			//YCbCr to RGB_PQ
			/*R_ca=CLIP(0, 1, 1.0*Y+0*Cb+1.4746*Cr);
			G_ca=CLIP(0, 1, 1.0*Y-0.1645*Cb-0.5713*Cr);
			B_ca=CLIP(0, 1, 1.0*Y+1.8814*Cb-0.0001*Cr);*/
			R_ca = CLIP(0, 4294967295LL, (65536 * Y + 0 * Cb + 96639 * Cr));	   //16bit
			G_ca = CLIP(0, 4294967295LL, (65536 * Y - 10780 * Cb - 37441 * Cr)); //16bit
			B_ca = CLIP(0, 4294967295LL, (65536 * Y + 123299 * Cb - 6 * Cr));
			
			//test
			/*R_ca=CLIP(0, 1, 1.0*Y+0*Cb+1.402*Cr);
			G_ca=CLIP(0, 1, 1.0*Y-0.3441*Cb-0.7141*Cr);
			B_ca=CLIP(0, 1, 1.0*Y+1.772*Cb+0*Cr);*/
			/*R_ca = CLIP(0, 4294967295, (65536 * Y + 0 * Cb + 91881 * Cr));	   //16bit
			G_ca = CLIP(0, 4294967295, (65536 * Y - 22551 * Cb - 46799 * Cr)); //16bit
			B_ca = CLIP(0, 4294967295, (65536 * Y + 116130 * Cb + 0 * Cr));	   //16bit */
			//test2
			/*R_ca=CLIP(0, 1, 1.0*Y+0.00019*Cb+1.1403*Cr);
			G_ca=CLIP(0, 1, 1.0*Y-1.466*Cb-0.6999*Cr);
			B_ca=CLIP(0, 1, 1.0*Y+2.0284*Cb+0*Cr);*/

			color_b = EOTF_2084(B_ca); //32bit
			color_g = EOTF_2084(G_ca); //32bit
			color_r = EOTF_2084(R_ca); //32bit
		}
		tmp_ga_r = div64_s64(color_r , MaxDisplayPQ); //16bit
		tmp_ga_r = CLIP(0, 65535, tmp_ga_r);
		tmp_ga2_r = div64_s64(pow_float_fix(tmp_ga_r, 29491, 16, 0) , pow_float_fix(65535, 29491, 16, 1)); //16bit
		
		/*****  resuse computation time *****/
		tmp_ga2_g=tmp_ga2_r;
		tmp_ga2_b=tmp_ga2_r;
		//tmp_ga2_r=pow(tmp_ga_r, 0.45);
		
		/*
		tmp_ga_g = color_g / MaxDisplayPQ;
		tmp_ga_g = CLIP(0, 65535, tmp_ga_g);
		tmp_ga2_g = pow_float_fix(tmp_ga_g, 29491, 16, 0) / pow_float_fix(65535, 29491, 16, 1); //16bit
		//tmp_ga2_g=pow(tmp_ga_g, 0.45);

		tmp_ga_b = color_b / MaxDisplayPQ;
		tmp_ga_b = CLIP(0, 65535, tmp_ga_b);
		tmp_ga2_b = pow_float_fix(tmp_ga_b, 29491, 16, 0) / pow_float_fix(65535, 29491, 16, 1); //16bit
		*/
		
		/* test YUV input/output */
		/*y_out=0.2627*tmp_ga2_r+0.678*tmp_ga2_g+0.0593*tmp_ga2_b;
		cb_out=(-0.1396)*tmp_ga2_r-0.3604*tmp_ga2_g+0.5*tmp_ga2_b;
		cr_out=0.5*tmp_ga2_r-0.4598*tmp_ga2_g-0.0402*tmp_ga2_b;*/
		y_out = (17216 * tmp_ga2_r + 44434 * tmp_ga2_g + 3886 * tmp_ga2_b);//32bit float
		cb_out = ((-9149) * tmp_ga2_r - 23619 * tmp_ga2_g + 32768 * tmp_ga2_b) >> 16; //16bit float
		cr_out = (32768 * tmp_ga2_r - 30133 * tmp_ga2_g - 2635 * tmp_ga2_b) >> 16;	   //16bit float
		//test1
		/*y_out=0.299*tmp_ga2_r+0.587*tmp_ga2_g+0.114*tmp_ga2_b;
		cb_out=(-0.1687)*tmp_ga2_r-0.3313*tmp_ga2_g+0.5*tmp_ga2_b;
		cr_out=0.5*tmp_ga2_r-0.4187*tmp_ga2_g-0.0813*tmp_ga2_b;*/
		/*
		y_out = (19595 * tmp_ga2_r + 38470 * tmp_ga2_g + 7471 * tmp_ga2_b);//32bit float
		cb_out = ((-11056) * tmp_ga2_r - 21712 * tmp_ga2_g + 32768 * tmp_ga2_b) >> 16; //16bit float
		cr_out = (32768 * tmp_ga2_r - 27440 * tmp_ga2_g - 5328 * tmp_ga2_b) >> 16;	   //16bit float
		*/
		//test2
		/*y_out=0.2627*tmp_ga2_r+0.428*tmp_ga2_g+0.3093*tmp_ga2_b;
		cb_out=(-0.1295)*tmp_ga2_r-0.211*tmp_ga2_g+0.3405*tmp_ga2_b;
		cr_out=0.6466*tmp_ga2_r-0.3753*tmp_ga2_g-0.2713*tmp_ga2_b;*/

		/*y_out=CLIP(0,1,y_out);
		cb_out=CLIP(-0.5,0.5,cb_out);
		cr_out=CLIP(-0.5,0.5,cr_out);

		cb_out=cb_out+0.5;
		cr_out=cr_out+0.5;
		EOTF_out=(long long)(y_out*4294967296);
		EOTF_out=CLIP(0,4294967295,EOTF_out);*/

		pre_yout = y_out;
		
		y_out = CLIP(0, 4294967295LL, y_out);
		cb_out = CLIP(-32768, 32768, cb_out);
		cr_out = CLIP(-32768, 32768, cr_out);

		cb_out = cb_out + 32768;
		cr_out = cr_out + 32768;

		if (px % 4 == 0 || px == 4095)
		{
			y_lut1_hdr10_vivid[cnt] = (unsigned int)(y_out); // 1DLUT1
			cnt++;
		}
		// test
		if(pre_yout == 4294967295LL && y_out != 4294967295LL)
		{
			rtd_printk(KERN_EMERG,"HDR10_vivid", "system_start_code=%d, minimum_maxrgb_pq[0]=%d, average_maxrgb_pq[0]=%d,\n", pMT->system_start_code, pMT->minimum_maxrgb_pq[0], pMT->average_maxrgb_pq[0]);								 
			rtd_printk(KERN_EMERG,"HDR10_vivid", "variance_maxrgb_pq[0]=%d, maximum_maxrgb_pq[0]=%d, tone_mapping_enable_mode_flag[0]=%d,\n", pMT->variance_maxrgb_pq[0], pMT->maximum_maxrgb_pq[0], pMT->tone_mapping_enable_mode_flag[0]);					 
			rtd_printk(KERN_EMERG,"HDR10_vivid", "tone_mapping_param_enable_num[0]=%d, targeted_system_display_maximum_luminance_pq[0][0]=%d, targeted_system_display_maximum_luminance_pq[1][0]=%d,\n", pMT->tone_mapping_param_enable_num[0], pMT->targeted_system_display_maximum_luminance_pq[0][0], pMT->targeted_system_display_maximum_luminance_pq[1][0]);	 
			rtd_printk(KERN_EMERG,"HDR10_vivid", "base_enable_flag[0][0]=%d, base_enable_flag[1][0]=%d, base_param_m_p[0][0]=%d, base_param_m_p[1][0]=%d,\n", pMT->base_enable_flag[0][0], pMT->base_enable_flag[1][0], pMT->base_param_m_p[0][0], pMT->base_param_m_p[1][0]);								 
			rtd_printk(KERN_EMERG,"HDR10_vivid", "base_param_m_m[0][0]=%d, base_param_m_m[1][0]=%d, base_param_m_a[0][0]=%d, base_param_m_a[1][0]=%d,\n", pMT->base_param_m_m[0][0], pMT->base_param_m_m[1][0], pMT->base_param_m_a[0][0], pMT->base_param_m_a[1][0]);								 
			rtd_printk(KERN_EMERG,"HDR10_vivid", "base_param_m_b[0][0]=%d, base_param_m_b[1][0]=%d, base_param_m_n[0][0]=%d, base_param_m_n[1][0]=%d,\n", pMT->base_param_m_b[0][0], pMT->base_param_m_b[1][0], pMT->base_param_m_n[0][0], pMT->base_param_m_n[1][0]);								 
			rtd_printk(KERN_EMERG,"HDR10_vivid", "base_param_K1[0][0]=%d, base_param_K1[1][0]=%d, base_param_K2[0][0]=%d, base_param_K2[1][0]=%d,\n", pMT->base_param_K1[0][0], pMT->base_param_K1[1][0], pMT->base_param_K2[0][0], pMT->base_param_K2[1][0]);								   
			rtd_printk(KERN_EMERG,"HDR10_vivid", "base_param_K3[0][0]=%d, base_param_K3[1][0]=%d, base_param_Delta_enable_mode[0][0]=%d,\n", pMT->base_param_K3[0][0], pMT->base_param_K3[1][0], pMT->base_param_Delta_enable_mode[0][0]);					  
			rtd_printk(KERN_EMERG,"HDR10_vivid", "base_param_Delta_enable_mode[1][0]=%d, base_param_enable_Delta[0][0]=%d, base_param_enable_Delta[1][0]=%d,\n", pMT->base_param_Delta_enable_mode[1][0], pMT->base_param_enable_Delta[0][0], pMT->base_param_enable_Delta[1][0]);						  
			rtd_printk(KERN_EMERG,"HDR10_vivid", "_3Spline_enable_flag[0][0]=%d, _3Spline_enable_flag[1][0]=%d, _3Spline_enable_num[0][0]=%d, _3Spline_enable_num[1][0]=%d,\n", pMT->_3Spline_enable_flag[0][0], pMT->_3Spline_enable_flag[1][0], pMT->_3Spline_enable_num[0][0], pMT->_3Spline_enable_num[1][0]);							
			rtd_printk(KERN_EMERG,"HDR10_vivid", "_3Spline_TH_enable_mode[0][0][0]=%d, _3Spline_TH_enable_mode[0][1][0]=%d, _3Spline_TH_enable_mode[1][0][0]=%d, _3Spline_TH_enable_mode[1][1][0]=%d,\n", pMT->_3Spline_TH_enable_mode[0][0][0], pMT->_3Spline_TH_enable_mode[0][1][0], pMT->_3Spline_TH_enable_mode[1][0][0], pMT->_3Spline_TH_enable_mode[1][1][0]);					  
			rtd_printk(KERN_EMERG,"HDR10_vivid", "_3Spline_TH_enable_MB[0][0][0]=%d, _3Spline_TH_enable_MB[0][1][0]=%d, _3Spline_TH_enable_MB[1][0][0]=%d, _3Spline_TH_enable_MB[1][1][0]=%d,\n", pMT->_3Spline_TH_enable_MB[0][0][0], pMT->_3Spline_TH_enable_MB[0][1][0], pMT->_3Spline_TH_enable_MB[1][0][0], pMT->_3Spline_TH_enable_MB[1][1][0]);					   
			rtd_printk(KERN_EMERG,"HDR10_vivid", "_3Spline_TH_enable[0][0][0]=%d, _3Spline_TH_enable[0][1][0]=%d, _3Spline_TH_enable[1][0][0]=%d, _3Spline_TH_enable[1][1][0]=%d,\n", pMT->_3Spline_TH_enable[0][0][0], pMT->_3Spline_TH_enable[0][1][0], pMT->_3Spline_TH_enable[1][0][0], pMT->_3Spline_TH_enable[1][1][0]);						   
			rtd_printk(KERN_EMERG,"HDR10_vivid", "_3Spline_TH_enable_Delta1[0][0][0]=%d, _3Spline_TH_enable_Delta1[0][1][0]=%d, _3Spline_TH_enable_Delta1[1][0][0]=%d, _3Spline_TH_enable_Delta1[1][1][0]=%d,\n", pMT->_3Spline_TH_enable_Delta1[0][0][0], pMT->_3Spline_TH_enable_Delta1[0][1][0], pMT->_3Spline_TH_enable_Delta1[1][0][0], pMT->_3Spline_TH_enable_Delta1[1][1][0]);					
			rtd_printk(KERN_EMERG,"HDR10_vivid", "_3Spline_TH_enable_Delta2[0][0][0]=%d, _3Spline_TH_enable_Delta2[0][1][0]=%d, _3Spline_TH_enable_Delta2[1][0][0]=%d, _3Spline_TH_enable_Delta2[1][1][0]=%d,\n", pMT->_3Spline_TH_enable_Delta2[0][0][0], pMT->_3Spline_TH_enable_Delta2[0][1][0], pMT->_3Spline_TH_enable_Delta2[1][0][0], pMT->_3Spline_TH_enable_Delta2[1][1][0]);				   
			rtd_printk(KERN_EMERG,"HDR10_vivid", "_3Spline_enable_Strength[0][0][0]=%d, _3Spline_enable_Strength[0][1][0]=%d, _3Spline_enable_Strength[1][0][0]=%d, _3Spline_enable_Strength[1][1][0]=%d,\n", pMT->_3Spline_enable_Strength[0][0][0], pMT->_3Spline_enable_Strength[0][1][0], pMT->_3Spline_enable_Strength[1][0][0], pMT->_3Spline_enable_Strength[1][1][0]);					
			rtd_printk(KERN_EMERG,"HDR10_vivid", "color_saturation_mapping_enable_flag[0]=%d, color_saturation_enable_num[0]=%d,\n", pMT->color_saturation_mapping_enable_flag[0], pMT->color_saturation_enable_num[0]);						 
			rtd_printk(KERN_EMERG,"HDR10_vivid", "color_saturation_enable_gain[0][0]=%d, color_saturation_enable_gain[1][0]=%d, color_saturation_enable_gain[2][0]=%d, color_saturation_enable_gain[3][0]=%d,\n", pMT->color_saturation_enable_gain[0][0], pMT->color_saturation_enable_gain[1][0], pMT->color_saturation_enable_gain[2][0], pMT->color_saturation_enable_gain[3][0]);					
			rtd_printk(KERN_EMERG,"HDR10_vivid", "color_saturation_enable_gain[4][0]=%d, color_saturation_enable_gain[5][0]=%d, color_saturation_enable_gain[6][0]=%d,\n", pMT->color_saturation_enable_gain[4][0], pMT->color_saturation_enable_gain[5][0], pMT->color_saturation_enable_gain[6][0]);					 
		}
		// test
		
		y_gray[px] = (unsigned int)(y_out >> 16); //16 bit
		//pre_Eo=y_out;
		y_idx = CLIP(0, 65535, y_idx + 16);
	}

	/* gen 1DLUT2 */

	for(loop=0;loop<17;loop++)
	{
		target=CLIP(0,65535,loop*4096);
		//pick=0;

		if(loop==16)
			y_lut2[loop]=65535;
		else
		{
			/*for(idx=0;idx<4096;idx++)
			{
				if(y_gray[idx]==target)
				{
					y_lut2[loop]=idx<<4; // 1DLUT2 16bit
					pick=1;
					break;
				}
			}*/
			//if(pick==0)
			//{
				low=abs_cuva((int)(y_gray[0]-target));
				low_idx=0;
				for(idx=1;idx<4096;idx++)
				{
					diff=abs_cuva((int)(y_gray[idx]-target));

					if((diff<low || (diff==low && idx>low_idx)) && y_gray[idx]<=target)
					{
						low=diff;
						low_idx=idx;
					}
					else if(y_gray[idx] > target)
					{
						break;
					}	
				}
				up_idx=low_idx+1;
				//pick=1;
				y_lut2[loop]=( (target-y_gray[low_idx])*(up_idx<<4) + (y_gray[up_idx]-target)*(low_idx<<4) )/(y_gray[up_idx]-y_gray[low_idx]); // 1DLUT2 16bit
			//}
		}
	}

	/* gen 3DLUT */

	v_idx=0;
	for(pz=0;pz<17;pz++)
	{
		u_idx=0;
		for(py=0;py<17;py++)
		{
			y_idx=0;
			for(px=0;px<17;px++)
			{

				switch (y_idx)
				{
				case 0:
					y=y_lut2[0];
					break;
				case 4096:
					y=y_lut2[1];
					break;
				case 8192:
					y=y_lut2[2];
					break;
				case 12288:
					y=y_lut2[3];
					break;
				case 16384:
					y=y_lut2[4];
					break;
				case 20480:
					y=y_lut2[5];
					break;
				case 24576:
					y=y_lut2[6];
					break;
				case 28672:
					y=y_lut2[7];
					break;
				case 32768:
					y=y_lut2[8];
					break;
				case 36864:
					y=y_lut2[9];
					break;
				case 40960:
					y=y_lut2[10];
					break;
				case 45056:
					y=y_lut2[11];
					break;
				case 49152:
					y=y_lut2[12];
					break;
				case 53248:
					y=y_lut2[13];
					break;
				case 57344:
					y=y_lut2[14];
					break;
				case 61440:
					y=y_lut2[15];
					break;
				case 65535:
					y=y_lut2[16];
					break;
				}

				y_in=y;
				u=u_idx; //16bit 
				v=v_idx; //16bit 

				
				cb_in=CLIP(-32768,32768,u-32768);
				cr_in=CLIP(-32768,32768,v-32768);

				/*cb_in=CLIP(-0.5,0.5,u-0.5);
				cr_in=CLIP(-0.5,0.5,v-0.5);*/

				/*r=CLIP(0, 1, 1.0*y_in+0*cb_in+1.4746*cr_in);
				g=CLIP(0, 1, 1.0*y_in-0.1645*cb_in-0.5713*cr_in);
				b=CLIP(0, 1, 1.0*y_in+1.8814*cb_in-0.0001*cr_in);*/
				//BT2020
				r = CLIP(0, 65535, (65536 * y_in + 0 * cb_in + 96639 * cr_in) >> 16);	  //16bit
				g = CLIP(0, 65535, (65536 * y_in - 10780 * cb_in - 37441 * cr_in) >> 16); //16bit
				b = CLIP(0, 65535, (65536 * y_in + 123299 * cb_in - 6 * cr_in) >> 16);	  //16bit
				//test 1
				/*r=CLIP(0, 1, 1.0*y_in+0*cb_in+1.402*cr_in);
				g=CLIP(0, 1, 1.0*y_in-0.3441*cb_in-0.7141*cr_in);
				b=CLIP(0, 1, 1.0*y_in+1.772*cb_in+0*cr_in);*/

				/*r=CLIP(0, 65535, (65536*y_in+0*cb_in+91881*cr_in)>>16); //16bit
				g=CLIP(0, 65535, (65536*y_in-22551*cb_in-46799*cr_in)>>16); //16bit
				b=CLIP(0, 65535, (65536*y_in+116130*cb_in+0*cr_in)>>16); //16bit*/
				//test 2
				/*r=CLIP(0, 1, 1.0*y_in+0.00019*cb_in+1.1403*cr_in);
				g=CLIP(0, 1, 1.0*y_in-1.466*cb_in-0.6999*cr_in);
				b=CLIP(0, 1, 1.0*y_in+2.0284*cb_in+0*cr_in);*/

				max=maxRGBPQ(r,g,b); //16bit float
				if((spline_TH_mode==1||spline_TH_mode==2) && max>TH3_2) 
				{
					H1=TH3_2-TH2_2; //16bit float
					//BASEH=MD_1_2*pow(H1,3) + MC_1_2*pow(H1,2) + MB_1_2*H1 + MA_1_2;
					//MBH=3*MD_1_2*pow(H1,2) + 2*MC_1_2*H1 + MB_1_2;
					BASEH=(((MD_1_2*H1*H1)>>16)*H1 + MC_1_2*H1*H1 + ((MB_1_2*H1)<<16) + (MA_1_2<<32))>>16; //32bit float
					MBH=(3*MD_1_2*H1*H1 + ((2*MC_1_2*H1)<<16) + (MB_1_2<<32))>>32;//16bit float
					max_Tm=(MBH*(max-TH3_2) + BASEH)>>16; //16bit float
				}
				else if(spline_num>0 && (max>=0 && max<=TH3_0))
				{
					max_Tm=(MB_0*max+(base_offset<<16))>>16; //16bit float
				}
				else if(TH1_1<max && max<TH3_1)
				{
					L1=max-TH1_1; //16bit float
					L2=max-TH2_1; //16bit float
					if(TH1_1<max && max<=TH2_1)
						//max_Tm=MD_0_1*pow(L1,3) + MC_0_1*pow(L1,2) + MB_0_1*L1 +MA_0_1;
						max_Tm=(((MD_0_1*L1*L1)>>16)*L1 + MC_0_1*L1*L1 + ((MB_0_1*L1)<<16) +(MA_0_1<<32))>>32; //16bit float
					else
						//max_Tm=MD_1_1*pow(L2,3) + MC_1_1*pow(L2,2) + MB_1_1*L2 +MA_1_1;
						max_Tm=(((MD_1_1*L2*L2)>>16)*L2 + MC_1_1*L2*L2 + ((MB_1_1*L2)<<16) +(MA_1_1<<32))>>32; //16bit float
				}
				else if(spline_num==2 && TH1_2<max && max<TH3_2)
				{
					L1=max-TH1_2; //16bit float
					L2=max-TH2_2; //16bit float
					if(TH1_2<max && max<=TH2_2)
						//max_Tm=MD_0_2*pow(L1,3) + MC_0_2*pow(L1,2) + MB_0_2*L1 +MA_0_2;
						max_Tm=(((MD_0_2*L1*L1)>>16)*L1 + MC_0_2*L1*L1 + ((MB_0_2*L1)<<16) +(MA_0_2<<32))>>32; //16bit float
					else
						//max_Tm=MD_1_2*pow(L2,3) + MC_1_2*pow(L2,2) + MB_1_2*L2 +MA_1_2;
						max_Tm=(((MD_1_2*L2*L2)>>16)*L2 + MC_1_2*L2*L2 + ((MB_1_2*L2)<<16) +(MA_1_2<<32))>>32; //16bit float
				}
				else
				{
					//max_Tm=m_a*pow((m_p*pow(max,m_n)/((K1*m_p-K2)*pow(max,m_n)+K3)),m_m)+m_b;
					tmp = pow_float_fix(max, m_n, 16, 0);
					//pow_tmp=pow_float_fix(65535, m_n & 0xffff, 16, 1);	
					//tmp1 = m_p * tmp / pow_float_fix(65535, m_n & 0xffff, 16, 1);																			  //32bit float
					//tmp2 = (((K1 * m_p - (K2 << 16)) >> 16) * pow_float_fix(max, m_n, 16, 0) / pow_float_fix(65535, m_n & 0xffff, 16, 1) + (K3 << 16)) >> 16; //16bit float
					tmp1 = div64_s64(m_p * tmp , pow_tmp_9323_1);
					div_tmp1 = div64_s64(((K1 * m_p - (K2 << 16)) >> 16) * tmp , pow_tmp_9323_1);
					tmp2 = (div_tmp1 + (K3 << 16)) >> 16; //16bit float
					div_tmp1 = div64_s64(tmp1 , tmp2);
					div_tmp2 = div64_s64(m_a * pow_float_fix(div_tmp1, m_m, 16, 0) , pow_float_fix(65535, m_m & 0xffff, 16, 1));
					max_Tm = (div_tmp2 + (m_b < 16)) >> 16;		

					/*tmp=pow_float_fix(max,m_n,16,0);
					tmp1=m_p*tmp / pow_float_fix(65535,m_n&0xffff,16,1); //32bit float
					tmp2=(((K1*m_p-(K2<<16))>>16)*pow_float_fix(max,m_n,16,0)/pow_float_fix(65535,m_n&0xffff,16,1) + (K3<<16))>>16; //16bit float
					max_Tm=(m_a*pow_float_fix(tmp1/tmp2,m_m,16,0)/pow_float_fix(65535,m_m&0xffff,16,1)+(m_b<16))>>16; //16bit float*/
				}
				if(EOTF_2084(max<<16)==0)
					K=0;
				else
					K=div64_s64((EOTF_2084(max_Tm<<16)<<16),EOTF_2084(max<<16)); //16bit float

				tm_b=(EOTF_2084(b<<16)*K)>>16; //32bit float
				tm_g=(EOTF_2084(g<<16)*K)>>16; //32bit float
				tm_r=(EOTF_2084(r<<16)*K)>>16; //32bit float
				//TML_TM=inv_EOTF_2084((MaxDisplayPQ*K)); //32bit float
				TML_TM=inv_EO_lut((MaxDisplayPQ*K*10000)>>14)<<16; //32bit float
				/* 9.5 color correction */
				if(pMT->color_saturation_mapping_enable_flag[0]==0)
				{
					color_b=tm_b;
					color_g=tm_g;
					color_r=tm_r;
				}
				else
				{
					C0=color_saturation_gain0; //16bit float
					C1=color_saturation_gain1; //16bit float

					/*tm_b_PQ=inv_EOTF_2084(tm_b); //32bit
					tm_g_PQ=inv_EOTF_2084(tm_g); //32bit
					tm_r_PQ=inv_EOTF_2084(tm_r); //32bit*/
					tm_b_PQ=inv_EO_lut((tm_b*10000)>>14)<<16; //32bit
					tm_g_PQ=inv_EO_lut((tm_g*10000)>>14)<<16; //32bit
					tm_r_PQ=inv_EO_lut((tm_r*10000)>>14)<<16; //32bit

					//BT2020
					/*Y=0.2627*tm_r_PQ+0.678*tm_g_PQ+0.0593*tm_b_PQ;
					Cb=(-0.1396)*tm_r_PQ-0.3604*tm_g_PQ+0.5*tm_b_PQ;
					Cr=0.5*tm_r_PQ-0.4598*tm_g_PQ-0.0402*tm_b_PQ;*/
					Y = (17216 * tm_r_PQ + 44434 * tm_g_PQ + 3886 * tm_b_PQ) >> 32;		 //16bit float
					Cb = ((-9149) * tm_r_PQ - 23619 * tm_g_PQ + 32768 * tm_b_PQ) >> 32; //16bit float
					Cr = (32768 * tm_r_PQ - 30133 * tm_g_PQ - 2635 * tm_b_PQ) >> 32;	 //16bit float
					
					//test1
					/*Y=0.299*tm_r_PQ+0.587*tm_g_PQ+0.114*tm_b_PQ;
					Cb=(-0.1687)*tm_r_PQ-0.3313*tm_g_PQ+0.5*tm_b_PQ;
					Cr=0.5*tm_r_PQ-0.4187*tm_g_PQ-0.0813*tm_b_PQ;*/
					/*Y=(19595*tm_r_PQ+38470*tm_g_PQ+7471*tm_b_PQ)>>32; //16bit float
					Cb=((-11056)*tm_r_PQ-21712*tm_g_PQ+32768*tm_b_PQ)>>32; //16bit float
					Cr=(32768*tm_r_PQ-27440*tm_g_PQ-5328*tm_b_PQ)>>32; //16bit float*/
					//test2
					/*Y=0.2627*tm_r_PQ+0.428*tm_g_PQ+0.3093*tm_b_PQ;
					Cb=(-0.1295)*tm_r_PQ-0.211*tm_g_PQ+0.3405*tm_b_PQ;
					Cr=0.6466*tm_r_PQ-0.3753*tm_g_PQ-0.2713*tm_b_PQ;*/

					Y=CLIP(0,65535,Y);
					Cb=CLIP(-32768,32768,Cb); //-0.5~0.5
					Cr=CLIP(-32768,32768,Cr); //-0.5~0.5

					max_TM_PQ=maxRGBPQ(tm_r_PQ,tm_g_PQ,tm_b_PQ); //32bit float
					//max_TM_PQ=inv_EOTF_2084(EOTF_2084(max)*K);
					if((max<<16)>TML && pMT->color_saturation_enable_num[0]>=2)
					{
						A_color=div64_s64((TML<<16),RML); //16bit float
						div_tmp1 = div64_s64((TML_TM<<16),TML);
						B_color=div64_s64(pow_float_fix(div_tmp1,C0,16,0),pow_float_fix(65535,C0&0xffff,16,1)); //16bit float

						if((TML>>16)<max && max<(RML>>16))
						{
							//Sca=B_color-C1*SatR*pow((max-A_color*RML)/(RML-A_color*RML),M);
							tmp=div64_s64(((max<<32)-A_color*RML),(((RML<<16)-A_color*RML)>>16)); //16bit float
							tmp1=1;
							for(i=0;i<M;i++)
							{
								tmp1=tmp1*tmp;
								if(i>0)
									tmp1=tmp1>>16; //16bit float
							}
							Sca=((B_color<<32)-C1*SatR*tmp1)>>32; //16bit float
						}
						else
							Sca=((B_color<<16)-C1*SatR)>>16; //16bit float

						if(Sca<0)
							Sca=0;
						else if(Sca>65535)
							Sca=65535;
					}
					else
					{
						//Sca=pow(max_TM_PQ/max,C0);
						if(max==0)
							Sca=0; //16bit float
						else
						{    
							div_tmp1 = div64_s64(max_TM_PQ,max);
							Sca=div64_s64(pow_float_fix(CLIP(0,65535,div_tmp1),C0,16,0),pow_float_fix(65535,C0&0xffff,16,1)); //16bit float
						}
						if(Sca<52428)//0.8
							Sca=52428;
						else if(Sca>65535)
							Sca=65535;
					}
					//Y=Y; //16bit
					Cb=(Cb*Sca)>>16; //16bit
					Cr=(Cr*Sca)>>16; //16bit
					//YCbCr to RGB_PQ
					//BT2020
					/*R_ca=CLIP(0, 1, 1.0*Y+0*Cb+1.4746*Cr);
					G_ca=CLIP(0, 1, 1.0*Y-0.1645*Cb-0.5713*Cr);
					B_ca=CLIP(0, 1, 1.0*Y+1.8814*Cb-0.0001*Cr);*/
					R_ca = CLIP(0, 4294967295LL, (65536 * Y + 0 * Cb + 96639 * Cr));	   // 32bit
					G_ca = CLIP(0, 4294967295LL, (65536 * Y - 10780 * Cb - 37441 * Cr)); // 32bit
					B_ca = CLIP(0, 4294967295LL, (65536 * Y + 123299 * Cb - 6 * Cr));// 32bit
					//601
					/*R_ca=CLIP(0, 1, 1.0*Y+0*Cb+1.402*Cr);
					G_ca=CLIP(0, 1, 1.0*Y-0.3441*Cb-0.7141*Cr);
					B_ca=CLIP(0, 1, 1.0*Y+1.772*Cb+0*Cr);*/
					/*R_ca=CLIP(0, 4294967295, (65536*Y+0*Cb+91881*Cr)); // 32bit
					G_ca=CLIP(0, 4294967295, (65536*Y-22551*Cb-46799*Cr)); // 32bit
					B_ca=CLIP(0, 4294967295, (65536*Y+116130*Cb+0*Cr)); // 32bit*/
					//test2
					/*R_ca=CLIP(0, 1, 1.0*Y+0.00019*Cb+1.1403*Cr);
					G_ca=CLIP(0, 1, 1.0*Y-1.466*Cb-0.6999*Cr);
					B_ca=CLIP(0, 1, 1.0*Y+2.0284*Cb+0*Cr);*/

					color_b=EOTF_2084(B_ca); //32bit
					color_g=EOTF_2084(G_ca); //32bit
					color_r=EOTF_2084(R_ca); //32bit
				}
				pow_tmp=pow_float_fix(65535, 29491,16,1);
					
				tmp_ga_r=div64_s64(color_r,MaxDisplayPQ); //16bit
				tmp_ga_r=CLIP(0,65535,tmp_ga_r);
				tmp_ga2_r=div64_s64(pow_float_fix(tmp_ga_r, 29491,16,0),pow_tmp); //16bit
				//tmp_ga2_r=pow(tmp_ga_r, 0.45);

				tmp_ga_g=div64_s64(color_g,MaxDisplayPQ);
				tmp_ga_g=CLIP(0,65535,tmp_ga_g);
				tmp_ga2_g=div64_s64(pow_float_fix(tmp_ga_g, 29491,16,0),pow_tmp); //16bit
				//tmp_ga2_g=pow(tmp_ga_g, 0.45);

				tmp_ga_b=div64_s64(color_b,MaxDisplayPQ);
				tmp_ga_b=CLIP(0,65535,tmp_ga_b);
				tmp_ga2_b=div64_s64(pow_float_fix(tmp_ga_b, 29491,16,0),pow_tmp); //16bit

				/* test YUV input/output */
				//BT2020
				/*y_out=0.2627*tmp_ga2_r+0.678*tmp_ga2_g+0.0593*tmp_ga2_b;
				cb_out=(-0.1396)*tmp_ga2_r-0.3604*tmp_ga2_g+0.5*tmp_ga2_b;
				cr_out=0.5*tmp_ga2_r-0.4598*tmp_ga2_g-0.0402*tmp_ga2_b;*/
				y_out = (17216 * tmp_ga2_r + 44434 * tmp_ga2_g + 3886 * tmp_ga2_b)>>16;//16bit float
				cb_out = ((-9149) * tmp_ga2_r - 23619 * tmp_ga2_g + 32768 * tmp_ga2_b) >> 16; //16bit float
				cr_out = (32768 * tmp_ga2_r - 30133 * tmp_ga2_g - 2635 * tmp_ga2_b) >> 16;	   //16bit float
				
				//601
				/*y_out=0.299*tmp_ga2_r+0.587*tmp_ga2_g+0.114*tmp_ga2_b;
				cb_out=(-0.1687)*tmp_ga2_r-0.3313*tmp_ga2_g+0.5*tmp_ga2_b;
				cr_out=0.5*tmp_ga2_r-0.4187*tmp_ga2_g-0.0813*tmp_ga2_b;*/

				/*y_out=(19595*tmp_ga2_r+38470*tmp_ga2_g+7471*tmp_ga2_b)>>16; //16bit float
				cb_out=((-11056)*tmp_ga2_r-21712*tmp_ga2_g+32768*tmp_ga2_b)>>16; //16bit float
				cr_out=(32768*tmp_ga2_r-27440*tmp_ga2_g-5328*tmp_ga2_b)>>16; //16bit float*/
				//test2
				/*y_out=0.2627*tmp_ga2_r+0.428*tmp_ga2_g+0.3093*tmp_ga2_b;
				cb_out=(-0.1295)*tmp_ga2_r-0.211*tmp_ga2_g+0.3405*tmp_ga2_b;
				cr_out=0.6466*tmp_ga2_r-0.3753*tmp_ga2_g-0.2713*tmp_ga2_b;*/

				/*y_out=CLIP(0,1,y_out);
				cb_out=CLIP(-0.5,0.5,cb_out);
				cr_out=CLIP(-0.5,0.5,cr_out);

				cb_out=cb_out+0.5;
				cr_out=cr_out+0.5;
				EOTF_out=(long long)(y_out*4294967296);
				EOTF_out=CLIP(0,4294967295,EOTF_out);*/
				y_out=CLIP(0,65535,y_out);
				cb_out=CLIP(-32768,32768,cb_out);
				cr_out=CLIP(-32768,32768,cr_out);

				cb_out=cb_out+32768;
				cr_out=cr_out+32768;

				y_lut3D_hdr10_vivid[lut_idx][0]=y_out;
				y_lut3D_hdr10_vivid[lut_idx][1]=cb_out; 
				y_lut3D_hdr10_vivid[lut_idx][2]=cr_out; 
				
				y_idx=CLIP(0,65535,y_idx+4096);
				lut_idx++;
			}
			u_idx=CLIP(0,65535,u_idx+4096);
		}
		v_idx=CLIP(0,65535,v_idx+4096);
	}


	hdr10_vivid_table_update = 1;
#endif	
}


